!function(){"use strict";angular.module("app",["ngRoute","mobile-angular-ui","angular-loading-bar","app.main","app.home","ngNotify","app.user","app.necesidad","mobile-angular-ui.gestures"]).run(["$transform",function(e){window.$transform=e}]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"scripts/home/home.html",reloadOnSearch:!1}).when("/",{templateUrl:"scripts/home/scroll.html",reloadOnSearch:!1,controller:"HomeCtrl",controllerAs:"HomeCtrl"}).when("/necesidad/:id",{templateUrl:"scripts/necesidad/detalle.html",controller:"NecesidadDetalleCtrl",controllerAs:"DetalleCtrl"}).when("/necesidad/:id/editar",{templateUrl:"scripts/necesidad/editar.html",controller:"NecesidadDetalleCtrl",controllerAs:"DetalleCtrl"}).when("/categoria/:categoria",{templateUrl:"scripts/necesidad/categoria.html",reloadOnSearch:!1,controller:"CategoriaCtrl",controllerAs:"CategoriaCtrl"}).when("/perfil",{templateUrl:"scripts/users/config.html",reloadOnSearch:!1,controller:"ConfigCtrl",controllerAs:"ConfigCtrl"}).when("/usuario/:id",{templateUrl:"scripts/users/profile.html",reloadOnSearch:!1,controller:"UserCtrl",controllerAs:"UserCtrl"}).when("/contacto",{templateUrl:"scripts/shared/contacto.html"}).when("/privacidad",{templateUrl:"scripts/shared/privacidad.html"}).otherwise({redirectTo:"/"})}])}(),function(){"use strict";angular.module("app.home",[]).controller("HomeCtrl",["Necesidad","ngNotify",function(e,r){var t=this;e.load().success(function(e){t.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad.categoria",[]).controller("CategoriaCtrl",["Necesidad","$routeParams",function(e,r){var t=this;e.categoria(r.categoria).success(function(e){t.necesidades=e.necesidades,t.categoria=e.categoria}).error(function(e){console.error(e)})}])}(),function(){"use strict";angular.module("app.comentario.service",[]).factory("Comentario",["$http",function(e){return{"delete":function(r){return e["delete"]("/api/comentarios/"+r)},create:function(r){return e({data:r,method:"POST",url:"/api/necesidades/"+r.necesidadId+"/comentarios"})},update:function(r){return e({data:r,method:"PUT",url:"/api/comentarios/"+r.id})}}}])}(),function(){"use strict";angular.module("app.necesidad.detalle",[]).controller("NecesidadDetalleCtrl",["Necesidad","ngNotify","$routeParams","$window","Comentario","$scope",function(e,r,t,n,o,a){var i=this;i.necesidad={},i.ComentarioForm={},t.id&&e.show(t.id).success(function(e){i.necesidad=e}).error(function(e){r.set(e,"error")}),i.save=function(){e.update(i.necesidad).success(function(e){r.set(e,"success")}).error(function(e){r.set(e,"error")})},i.comentar=function(){i.ComentarioForm.necesidadId=i.necesidad.id,i.ComentarioForm.userId=i.necesidad.userId,i.Comentario.createdAt=new Date,o.create(i.ComentarioForm).success(function(e){r.set(e,"success"),i.necesidad.comentarios.push(i.ComentarioForm)}).error(function(e){r.set(e,"error")})},i["delete"]=function(){var t=confirm("Realmente deseas eliminar esta publicaciÃ³n?");t&&e["delete"](i.necesidad.id).success(function(e){r.set(e,"success"),n.location="#/"}).error(function(e){r.set(e,"error")})},a.upload=function(n){console.log("Subiendo archivo");var o=new FormData;n[0]&&(o.append("file",n[0]),e.upload(o,t.id).success(function(e){r.set(e,"success"),console.log(e)}).error(function(e){console.log(e),r.set(e,"error")}))}}])}(),function(){"use strict";angular.module("app.necesidad",["app.necesidad.service","app.necesidad.nueva","app.necesidad.detalle","app.necesidad.categoria","app.comentario.service"]).controller("NecesidadesCtrl",["Necesidad","ngNotify",function(e,r){var t=this;e.load().success(function(e){t.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad.service",[]).factory("Necesidad",["$http",function(e){return{load:function(r){return e.get("/api/necesidades")},show:function(r){return e.get("/api/necesidades/"+r)},categoria:function(r){return e.get("/api/categorias/"+r)},"delete":function(r){return e["delete"]("/api/necesidades/"+r)},create:function(r){return e({data:r,method:"POST",url:"/api/necesidades"})},upload:function(r,t){return e.post("/api/necesidades/"+t+"/upload",r,{withCredentials:!0,headers:{"Content-Type":void 0},transformRequest:angular.identity})},update:function(r){return e({data:r,method:"PUT",url:"/api/necesidades/"+r.id})}}}])}(),function(){"use strict";angular.module("app.necesidad.nueva",[]).controller("NuevaNecesidadCtrl",["Necesidad","ngNotify","$window",function(e,r,t){var n=this;n.NecesidadForm={},n.create=function(){e.create(n.NecesidadForm).success(function(e){r.set("Necesidad agregada correctamente :)","success"),t.location="#/necesidad/"+e+"/editar"}).error(function(e){r.set(e,"error")})}}])}(),angular.module("app.directives",[]).directive("money",function(){function e(e,t,n,o){function a(e){var r=Math.pow(10,l);return Math.round(e*r)/r}function i(e){return parseFloat(e).toFixed(l)}function s(e){return o.$isEmpty(e)?"":""+e}var c,u=parseFloat(n.min||0),l=parseFloat(n.precision||2);o.$parsers.push(function(e){angular.isUndefined(e)&&(e=""),0===e.indexOf(".")&&(e="0"+e),0===e.indexOf("-")&&(u>=0?(e=null,o.$setViewValue(""),o.$render()):"-"===e&&(e=""));var t=o.$isEmpty(e);return t||r.test(e)?c=""===e?null:t?e:parseFloat(e):(o.$setViewValue(s(c)),o.$render()),o.$setValidity("number",!0),c}),o.$formatters.push(s);var d=function(e){return!o.$isEmpty(e)&&u>e?void o.$setValidity("min",!1):(o.$setValidity("min",!0),e)};if(o.$parsers.push(d),o.$formatters.push(d),n.max){var p=parseFloat(n.max),f=function(e){return!o.$isEmpty(e)&&e>p?void o.$setValidity("max",!1):(o.$setValidity("max",!0),e)};o.$parsers.push(f),o.$formatters.push(f)}l>-1&&(o.$parsers.push(function(e){return e?a(e):e}),o.$formatters.push(function(e){return e?i(e):e})),t.bind("blur",function(){var e=o.$modelValue;e&&(o.$viewValue=i(e),o.$render())})}var r=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/;return{restrict:"A",require:"ngModel",link:e}}).directive("numbersOnly",function(){return{restrict:"A",require:"ngModel",link:function(e,r,t,n){n.$parsers.push(function(e){if(void 0===e)return"";var r=e.replace(/[^0-9+.]/g,"");return r!==e&&(n.$setViewValue(r),n.$render()),r})}}}),angular.module("app.filters",[]).filter("dinero",["$filter","$locale",function(e,r){var t=e("currency"),n=r.NUMBER_FORMATS;return function(e,r,o){0===r&&(r=-1);var a=t(e,o),i=a.indexOf(n.DECIMAL_SEP)+1,s="";return i<a.indexOf(n.CURRENCY_SYM)&&(s=" "+n.CURRENCY_SYM),a.substring(0,i+r)+s}}]),function(){"use strict";angular.module("app.main",["app.directives","app.filters"]).controller("MainController",["$rootScope","$scope","User",function(e,r,t){var n=this;t.me().success(function(e){n.user=e}).error(function(e){console.log(e)}),r.userAgent=navigator.userAgent,e.$on("$routeChangeStart",function(){e.loading=!0}),e.$on("$routeChangeSuccess",function(){e.loading=!1}),r.bottomReached=function(){},r.notices=[];for(var o=0;10>o;o++)r.notices.push({icon:"envelope",message:"Notice "+(o+1)});r.deleteNotice=function(e){var t=r.notices.indexOf(e);t>-1&&r.notices.splice(t,1)}}])}(),function(){"use strict";angular.module("app.user.config",[]).controller("ConfigCtrl",["ngNotify","User",function(e,r){var t=this;t.user={},console.log("Cargando"),r.me().success(function(e){t.user=e}).error(function(r){e.set(r,"error")}),t.save=function(){r.update(t.user).success(function(r){e.set(r,"success")}).error(function(r){e.set(r,"error")})}}])}(),function(){"use strict";angular.module("app.user",["app.user.service","app.user.config"]).controller("UserCtrl",["ngNotify","User","$routeParams",function(e,r,t){var n=this;console.log("Cargando"),r.show(t.id).success(function(e){n.user=e,console.log("no"),console.log(e)}).error(function(r){e.set(r,"error")})}])}(),function(){"use strict";angular.module("app.user.service",[]).factory("User",["$http",function(e){return{me:function(){return e.get("/api/users/profile")},update:function(r){return e({method:"PUT",data:r,url:"/api/users/profile"})},show:function(r){return e.get("/api/users/"+r)}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImhvbWUvaG9tZS5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL2NhdGVnb3JpYS5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL2NvbWVudGFyaW8uc2VydmljZS5qcyIsIm5lY2VzaWRhZC9kZXRhbGxlLmNvbnRyb2xsZXIuanMiLCJuZWNlc2lkYWQvbmVjZXNpZGFkLmNvbnRyb2xsZXIuanMiLCJuZWNlc2lkYWQvbmVjZXNpZGFkLnNlcnZpY2UuanMiLCJuZWNlc2lkYWQvbnVldmEuY29udHJvbGxlci5qcyIsInNoYXJlZC9kaXJlY3RpdmVzLmpzIiwic2hhcmVkL2ZpbHRlcnMuanMiLCJzaGFyZWQvbWFpbi5qcyIsInVzZXJzL2NvbmZpZy5jb250cm9sbGVyLmpzIiwidXNlcnMvY29udHJvbGxlci5qcyIsInVzZXJzL3NlcnZpY2UuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiR0cmFuc2Zvcm0iLCJ3aW5kb3ciLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInJlbG9hZE9uU2VhcmNoIiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJOZWNlc2lkYWQiLCJuZ05vdGlmeSIsInZtIiwidGhpcyIsImxvYWQiLCJzdWNjZXNzIiwiZGF0YSIsIm5lY2VzaWRhZGVzIiwiZXJyb3IiLCJlcnIiLCJzZXQiLCIkcm91dGVQYXJhbXMiLCJjYXRlZ29yaWEiLCJjb25zb2xlIiwiZmFjdG9yeSIsIiRodHRwIiwiZGVsZXRlIiwiaWQiLCJjcmVhdGUiLCJtZXRob2QiLCJ1cmwiLCJuZWNlc2lkYWRJZCIsInVwZGF0ZSIsIiR3aW5kb3ciLCJDb21lbnRhcmlvIiwiJHNjb3BlIiwibmVjZXNpZGFkIiwiQ29tZW50YXJpb0Zvcm0iLCJzaG93Iiwic2F2ZSIsImNvbWVudGFyIiwidXNlcklkIiwiY3JlYXRlZEF0IiwiRGF0ZSIsImNvbWVudGFyaW9zIiwicHVzaCIsInN1cmUiLCJjb25maXJtIiwibG9jYXRpb24iLCJ1cGxvYWQiLCJmaWxlcyIsImxvZyIsImZkIiwiRm9ybURhdGEiLCJhcHBlbmQiLCJjYWxsYmFjayIsImdldCIsImNsYXZlIiwicG9zdCIsIndpdGhDcmVkZW50aWFscyIsImhlYWRlcnMiLCJDb250ZW50LVR5cGUiLCJ1bmRlZmluZWQiLCJ0cmFuc2Zvcm1SZXF1ZXN0IiwiaWRlbnRpdHkiLCJOZWNlc2lkYWRGb3JtIiwiZGlyZWN0aXZlIiwibGluayIsInNjb3BlIiwiZWwiLCJhdHRycyIsIm5nTW9kZWxDdHJsIiwicm91bmQiLCJudW0iLCJkIiwiTWF0aCIsInBvdyIsInByZWNpc2lvbiIsImZvcm1hdFByZWNpc2lvbiIsInZhbHVlIiwicGFyc2VGbG9hdCIsInRvRml4ZWQiLCJmb3JtYXRWaWV3VmFsdWUiLCIkaXNFbXB0eSIsImxhc3RWYWxpZFZhbHVlIiwibWluIiwiJHBhcnNlcnMiLCJpc1VuZGVmaW5lZCIsImluZGV4T2YiLCIkc2V0Vmlld1ZhbHVlIiwiJHJlbmRlciIsImVtcHR5IiwiTlVNQkVSX1JFR0VYUCIsInRlc3QiLCIkc2V0VmFsaWRpdHkiLCIkZm9ybWF0dGVycyIsIm1pblZhbGlkYXRvciIsIm1heCIsIm1heFZhbGlkYXRvciIsImJpbmQiLCIkbW9kZWxWYWx1ZSIsIiR2aWV3VmFsdWUiLCJyZXN0cmljdCIsInJlcXVpcmUiLCJlbGVtZW50IiwibW9kZWxDdHJsIiwiaW5wdXRWYWx1ZSIsInRyYW5zZm9ybWVkSW5wdXQiLCJyZXBsYWNlIiwiZmlsdGVyIiwibG9jYWxlIiwiY3VycmVuY3lGaWx0ZXIiLCJmb3JtYXRzIiwiTlVNQkVSX0ZPUk1BVFMiLCJhbW91bnQiLCJjdXJyZW5jeVN5bWJvbCIsInNlcCIsIkRFQ0lNQUxfU0VQIiwic3ltYm9sIiwiQ1VSUkVOQ1lfU1lNIiwic3Vic3RyaW5nIiwiJHJvb3RTY29wZSIsIlVzZXIiLCJtZSIsInVzZXIiLCJ1c2VyQWdlbnQiLCJuYXZpZ2F0b3IiLCIkb24iLCJsb2FkaW5nIiwiYm90dG9tUmVhY2hlZCIsIm5vdGljZXMiLCJqIiwiaWNvbiIsIm1lc3NhZ2UiLCJkZWxldGVOb3RpY2UiLCJub3RpY2UiLCJpbmRleCIsInNwbGljZSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxZQUVBQSxTQUNBQyxPQUFBLE9BQ0EsVUFDQSxvQkFDQSxzQkFDQSxXQUNBLFdBQ0EsV0FDQSxXQUNBLGdCQU9BLCtCQUVBQyxLQUFBLGFBQUEsU0FBQUMsR0FDQUMsT0FBQUQsV0FBQUEsS0FFQUUsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxLQUFBLEtBQ0FDLFlBQUEseUJBQ0FDLGdCQUFBLElBRUFGLEtBQUEsS0FDQUMsWUFBQSwyQkFDQUMsZ0JBQUEsRUFDQUMsV0FBQSxXQUNBQyxhQUFBLGFBRUFKLEtBQUEsa0JBQ0FDLFlBQUEsaUNBQ0FFLFdBQUEsdUJBQ0FDLGFBQUEsZ0JBRUFKLEtBQUEseUJBQ0FDLFlBQUEsZ0NBQ0FFLFdBQUEsdUJBQ0FDLGFBQUEsZ0JBRUFKLEtBQUEseUJBQ0FDLFlBQUEsbUNBQ0FDLGdCQUFBLEVBQ0FDLFdBQUEsZ0JBQ0FDLGFBQUEsa0JBRUFKLEtBQUEsV0FDQUMsWUFBQSw0QkFDQUMsZ0JBQUEsRUFDQUMsV0FBQSxhQUNBQyxhQUFBLGVBRUFKLEtBQUEsZ0JBQ0FDLFlBQUEsNkJBQ0FDLGdCQUFBLEVBQ0FDLFdBQUEsV0FDQUMsYUFBQSxhQUVBSixLQUFBLGFBQ0FDLFlBQUEsaUNBRUFELEtBQUEsZUFDQUMsWUFBQSxtQ0FFQUksV0FDQUMsV0FBQSxZQ3ZFQSxXQUNBLFlBQ0FiLFNBQ0FDLE9BQUEsZUFDQVMsV0FBQSxZQUFBLFlBQUEsV0FBQSxTQUFBSSxFQUFBQyxHQUVBLEdBQUFDLEdBQUFDLElBRUFILEdBQUFJLE9BQ0FDLFFBQUEsU0FBQUMsR0FDQUosRUFBQUssWUFBQUQsSUFFQUUsTUFBQSxTQUFBQyxHQUNBUixFQUFBUyxJQUFBRCxFQUFBLGlCQ2JBLFdBQ0EsWUFDQXZCLFNBQ0FDLE9BQUEsOEJBQ0FTLFdBQUEsaUJBQUEs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QkFDQSxvQkFFQVMsV0FBQSxZQUFBLFdBQUEsT0FBQSxlQUFBLFNBQUFLLEVBQUErRyxFQUFBckcsR0FFQSxHQUFBVCxHQUFBQyxJQUNBVSxTQUFBNEIsSUFBQSxZQUVBdUUsRUFBQXBGLEtBQUFqQixFQUFBTSxJQUNBWixRQUFBLFNBQUFDLEdBQ0FKLEVBQUFnSCxLQUFBNUcsRUFDQU8sUUFBQTRCLElBQUEsTUFDQTVCLFFBQUE0QixJQUFBbkMsS0FFQUUsTUFBQSxTQUFBQyxHQUNBUixFQUFBUyxJQUFBRCxFQUFBLGlCQ2xCQSxXQUNBLFlBQ0F2QixTQUNBQyxPQUFBLHVCQUVBMkIsUUFBQSxRQUFBLFFBQUEsU0FBQUMsR0FFQSxPQUNBa0csR0FBQSxXQUNBLE1BQUFsRyxHQUFBK0IsSUFBQSx1QkFFQXhCLE9BQUEsU0FBQWhCLEdBQ0EsTUFBQVMsSUFDQUksT0FBQSxNQUNBYixLQUFBQSxFQUNBYyxJQUFBLHdCQUdBUSxLQUFBLFNBQUFYLEdBQ0EsTUFBQUYsR0FBQStCLElBQUEsY0FBQTdCIiwiZmlsZSI6ImJ1aWxkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAnLCBbXG4gICAgICAnbmdSb3V0ZScsXG4gICAgICAnbW9iaWxlLWFuZ3VsYXItdWknLFxuICAgICAgJ2FuZ3VsYXItbG9hZGluZy1iYXInLFxuICAgICAgJ2FwcC5tYWluJyxcbiAgICAgICdhcHAuaG9tZScsXG4gICAgICAnbmdOb3RpZnknLFxuICAgICAgJ2FwcC51c2VyJyxcbiAgICAgICdhcHAubmVjZXNpZGFkJyxcbiAgICAgIC8vIHRvdWNoL2RyYWcgZmVhdHVyZTogdGhpcyBpcyBmcm9tICdtb2JpbGUtYW5ndWxhci11aS5nZXN0dXJlcy5qcydcbiAgICAgIC8vIGl0IGlzIGF0IGEgdmVyeSBiZWdpbm5pbmcgc3RhZ2UsIHNvIHBsZWFzZSBiZSBjYXJlZnVsIGlmIHlvdSBsaWtlIHRvIHVzZVxuICAgICAgLy8gaW4gcHJvZHVjdGlvbi4gVGhpcyBpcyBpbnRlbmRlZCB0byBwcm92aWRlIGEgZmxleGlibGUsIGludGVncmF0ZWQgYW5kIGFuZFxuICAgICAgLy8gZWFzeSB0byB1c2UgYWx0ZXJuYXRpdmUgdG8gb3RoZXIgM3JkIHBhcnR5IGxpYnMgbGlrZSBoYW1tZXIuanMsIHdpdGggdGhlXG4gICAgICAvLyBmaW5hbCBwb3VycG9zZSB0byBpbnRlZ3JhdGUgZ2VzdHVyZXMgaW50byBkZWZhdWx0IHVpIGludGVyYWN0aW9ucyBsaWtlXG4gICAgICAvLyBvcGVuaW5nIHNpZGViYXJzLCB0dXJuaW5nIHN3aXRjaGVzIG9uL29mZiAuLlxuICAgICAgJ21vYmlsZS1hbmd1bGFyLXVpLmdlc3R1cmVzJ1xuICAgIF0pXG4gICAgLnJ1bihbJyR0cmFuc2Zvcm0nLGZ1bmN0aW9uKCR0cmFuc2Zvcm0pIHtcbiAgICAgIHdpbmRvdy4kdHJhbnNmb3JtID0gJHRyYW5zZm9ybTtcbiAgICB9XSlcbiAgICAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xuICAgICAgJHJvdXRlUHJvdmlkZXJcbiAgICAgICAgLndoZW4oJy8nLCB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL2hvbWUvaG9tZS5odG1sJyxcbiAgICAgICAgICByZWxvYWRPblNlYXJjaDogZmFsc2VcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy8nLCB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL2hvbWUvc2Nyb2xsLmh0bWwnLFxuICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZSxcbiAgICAgICAgICBjb250cm9sbGVyOidIb21lQ3RybCcsXG4gICAgICAgICAgY29udHJvbGxlckFzOidIb21lQ3RybCdcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9uZWNlc2lkYWQvOmlkJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9uZWNlc2lkYWQvZGV0YWxsZS5odG1sJyxcbiAgICAgICAgICBjb250cm9sbGVyOidOZWNlc2lkYWREZXRhbGxlQ3RybCcsXG4gICAgICAgICAgY29udHJvbGxlckFzOidEZXRhbGxlQ3RybCdcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9uZWNlc2lkYWQvOmlkL2VkaXRhcicsIHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvbmVjZXNpZGFkL2VkaXRhci5odG1sJyxcbiAgICAgICAgICBjb250cm9sbGVyOidOZWNlc2lkYWREZXRhbGxlQ3RybCcsXG4gICAgICAgICAgY29udHJvbGxlckFzOidEZXRhbGxlQ3RybCdcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9jYXRlZ29yaWEvOmNhdGVnb3JpYScsIHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvbmVjZXNpZGFkL2NhdGVnb3JpYS5odG1sJyxcbiAgICAgICAgICByZWxvYWRPblNlYXJjaDogZmFsc2UsXG4gICAgICAgICAgY29udHJvbGxlcjonQ2F0ZWdvcmlhQ3RybCcsXG4gICAgICAgICAgY29udHJvbGxlckFzOidDYXRlZ29yaWFDdHJsJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL3BlcmZpbCcsIHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvdXNlcnMvY29uZmlnLmh0bWwnLFxuICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZSxcbiAgICAgICAgICBjb250cm9sbGVyOidDb25maWdDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0NvbmZpZ0N0cmwnXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvdXN1YXJpby86aWQnLCB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL3VzZXJzL3Byb2ZpbGUuaHRtbCcsXG4gICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlLFxuICAgICAgICAgIGNvbnRyb2xsZXI6J1VzZXJDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J1VzZXJDdHJsJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2NvbnRhY3RvJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9zaGFyZWQvY29udGFjdG8uaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9wcml2YWNpZGFkJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9zaGFyZWQvcHJpdmFjaWRhZC5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAub3RoZXJ3aXNlKHtcbiAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cbiAgICAvLyBhcHAuZGlyZWN0aXZlKCd0b3VjaGFyZWEnLCBbJyR0b3VjaCcsIGZ1bmN0aW9uKCR0b3VjaCl7XG4gICAgLy8gICAvLyBSdW5zIGR1cmluZyBjb21waWxlXG4gICAgLy8gICByZXR1cm4ge1xuICAgIC8vICAgICByZXN0cmljdDogJ0MnLFxuICAgIC8vICAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsIGVsZW0pIHtcbiAgICAvLyAgICAgICAkc2NvcGUudG91Y2ggPSBudWxsO1xuICAgIC8vICAgICAgICR0b3VjaC5iaW5kKGVsZW0sIHtcbiAgICAvLyAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbih0b3VjaCkge1xuICAgIC8vICAgICAgICAgICAkc2NvcGUudG91Y2ggPSB0b3VjaDtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIC8vICAgICAgICAgfSxcbiAgICAvL1xuICAgIC8vICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbih0b3VjaCkge1xuICAgIC8vICAgICAgICAgICAkc2NvcGUudG91Y2ggPSB0b3VjaDtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIC8vICAgICAgICAgfSxcbiAgICAvL1xuICAgIC8vICAgICAgICAgbW92ZTogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH0sXG4gICAgLy9cbiAgICAvLyAgICAgICAgIGVuZDogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgICB9KTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9XSk7XG4gICAgLy9cbiAgICAvLyAvL1xuICAgIC8vIC8vIGAkZHJhZ2AgZXhhbXBsZTogZHJhZyB0byBkaXNtaXNzXG4gICAgLy8gLy9cbiAgICAvLyBhcHAuZGlyZWN0aXZlKCdkcmFnVG9EaXNtaXNzJywgZnVuY3Rpb24oJGRyYWcsICRwYXJzZSwgJHRpbWVvdXQpe1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAvLyAgICAgY29tcGlsZTogZnVuY3Rpb24oZWxlbSwgYXR0cnMpIHtcbiAgICAvLyAgICAgICB2YXIgZGlzbWlzc0ZuID0gJHBhcnNlKGF0dHJzLmRyYWdUb0Rpc21pc3MpO1xuICAgIC8vICAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbSl7XG4gICAgLy8gICAgICAgICB2YXIgZGlzbWlzcyA9IGZhbHNlO1xuICAgIC8vXG4gICAgLy8gICAgICAgICAkZHJhZy5iaW5kKGVsZW0sIHtcbiAgICAvLyAgICAgICAgICAgdHJhbnNmb3JtOiAkZHJhZy5UUkFOU0xBVEVfUklHSFQsXG4gICAgLy8gICAgICAgICAgIG1vdmU6IGZ1bmN0aW9uKGRyYWcpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiggZHJhZy5kaXN0YW5jZVggPj0gZHJhZy5yZWN0LndpZHRoIC8gNCkge1xuICAgIC8vICAgICAgICAgICAgICAgZGlzbWlzcyA9IHRydWU7XG4gICAgLy8gICAgICAgICAgICAgICBlbGVtLmFkZENsYXNzKCdkaXNtaXNzJyk7XG4gICAgLy8gICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAvLyAgICAgICAgICAgICAgIGRpc21pc3MgPSBmYWxzZTtcbiAgICAvLyAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3MoJ2Rpc21pc3MnKTtcbiAgICAvLyAgICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICAgIH0sXG4gICAgLy8gICAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgICAgICAgICBlbGVtLnJlbW92ZUNsYXNzKCdkaXNtaXNzJyk7XG4gICAgLy8gICAgICAgICAgIH0sXG4gICAgLy8gICAgICAgICAgIGVuZDogZnVuY3Rpb24oZHJhZykge1xuICAgIC8vICAgICAgICAgICAgIGlmIChkaXNtaXNzKSB7XG4gICAgLy8gICAgICAgICAgICAgICBlbGVtLmFkZENsYXNzKCdkaXNtaXR0ZWQnKTtcbiAgICAvLyAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgIC8vICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgICAgICAgICAgICAgICAgZGlzbWlzc0ZuKHNjb3BlKTtcbiAgICAvLyAgICAgICAgICAgICAgICAgfSk7XG4gICAgLy8gICAgICAgICAgICAgICB9LCAzMDApO1xuICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICAgICAgICBkcmFnLnJlc2V0KCk7XG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICB9KTtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9O1xuICAgIC8vIH0pO1xuICAgIC8vXG4gICAgLy8gLy9cbiAgICAvLyAvLyBBbm90aGVyIGAkZHJhZ2AgdXNhZ2UgZXhhbXBsZTogdGhpcyBpcyBob3cgeW91IGNvdWxkIGNyZWF0ZVxuICAgIC8vIC8vIGEgdG91Y2ggZW5hYmxlZCBcImRlY2sgb2YgY2FyZHNcIiBjYXJvdXNlbC4gU2VlIGBjYXJvdXNlbC5odG1sYCBmb3IgbWFya3VwLlxuICAgIC8vIC8vXG4gICAgLy8gYXBwLmRpcmVjdGl2ZSgnY2Fyb3VzZWwnLCBmdW5jdGlvbigpe1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAvLyAgICAgc2NvcGU6IHt9LFxuICAgIC8vICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgICB0aGlzLml0ZW1Db3VudCA9IDA7XG4gICAgLy8gICAgICAgdGhpcy5hY3RpdmVJdGVtID0gbnVsbDtcbiAgICAvL1xuICAgIC8vICAgICAgIHRoaXMuYWRkSXRlbSA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICB2YXIgbmV3SWQgPSB0aGlzLml0ZW1Db3VudCsrO1xuICAgIC8vICAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gdGhpcy5pdGVtQ291bnQgPT09IDEgPyBuZXdJZCA6IHRoaXMuYWN0aXZlSXRlbTtcbiAgICAvLyAgICAgICAgIHJldHVybiBuZXdJZDtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vXG4gICAgLy8gICAgICAgdGhpcy5uZXh0ID0gZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSB8fCAwO1xuICAgIC8vICAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gdGhpcy5hY3RpdmVJdGVtID09PSB0aGlzLml0ZW1Db3VudCAtIDEgPyAwIDogdGhpcy5hY3RpdmVJdGVtICsgMTtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vXG4gICAgLy8gICAgICAgdGhpcy5wcmV2ID0gZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSB8fCAwO1xuICAgIC8vICAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gdGhpcy5hY3RpdmVJdGVtID09PSAwID8gdGhpcy5pdGVtQ291bnQgLSAxIDogdGhpcy5hY3RpdmVJdGVtIC0gMTtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9O1xuICAgIC8vIH0pO1xuXG5cblxuICAgIC8vXG4gICAgLy8gRm9yIHRoaXMgdHJpdmlhbCBkZW1vIHdlIGhhdmUganVzdCBhIHVuaXF1ZSBNYWluQ29udHJvbGxlclxuICAgIC8vIGZvciBldmVyeXRoaW5nXG4gICAgLy9cbiAgICAvLyBhcHAuY29udHJvbGxlcignTWFpbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUpe1xuICAgIC8vXG4gICAgLy8gICAkc2NvcGUuc3dpcGVkID0gZnVuY3Rpb24oZGlyZWN0aW9uKSB7XG4gICAgLy8gICAgIGFsZXJ0KCdTd2lwZWQgJyArIGRpcmVjdGlvbik7XG4gICAgLy8gICB9O1xuICAgIC8vXG4gICAgLy8gICAvLyBVc2VyIGFnZW50IGRpc3BsYXllZCBpbiBob21lIHBhZ2VcbiAgICAvLyAgICRzY29wZS51c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuICAgIC8vXG4gICAgLy8gICAvLyBOZWVkZWQgZm9yIHRoZSBsb2FkaW5nIHNjcmVlblxuICAgIC8vICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgJHJvb3RTY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAvLyAgIH0pO1xuICAgIC8vXG4gICAgLy8gICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgIC8vICAgfSk7XG4gICAgLy9cbiAgICAvLyAgIC8vIEZha2UgdGV4dCBpIHVzZWQgaGVyZSBhbmQgdGhlcmUuXG4gICAgLy8gICAkc2NvcGUubG9yZW0gPSAnTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2ljaW5nIGVsaXQuIFZlbCBleHBsaWNhYm8sIGFsaXF1aWQgZWFxdWUgc29sdXRhIG5paGlsIGVsaWdlbmRpIGFkaXBpc2NpIGVycm9yLCBpbGx1bSBjb3JydXB0aSBuYW0gZnVnYSBvbW5pcyBxdW9kIHF1YWVyYXQgbW9sbGl0aWEgZXhwZWRpdGEgaW1wZWRpdCBkb2xvcmVzIGlwc2FtLiBPYmNhZWNhdGkuJztcbiAgICAvL1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vICdTY3JvbGwnIHNjcmVlblxuICAgIC8vICAgLy9cbiAgICAvLyAgIHZhciBzY3JvbGxJdGVtcyA9IFtdO1xuICAgIC8vXG4gICAgLy8gICBmb3IgKHZhciBpPTE7IGk8PTEwMDsgaSsrKSB7XG4gICAgLy8gICAgIHNjcm9sbEl0ZW1zLnB1c2goJ0l0ZW0gJyArIGkpO1xuICAgIC8vICAgfVxuICAgIC8vXG4gICAgLy8gICAkc2NvcGUuc2Nyb2xsSXRlbXMgPSBzY3JvbGxJdGVtcztcbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLmJvdHRvbVJlYWNoZWQgPSBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgLyogZ2xvYmFsIGFsZXJ0OiBmYWxzZTsgKi9cbiAgICAvLyAgICAgYWxlcnQoJ0NvbmdyYXRzIHlvdSBzY3JvbGxlZCB0byB0aGUgZW5kIG9mIHRoZSBsaXN0IScpO1xuICAgIC8vICAgfTtcbiAgICAvL1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vIFJpZ2h0IFNpZGViYXJcbiAgICAvLyAgIC8vXG4gICAgLy8gICAkc2NvcGUuY2hhdFVzZXJzID0gW1xuICAgIC8vICAgICB7IG5hbWU6ICdDYXJsb3MgIEZsb3dlcnMnLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQnlyb24gVGF5bG9yJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0phbmEgIFRlcnJ5Jywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0RhcnJ5bCAgU3RvbmUnLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnRmFubmllICBDYXJsc29uJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0hvbGx5IE5ndXllbicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdCaWxsICBDaGF2ZXonLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnVmVyb25pY2EgIE1heHdlbGwnLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnSmVzc2ljYSBXZWJzdGVyJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0phY2tpZSAgQmFydG9uJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0NyeXN0YWwgRHJha2UnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ01pbHRvbiAgRGVhbicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnSm9hbm4gSm9obnN0b24nLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0NvcmEgIFZhdWdobicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnTmluYSAgQnJpZ2dzJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdDYXNleSBUdXJuZXInLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0ppbW1pZSAgV2lsc29uJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdOYXRoYW5pZWwgU3RlZWxlJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdBdWJyZXkgIENvbGUnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0Rvbm5pZSAgU3VtbWVycycsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnS2F0ZSAgTXllcnMnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ1ByaXNjaWxsYSBIYXdraW5zJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKb2UgQmFya2VyJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdMZWUgTm9ybWFuJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdFYm9ueSBSaWNlJywgb25saW5lOiBmYWxzZSB9XG4gICAgLy8gICBdO1xuICAgIC8vXG4gICAgLy8gICAvL1xuICAgIC8vICAgLy8gJ0Zvcm1zJyBzY3JlZW5cbiAgICAvLyAgIC8vXG4gICAgLy8gICAkc2NvcGUucmVtZW1iZXJNZSA9IHRydWU7XG4gICAgLy8gICAkc2NvcGUuZW1haWwgPSAnbWVAZXhhbXBsZS5jb20nO1xuICAgIC8vXG4gICAgLy8gICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgYWxlcnQoJ1lvdSBzdWJtaXR0ZWQgdGhlIGxvZ2luIGZvcm0nKTtcbiAgICAvLyAgIH07XG4gICAgLy8gICAvL1xuICAgIC8vICAgLy8gJ0RyYWcnIHNjcmVlblxuICAgIC8vICAgLy9cbiAgICAvLyAgICRzY29wZS5ub3RpY2VzID0gW107XG4gICAgLy9cbiAgICAvLyAgIGZvciAodmFyIGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgIC8vICAgICAkc2NvcGUubm90aWNlcy5wdXNoKHtpY29uOiAnZW52ZWxvcGUnLCBtZXNzYWdlOiAnTm90aWNlICcgKyAoaiArIDEpIH0pO1xuICAgIC8vICAgfVxuICAgIC8vXG4gICAgLy8gICAkc2NvcGUuZGVsZXRlTm90aWNlID0gZnVuY3Rpb24obm90aWNlKSB7XG4gICAgLy8gICAgIHZhciBpbmRleCA9ICRzY29wZS5ub3RpY2VzLmluZGV4T2Yobm90aWNlKTtcbiAgICAvLyAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAvLyAgICAgICAkc2NvcGUubm90aWNlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9O1xuICAgIC8vIH0pO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLmhvbWUnLFtdKVxuICAgICAgLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJyxbJ05lY2VzaWRhZCcsJ25nTm90aWZ5JyxmdW5jdGlvbiAoTmVjZXNpZGFkLG5nTm90aWZ5KSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICBOZWNlc2lkYWQubG9hZCgpXG4gICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgdm0ubmVjZXNpZGFkZXMgPSBkYXRhO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIG5nTm90aWZ5LnNldChlcnIsICdlcnJvcicpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLm5lY2VzaWRhZC5jYXRlZ29yaWEnLFtdKVxuICAgICAgLmNvbnRyb2xsZXIoJ0NhdGVnb3JpYUN0cmwnLFsnTmVjZXNpZGFkJywnJHJvdXRlUGFyYW1zJyxmdW5jdGlvbiAoTmVjZXNpZGFkLCRyb3V0ZVBhcmFtcykge1xuXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cblxuXG4gICAgICAgIE5lY2VzaWRhZC5jYXRlZ29yaWEoJHJvdXRlUGFyYW1zLmNhdGVnb3JpYSlcbiAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdm0ubmVjZXNpZGFkZXMgPSBkYXRhLm5lY2VzaWRhZGVzO1xuICAgICAgICAgICAgdm0uY2F0ZWdvcmlhID0gZGF0YS5jYXRlZ29yaWE7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLmNvbWVudGFyaW8uc2VydmljZScsW10pXG4gICAgICAuZmFjdG9yeSgnQ29tZW50YXJpbycsWyckaHR0cCcsZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkZWxldGU6ZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZGVsZXRlKCcvYXBpL2NvbWVudGFyaW9zLycgKyBpZCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBjcmVhdGU6ZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICAgIGRhdGEgICAgOiAgZGF0YSxcbiAgICAgICAgICAgICAgbWV0aG9kICA6ICdQT1NUJyxcbiAgICAgICAgICAgICAgdXJsICAgICA6ICcvYXBpL25lY2VzaWRhZGVzLycgKyBkYXRhLm5lY2VzaWRhZElkICsgJy9jb21lbnRhcmlvcydcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdXBkYXRlOmZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgICBkYXRhICAgIDogIGRhdGEsXG4gICAgICAgICAgICAgIG1ldGhvZCAgOiAnUFVUJyxcbiAgICAgICAgICAgICAgdXJsICAgICA6ICcvYXBpL2NvbWVudGFyaW9zLycgKyBkYXRhLmlkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfV0pXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLm5lY2VzaWRhZC5kZXRhbGxlJyxbXSlcbiAgICAgIC5jb250cm9sbGVyKCdOZWNlc2lkYWREZXRhbGxlQ3RybCcsWydOZWNlc2lkYWQnLCduZ05vdGlmeScsJyRyb3V0ZVBhcmFtcycsJyR3aW5kb3cnLCdDb21lbnRhcmlvJywnJHNjb3BlJyxmdW5jdGlvbiAoTmVjZXNpZGFkLG5nTm90aWZ5LCRyb3V0ZVBhcmFtcywkd2luZG93LENvbWVudGFyaW8sJHNjb3BlKSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0ubmVjZXNpZGFkID0ge307XG4gICAgICAgIHZtLkNvbWVudGFyaW9Gb3JtID0ge307XG5cbiAgICAgICAgaWYgKCRyb3V0ZVBhcmFtcy5pZCkge1xuICAgICAgICAgIE5lY2VzaWRhZC5zaG93KCRyb3V0ZVBhcmFtcy5pZClcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHZtLm5lY2VzaWRhZCA9IGRhdGE7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uc2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBOZWNlc2lkYWQudXBkYXRlKHZtLm5lY2VzaWRhZClcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIG5nTm90aWZ5LnNldChkYXRhLCdzdWNjZXNzJyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmNvbWVudGFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZtLkNvbWVudGFyaW9Gb3JtLm5lY2VzaWRhZElkID0gdm0ubmVjZXNpZGFkLmlkO1xuICAgICAgICAgIHZtLkNvbWVudGFyaW9Gb3JtLnVzZXJJZCA9IHZtLm5lY2VzaWRhZC51c2VySWQ7XG4gICAgICAgICAgdm0uQ29tZW50YXJpby5jcmVhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgQ29tZW50YXJpby5jcmVhdGUodm0uQ29tZW50YXJpb0Zvcm0pXG4gICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZGF0YSwnc3VjY2VzcycpO1xuICAgICAgICAgICAgICB2bS5uZWNlc2lkYWQuY29tZW50YXJpb3MucHVzaCh2bS5Db21lbnRhcmlvRm9ybSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgc3VyZSA9IGNvbmZpcm0oJ1JlYWxtZW50ZSBkZXNlYXMgZWxpbWluYXIgZXN0YSBwdWJsaWNhY2nDs24/Jyk7XG4gICAgICAgICAgaWYgKHN1cmUpIHtcbiAgICAgICAgICAgIE5lY2VzaWRhZC5kZWxldGUodm0ubmVjZXNpZGFkLmlkKVxuICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIG5nTm90aWZ5LnNldChkYXRhLCdzdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbiA9ICcjLyc7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS51cGxvYWQgPSBmdW5jdGlvbihmaWxlcykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWJpZW5kbyBhcmNoaXZvJyk7XG4gICAgICAgICAgdmFyIGZkID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgICAgLy9UYWtlIHRoZSBmaXJzdCBzZWxlY3RlZCBmaWxlXG5cbiAgICAgICAgICBpZiAoZmlsZXNbMF0pIHtcbiAgICAgICAgICAgIGZkLmFwcGVuZChcImZpbGVcIiwgZmlsZXNbMF0pO1xuXG4gICAgICAgICAgICBOZWNlc2lkYWQudXBsb2FkKGZkLCRyb3V0ZVBhcmFtcy5pZClcbiAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZGF0YSwnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG5cbiAgICAgICAgfTtcblxuXG4gICAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLm5lY2VzaWRhZCcsW1xuICAgICAgJ2FwcC5uZWNlc2lkYWQuc2VydmljZScsXG4gICAgICAnYXBwLm5lY2VzaWRhZC5udWV2YScsXG4gICAgICAnYXBwLm5lY2VzaWRhZC5kZXRhbGxlJyxcbiAgICAgICdhcHAubmVjZXNpZGFkLmNhdGVnb3JpYScsXG4gICAgICAnYXBwLmNvbWVudGFyaW8uc2VydmljZSdcbiAgICBdKVxuICAgICAgLmNvbnRyb2xsZXIoJ05lY2VzaWRhZGVzQ3RybCcsWydOZWNlc2lkYWQnLCduZ05vdGlmeScsZnVuY3Rpb24gKE5lY2VzaWRhZCxuZ05vdGlmeSkge1xuXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgTmVjZXNpZGFkLmxvYWQoKVxuICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHZtLm5lY2VzaWRhZGVzID0gZGF0YTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCAnZXJyb3InKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5uZWNlc2lkYWQuc2VydmljZScsW10pXG4gICAgICAuZmFjdG9yeSgnTmVjZXNpZGFkJyxbJyRodHRwJyxmdW5jdGlvbiAoJGh0dHApIHtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGxvYWQ6ZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL25lY2VzaWRhZGVzJyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBzaG93OmZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9uZWNlc2lkYWRlcy8nICsgaWQpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY2F0ZWdvcmlhOmZ1bmN0aW9uIChjbGF2ZSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jYXRlZ29yaWFzLycgKyBjbGF2ZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBkZWxldGU6ZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZGVsZXRlKCcvYXBpL25lY2VzaWRhZGVzLycgKyBpZCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBjcmVhdGU6ZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICAgIGRhdGEgICAgOiAgZGF0YSxcbiAgICAgICAgICAgICAgbWV0aG9kICA6ICdQT1NUJyxcbiAgICAgICAgICAgICAgdXJsICAgICA6ICcvYXBpL25lY2VzaWRhZGVzJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB1cGxvYWQ6ZnVuY3Rpb24gKGZkLGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9uZWNlc2lkYWRlcy8nICsgaWQgKyAnL3VwbG9hZCcsIGZkLCB7XG4gICAgICAgICAgICAgIHdpdGhDcmVkZW50aWFsczogdHJ1ZSxcbiAgICAgICAgICAgICAgaGVhZGVyczogeydDb250ZW50LVR5cGUnOiB1bmRlZmluZWQgfSxcbiAgICAgICAgICAgICAgdHJhbnNmb3JtUmVxdWVzdDogYW5ndWxhci5pZGVudGl0eVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB1cGRhdGU6ZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICAgIGRhdGEgICAgOiAgZGF0YSxcbiAgICAgICAgICAgICAgbWV0aG9kICA6ICdQVVQnLFxuICAgICAgICAgICAgICB1cmwgICAgIDogJy9hcGkvbmVjZXNpZGFkZXMvJyArIGRhdGEuaWRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICB9XSlcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAubmVjZXNpZGFkLm51ZXZhJyxbXSlcbiAgICAgIC5jb250cm9sbGVyKCdOdWV2YU5lY2VzaWRhZEN0cmwnLFsnTmVjZXNpZGFkJywnbmdOb3RpZnknLCckd2luZG93JyxmdW5jdGlvbiAoTmVjZXNpZGFkLG5nTm90aWZ5LCR3aW5kb3dcbiAgICAgICkge1xuXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLk5lY2VzaWRhZEZvcm0gPSB7fTtcblxuICAgICAgICB2bS5jcmVhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgTmVjZXNpZGFkLmNyZWF0ZSh2bS5OZWNlc2lkYWRGb3JtKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KCdOZWNlc2lkYWQgYWdyZWdhZGEgY29ycmVjdGFtZW50ZSA6KScsJ3N1Y2Nlc3MnKTsgJHdpbmRvdy5sb2NhdGlvbiA9ICcjL25lY2VzaWRhZC8nICsgZGF0YSArICcvZWRpdGFyJztcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnLCBbXSlcbiAgLmRpcmVjdGl2ZSgnbW9uZXknLCBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgTlVNQkVSX1JFR0VYUCA9IC9eXFxzKihcXC18XFwrKT8oXFxkK3woXFxkKihcXC5cXGQqKSkpXFxzKiQvO1xuXG4gICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWwsIGF0dHJzLCBuZ01vZGVsQ3RybCkge1xuICAgICAgdmFyIG1pbiA9IHBhcnNlRmxvYXQoYXR0cnMubWluIHx8IDApO1xuICAgICAgdmFyIHByZWNpc2lvbiA9IHBhcnNlRmxvYXQoYXR0cnMucHJlY2lzaW9uIHx8IDIpO1xuICAgICAgdmFyIGxhc3RWYWxpZFZhbHVlO1xuXG4gICAgICBmdW5jdGlvbiByb3VuZChudW0pIHtcbiAgICAgICAgdmFyIGQgPSBNYXRoLnBvdygxMCwgcHJlY2lzaW9uKTtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQobnVtICogZCkgLyBkO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBmb3JtYXRQcmVjaXNpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodmFsdWUpLnRvRml4ZWQocHJlY2lzaW9uKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZm9ybWF0Vmlld1ZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBuZ01vZGVsQ3RybC4kaXNFbXB0eSh2YWx1ZSkgPyAnJyA6ICcnICsgdmFsdWU7XG4gICAgICB9XG5cblxuICAgICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQodmFsdWUpKSB7XG4gICAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEhhbmRsZSBsZWFkaW5nIGRlY2ltYWwgcG9pbnQsIGxpa2UgXCIuNVwiXG4gICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCcuJykgPT09IDApIHtcbiAgICAgICAgICB2YWx1ZSA9ICcwJyArIHZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWxsb3cgXCItXCIgaW5wdXRzIG9ubHkgd2hlbiBtaW4gPCAwXG4gICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCctJykgPT09IDApIHtcbiAgICAgICAgICBpZiAobWluID49IDApIHtcbiAgICAgICAgICAgIHZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUoJycpO1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09ICctJykge1xuICAgICAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZW1wdHkgPSBuZ01vZGVsQ3RybC4kaXNFbXB0eSh2YWx1ZSk7XG4gICAgICAgIGlmIChlbXB0eSB8fCBOVU1CRVJfUkVHRVhQLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgbGFzdFZhbGlkVmFsdWUgPSAodmFsdWUgPT09ICcnKVxuICAgICAgICAgID8gbnVsbFxuICAgICAgICAgIDogKGVtcHR5ID8gdmFsdWUgOiBwYXJzZUZsb2F0KHZhbHVlKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gUmVuZGVyIHRoZSBsYXN0IHZhbGlkIGlucHV0IGluIHRoZSBmaWVsZFxuICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUoZm9ybWF0Vmlld1ZhbHVlKGxhc3RWYWxpZFZhbHVlKSk7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdudW1iZXInLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuIGxhc3RWYWxpZFZhbHVlO1xuICAgICAgfSk7XG4gICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKGZvcm1hdFZpZXdWYWx1ZSk7XG5cbiAgICAgIHZhciBtaW5WYWxpZGF0b3IgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBpZiAoIW5nTW9kZWxDdHJsLiRpc0VtcHR5KHZhbHVlKSAmJiB2YWx1ZSA8IG1pbikge1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgnbWluJywgZmFsc2UpO1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdtaW4nLCB0cnVlKTtcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKG1pblZhbGlkYXRvcik7XG4gICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKG1pblZhbGlkYXRvcik7XG5cbiAgICAgIGlmIChhdHRycy5tYXgpIHtcbiAgICAgICAgdmFyIG1heCA9IHBhcnNlRmxvYXQoYXR0cnMubWF4KTtcbiAgICAgICAgdmFyIG1heFZhbGlkYXRvciA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKCFuZ01vZGVsQ3RybC4kaXNFbXB0eSh2YWx1ZSkgJiYgdmFsdWUgPiBtYXgpIHtcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgnbWF4JywgZmFsc2UpO1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdtYXgnLCB0cnVlKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChtYXhWYWxpZGF0b3IpO1xuICAgICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKG1heFZhbGlkYXRvcik7XG4gICAgICB9XG5cbiAgICAgIC8vIFJvdW5kIG9mZlxuICAgICAgaWYgKHByZWNpc2lvbiA+IC0xKSB7XG4gICAgICAgIG5nTW9kZWxDdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlID8gcm91bmQodmFsdWUpIDogdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiB2YWx1ZSA/IGZvcm1hdFByZWNpc2lvbih2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGVsLmJpbmQoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IG5nTW9kZWxDdHJsLiRtb2RlbFZhbHVlO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlID0gZm9ybWF0UHJlY2lzaW9uKHZhbHVlKTtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgbGluazogbGlua1xuICAgIH07XG4gIH0pLmRpcmVjdGl2ZSgnbnVtYmVyc09ubHknLCBmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBtb2RlbEN0cmwpIHtcbiAgICAgICAgbW9kZWxDdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24gKGlucHV0VmFsdWUpIHtcbiAgICAgICAgICAvLyB0aGlzIG5leHQgaWYgaXMgbmVjZXNzYXJ5IGZvciB3aGVuIHVzaW5nIG5nLXJlcXVpcmVkIG9uIHlvdXIgaW5wdXQuXG4gICAgICAgICAgLy8gSW4gc3VjaCBjYXNlcywgd2hlbiBhIGxldHRlciBpcyB0eXBlZCBmaXJzdCwgdGhpcyBwYXJzZXIgd2lsbCBiZSBjYWxsZWRcbiAgICAgICAgICAvLyBhZ2FpbiwgYW5kIHRoZSAybmQgdGltZSwgdGhlIHZhbHVlIHdpbGwgYmUgdW5kZWZpbmVkXG4gICAgICAgICAgaWYgKGlucHV0VmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuICcnO1xuICAgICAgICAgIHZhciB0cmFuc2Zvcm1lZElucHV0ID0gaW5wdXRWYWx1ZS5yZXBsYWNlKC9bXjAtOSsuXS9nLCAnJyk7XG4gICAgICAgICAgaWYgKHRyYW5zZm9ybWVkSW5wdXQhPT1pbnB1dFZhbHVlKSB7XG4gICAgICAgICAgICBtb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSh0cmFuc2Zvcm1lZElucHV0KTtcbiAgICAgICAgICAgIG1vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkSW5wdXQ7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcC5maWx0ZXJzJyxbXSlcbiAgLmZpbHRlcignZGluZXJvJyxcbiAgWyAnJGZpbHRlcicsICckbG9jYWxlJywgZnVuY3Rpb24oZmlsdGVyLCBsb2NhbGUpIHtcbiAgICB2YXIgY3VycmVuY3lGaWx0ZXIgPSBmaWx0ZXIoJ2N1cnJlbmN5Jyk7XG4gICAgdmFyIGZvcm1hdHMgPSBsb2NhbGUuTlVNQkVSX0ZPUk1BVFM7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGFtb3VudCwgbnVtLCBjdXJyZW5jeVN5bWJvbCkge1xuICAgICAgaWYgKG51bT09PTApIG51bSA9IC0xO1xuICAgICAgdmFyIHZhbHVlID0gY3VycmVuY3lGaWx0ZXIoYW1vdW50LCBjdXJyZW5jeVN5bWJvbCk7XG4gICAgICB2YXIgc2VwID0gdmFsdWUuaW5kZXhPZihmb3JtYXRzLkRFQ0lNQUxfU0VQKSsxO1xuICAgICAgdmFyIHN5bWJvbCA9ICcnO1xuICAgICAgaWYgKHNlcDx2YWx1ZS5pbmRleE9mKGZvcm1hdHMuQ1VSUkVOQ1lfU1lNKSkgc3ltYm9sID0gJyAnK2Zvcm1hdHMuQ1VSUkVOQ1lfU1lNO1xuICAgICAgcmV0dXJuIHZhbHVlLnN1YnN0cmluZygwLCBzZXArbnVtKStzeW1ib2w7XG4gICAgfTtcbiAgfSBdKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgICBhbmd1bGFyXG4gICAgICAubW9kdWxlKCdhcHAubWFpbicsIFtcbiAgICAgICdhcHAuZGlyZWN0aXZlcycsXG4gICAgICAnYXBwLmZpbHRlcnMnXG4gICAgXSlcbiAgICAuY29udHJvbGxlcignTWFpbkNvbnRyb2xsZXInLFsnJHJvb3RTY29wZScsJyRzY29wZScsJ1VzZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsIFVzZXIpe1xuXG4gICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICBVc2VyLm1lKClcbiAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICB2bS51c2VyID0gZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICB9KTtcblxuICAgICAgLy8gVXNlciBhZ2VudCBkaXNwbGF5ZWQgaW4gaG9tZSBwYWdlXG4gICAgICAkc2NvcGUudXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcblxuICAgICAgLy8gTmVlZGVkIGZvciB0aGUgbG9hZGluZyBzY3JlZW5cbiAgICAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICRyb290U2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICB9KTtcblxuICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpe1xuICAgICAgICAkcm9vdFNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIH0pO1xuXG5cblxuICAgICAgJHNjb3BlLmJvdHRvbVJlYWNoZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLyogZ2xvYmFsIGFsZXJ0OiBmYWxzZTsgKi9cbiAgICAgICAgLy8gYWxlcnQoJ0NvbmdyYXRzIHlvdSBzY3JvbGxlZCB0byB0aGUgZW5kIG9mIHRoZSBsaXN0IScpO1xuICAgICAgfTtcblxuXG4gICAgICAvL1xuICAgICAgLy8gJ0RyYWcnIHNjcmVlblxuICAgICAgLy9cbiAgICAgICRzY29wZS5ub3RpY2VzID0gW107XG5cbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICAkc2NvcGUubm90aWNlcy5wdXNoKHtpY29uOiAnZW52ZWxvcGUnLCBtZXNzYWdlOiAnTm90aWNlICcgKyAoaiArIDEpIH0pO1xuICAgICAgfVxuXG4gICAgICAkc2NvcGUuZGVsZXRlTm90aWNlID0gZnVuY3Rpb24obm90aWNlKSB7XG4gICAgICAgIHZhciBpbmRleCA9ICRzY29wZS5ub3RpY2VzLmluZGV4T2Yobm90aWNlKTtcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAkc2NvcGUubm90aWNlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAudXNlci5jb25maWcnLCBbXSlcbiAgICAuY29udHJvbGxlcignQ29uZmlnQ3RybCcsWyduZ05vdGlmeScsJ1VzZXInLGZ1bmN0aW9uKG5nTm90aWZ5LFVzZXIpe1xuXG4gICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgdm0udXNlciA9IHt9O1xuICAgICAgY29uc29sZS5sb2coJ0NhcmdhbmRvJyk7XG5cbiAgICAgIFVzZXIubWUoKVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAgKGRhdGEpIHtcbiAgICAgICAgICB2bS51c2VyID0gZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uICAoZXJyKSB7XG4gICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgfSk7XG5cbiAgICAgIHZtLnNhdmUgPSBmdW5jdGlvbiAgKCkge1xuICAgICAgICBVc2VyLnVwZGF0ZSh2bS51c2VyKVxuICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBuZ05vdGlmeS5zZXQoZGF0YSwnc3VjY2VzcycpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICAoZXJyKSB7XG4gICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9XSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAudXNlcicsIFtcbiAgICAnYXBwLnVzZXIuc2VydmljZScsXG4gICAgJ2FwcC51c2VyLmNvbmZpZycgLy8gZWRpdGFyIHBlcmZpbCBkZWwgdXN1YXJpbyB5IHN1IGNvbmZpZ3VyYWNpw7NuXG4gIF0pXG4gICAgLmNvbnRyb2xsZXIoJ1VzZXJDdHJsJyxbJ25nTm90aWZ5JywnVXNlcicsJyRyb3V0ZVBhcmFtcycsZnVuY3Rpb24obmdOb3RpZnksVXNlciwkcm91dGVQYXJhbXMpe1xuXG4gICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgY29uc29sZS5sb2coJ0NhcmdhbmRvJyk7XG5cbiAgICAgIFVzZXIuc2hvdygkcm91dGVQYXJhbXMuaWQpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uICAoZGF0YSkge1xuICAgICAgICAgICAgdm0udXNlciA9IGRhdGE7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbm8nKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24gIChlcnIpIHtcbiAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICB9KTtcblxuICAgIH1dKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC51c2VyLnNlcnZpY2UnLCAgW10pXG5cbiAgICAgIC5mYWN0b3J5ICgnVXNlcicsIFsnJGh0dHAnLGZ1bmN0aW9uICgkaHR0cCkge1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbWU6ZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2Vycy9wcm9maWxlJyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB1cGRhdGU6ZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICAgIG1ldGhvZDonUFVUJyxcbiAgICAgICAgICAgICAgZGF0YTpkYXRhLFxuICAgICAgICAgICAgICB1cmw6Jy9hcGkvdXNlcnMvcHJvZmlsZSdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2hvdzpmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvJyArIGlkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XSk7XG5cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
