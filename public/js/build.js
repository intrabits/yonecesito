!function(){"use strict";angular.module("app",["ngRoute","mobile-angular-ui","app.main","app.home","ngNotify","app.necesidad","mobile-angular-ui.gestures"]).run(["$transform",function(e){window.$transform=e}]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"scripts/home/home.html",reloadOnSearch:!1}).when("/",{templateUrl:"scripts/home/scroll.html",reloadOnSearch:!1,controller:"HomeCtrl",controllerAs:"HomeCtrl"}).otherwise({redirectTo:"/"})}])}(),function(){"use strict";angular.module("app.home",[]).controller("HomeCtrl",["Necesidad","ngNotify",function(e,r){var n=this;e.load().success(function(e){n.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad",["app.necesidad.service","app.necesidad.nueva"]).controller("NecesidadesCtrl",["Necesidad","ngNotify",function(e,r){var n=this;e.load().success(function(e){n.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad.service",[]).factory("Necesidad",["$http",function(e){return{load:function(r){return e.get("/api/necesidades")},show:function(r){return e.get("/api/necesidades/"+r)},categoria:function(r){return e.get("/api/categorias/"+r)},create:function(r){return e({data:r,method:"POST",url:"/api/necesidades"})}}}])}(),function(){"use strict";angular.module("app.necesidad.nueva",[]).controller("NuevaNecesidadCtrl",["Necesidad","ngNotify",function(e,r){var n=this;n.NecesidadForm={},n.create=function(){e.create(n.NecesidadForm).success(function(e){r.set(e,"success"),n.NecesidadForm=null,n.NecesidadForm={}}).error(function(e){r.set(e,"error")})}}])}(),angular.module("app.directives",[]).directive("money",function(){function e(e,n,t,i){function o(e){var r=Math.pow(10,l);return Math.round(e*r)/r}function a(e){return parseFloat(e).toFixed(l)}function s(e){return i.$isEmpty(e)?"":""+e}var u,c=parseFloat(t.min||0),l=parseFloat(t.precision||2);i.$parsers.push(function(e){angular.isUndefined(e)&&(e=""),0===e.indexOf(".")&&(e="0"+e),0===e.indexOf("-")&&(c>=0?(e=null,i.$setViewValue(""),i.$render()):"-"===e&&(e=""));var n=i.$isEmpty(e);return n||r.test(e)?u=""===e?null:n?e:parseFloat(e):(i.$setViewValue(s(u)),i.$render()),i.$setValidity("number",!0),u}),i.$formatters.push(s);var d=function(e){return!i.$isEmpty(e)&&c>e?void i.$setValidity("min",!1):(i.$setValidity("min",!0),e)};if(i.$parsers.push(d),i.$formatters.push(d),t.max){var p=parseFloat(t.max),f=function(e){return!i.$isEmpty(e)&&e>p?void i.$setValidity("max",!1):(i.$setValidity("max",!0),e)};i.$parsers.push(f),i.$formatters.push(f)}l>-1&&(i.$parsers.push(function(e){return e?o(e):e}),i.$formatters.push(function(e){return e?a(e):e})),n.bind("blur",function(){var e=i.$modelValue;e&&(i.$viewValue=a(e),i.$render())})}var r=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/;return{restrict:"A",require:"ngModel",link:e}}).directive("numbersOnly",function(){return{restrict:"A",require:"ngModel",link:function(e,r,n,t){t.$parsers.push(function(e){if(void 0===e)return"";var r=e.replace(/[^0-9+.]/g,"");return r!==e&&(t.$setViewValue(r),t.$render()),r})}}}),angular.module("app.filters",[]).filter("dinero",["$filter","$locale",function(e,r){var n=e("currency"),t=r.NUMBER_FORMATS;return function(e,r,i){0===r&&(r=-1);var o=n(e,i),a=o.indexOf(t.DECIMAL_SEP)+1,s="";return a<o.indexOf(t.CURRENCY_SYM)&&(s=" "+t.CURRENCY_SYM),o.substring(0,a+r)+s}}]),function(){"use strict";angular.module("app.main",["app.directives","app.filters"]).controller("MainController",["$rootScope","$scope",function(e,r){r.userAgent=navigator.userAgent,e.$on("$routeChangeStart",function(){e.loading=!0}),e.$on("$routeChangeSuccess",function(){e.loading=!1}),r.bottomReached=function(){alert("Congrats you scrolled to the end of the list!")},r.notices=[];for(var n=0;10>n;n++)r.notices.push({icon:"envelope",message:"Notice "+(n+1)});r.deleteNotice=function(e){var n=r.notices.indexOf(e);n>-1&&r.notices.splice(n,1)}}])}(),function(){"use strict";angular.module("app.users",["app.users.service"]).controller("UserCtrl",["$scope","User",function(e,r){r.one("profile").get().then(function(r){e.FormUser=r})["catch"](function(e){alert(e.data)}),e.updateProfile=function(){e.FormUser.put()["catch"](function(e){alert(e.data)})}}])}(),function(){"use strict";angular.module("app.users.service",[]).factory("User",["$http",function(e){return{all:Restangular.all("api/users"),one:function(e){return Restangular.one("api/users",e)}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImhvbWUvaG9tZS5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL25lY2VzaWRhZC5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL25lY2VzaWRhZC5zZXJ2aWNlLmpzIiwibmVjZXNpZGFkL251ZXZhLmNvbnRyb2xsZXIuanMiLCJzaGFyZWQvZGlyZWN0aXZlcy5qcyIsInNoYXJlZC9maWx0ZXJzLmpzIiwic2hhcmVkL21haW4uanMiLCJ1c2Vycy9jb250cm9sbGVyLmpzIiwidXNlcnMvc2VydmljZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwicnVuIiwiJHRyYW5zZm9ybSIsIndpbmRvdyIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwicmVsb2FkT25TZWFyY2giLCJjb250cm9sbGVyIiwiY29udHJvbGxlckFzIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsIk5lY2VzaWRhZCIsIm5nTm90aWZ5Iiwidm0iLCJ0aGlzIiwibG9hZCIsInN1Y2Nlc3MiLCJkYXRhIiwibmVjZXNpZGFkZXMiLCJlcnJvciIsImVyciIsInNldCIsImZhY3RvcnkiLCIkaHR0cCIsImNhbGxiYWNrIiwiZ2V0Iiwic2hvdyIsImlkIiwiY2F0ZWdvcmlhIiwiY2xhdmUiLCJjcmVhdGUiLCJtZXRob2QiLCJ1cmwiLCJOZWNlc2lkYWRGb3JtIiwiZGlyZWN0aXZlIiwibGluayIsInNjb3BlIiwiZWwiLCJhdHRycyIsIm5nTW9kZWxDdHJsIiwicm91bmQiLCJudW0iLCJkIiwiTWF0aCIsInBvdyIsInByZWNpc2lvbiIsImZvcm1hdFByZWNpc2lvbiIsInZhbHVlIiwicGFyc2VGbG9hdCIsInRvRml4ZWQiLCJmb3JtYXRWaWV3VmFsdWUiLCIkaXNFbXB0eSIsImxhc3RWYWxpZFZhbHVlIiwibWluIiwiJHBhcnNlcnMiLCJwdXNoIiwiaXNVbmRlZmluZWQiLCJpbmRleE9mIiwiJHNldFZpZXdWYWx1ZSIsIiRyZW5kZXIiLCJlbXB0eSIsIk5VTUJFUl9SRUdFWFAiLCJ0ZXN0IiwiJHNldFZhbGlkaXR5IiwiJGZvcm1hdHRlcnMiLCJtaW5WYWxpZGF0b3IiLCJtYXgiLCJtYXhWYWxpZGF0b3IiLCJiaW5kIiwiJG1vZGVsVmFsdWUiLCIkdmlld1ZhbHVlIiwicmVzdHJpY3QiLCJyZXF1aXJlIiwiZWxlbWVudCIsIm1vZGVsQ3RybCIsImlucHV0VmFsdWUiLCJ1bmRlZmluZWQiLCJ0cmFuc2Zvcm1lZElucHV0IiwicmVwbGFjZSIsImZpbHRlciIsImxvY2FsZSIsImN1cnJlbmN5RmlsdGVyIiwiZm9ybWF0cyIsIk5VTUJFUl9GT1JNQVRTIiwiYW1vdW50IiwiY3VycmVuY3lTeW1ib2wiLCJzZXAiLCJERUNJTUFMX1NFUCIsInN5bWJvbCIsIkNVUlJFTkNZX1NZTSIsInN1YnN0cmluZyIsIiRyb290U2NvcGUiLCIkc2NvcGUiLCJ1c2VyQWdlbnQiLCJuYXZpZ2F0b3IiLCIkb24iLCJsb2FkaW5nIiwiYm90dG9tUmVhY2hlZCIsImFsZXJ0Iiwibm90aWNlcyIsImoiLCJpY29uIiwibWVzc2FnZSIsImRlbGV0ZU5vdGljZSIsIm5vdGljZSIsImluZGV4Iiwic3BsaWNlIiwiVXNlciIsIm9uZSIsInRoZW4iLCJGb3JtVXNlciIsInVwZGF0ZVByb2ZpbGUiLCJwdXQiLCJhbGwiLCJSZXN0YW5ndWxhciJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxZQUVBQSxTQUNBQyxPQUFBLE9BQ0EsVUFDQSxvQkFDQSxXQUNBLFdBQ0EsV0FDQSxnQkFPQSwrQkFFQUMsS0FBQSxhQUFBLFNBQUFDLEdBQ0FDLE9BQUFELFdBQUFBLEtBRUFFLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsS0FBQSxLQUNBQyxZQUFBLHlCQUNBQyxnQkFBQSxJQUVBRixLQUFBLEtBQ0FDLFlBQUEsMkJBQ0FDLGdCQUFBLEVBQ0FDLFdBQUEsV0FDQUMsYUFBQSxhQUdBQyxXQUNBQyxXQUFBLFlDcENBLFdBQ0EsWUFDQWIsU0FDQUMsT0FBQSxlQUNBUyxXQUFBLFlB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cyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJywgW1xuICAgICAgJ25nUm91dGUnLFxuICAgICAgJ21vYmlsZS1hbmd1bGFyLXVpJyxcbiAgICAgICdhcHAubWFpbicsXG4gICAgICAnYXBwLmhvbWUnLFxuICAgICAgJ25nTm90aWZ5JyxcbiAgICAgICdhcHAubmVjZXNpZGFkJyxcbiAgICAgIC8vIHRvdWNoL2RyYWcgZmVhdHVyZTogdGhpcyBpcyBmcm9tICdtb2JpbGUtYW5ndWxhci11aS5nZXN0dXJlcy5qcydcbiAgICAgIC8vIGl0IGlzIGF0IGEgdmVyeSBiZWdpbm5pbmcgc3RhZ2UsIHNvIHBsZWFzZSBiZSBjYXJlZnVsIGlmIHlvdSBsaWtlIHRvIHVzZVxuICAgICAgLy8gaW4gcHJvZHVjdGlvbi4gVGhpcyBpcyBpbnRlbmRlZCB0byBwcm92aWRlIGEgZmxleGlibGUsIGludGVncmF0ZWQgYW5kIGFuZFxuICAgICAgLy8gZWFzeSB0byB1c2UgYWx0ZXJuYXRpdmUgdG8gb3RoZXIgM3JkIHBhcnR5IGxpYnMgbGlrZSBoYW1tZXIuanMsIHdpdGggdGhlXG4gICAgICAvLyBmaW5hbCBwb3VycG9zZSB0byBpbnRlZ3JhdGUgZ2VzdHVyZXMgaW50byBkZWZhdWx0IHVpIGludGVyYWN0aW9ucyBsaWtlXG4gICAgICAvLyBvcGVuaW5nIHNpZGViYXJzLCB0dXJuaW5nIHN3aXRjaGVzIG9uL29mZiAuLlxuICAgICAgJ21vYmlsZS1hbmd1bGFyLXVpLmdlc3R1cmVzJ1xuICAgIF0pXG4gICAgLnJ1bihbJyR0cmFuc2Zvcm0nLGZ1bmN0aW9uKCR0cmFuc2Zvcm0pIHtcbiAgICAgIHdpbmRvdy4kdHJhbnNmb3JtID0gJHRyYW5zZm9ybTtcbiAgICB9XSlcbiAgICAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xuICAgICAgJHJvdXRlUHJvdmlkZXJcbiAgICAgICAgLndoZW4oJy8nLCB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL2hvbWUvaG9tZS5odG1sJyxcbiAgICAgICAgICByZWxvYWRPblNlYXJjaDogZmFsc2VcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy8nLCB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL2hvbWUvc2Nyb2xsLmh0bWwnLFxuICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZSxcbiAgICAgICAgICBjb250cm9sbGVyOidIb21lQ3RybCcsXG4gICAgICAgICAgY29udHJvbGxlckFzOidIb21lQ3RybCdcbiAgICAgICAgfSlcblxuICAgICAgICAub3RoZXJ3aXNlKHtcbiAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cbiAgICAvLyBhcHAuZGlyZWN0aXZlKCd0b3VjaGFyZWEnLCBbJyR0b3VjaCcsIGZ1bmN0aW9uKCR0b3VjaCl7XG4gICAgLy8gICAvLyBSdW5zIGR1cmluZyBjb21waWxlXG4gICAgLy8gICByZXR1cm4ge1xuICAgIC8vICAgICByZXN0cmljdDogJ0MnLFxuICAgIC8vICAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsIGVsZW0pIHtcbiAgICAvLyAgICAgICAkc2NvcGUudG91Y2ggPSBudWxsO1xuICAgIC8vICAgICAgICR0b3VjaC5iaW5kKGVsZW0sIHtcbiAgICAvLyAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbih0b3VjaCkge1xuICAgIC8vICAgICAgICAgICAkc2NvcGUudG91Y2ggPSB0b3VjaDtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIC8vICAgICAgICAgfSxcbiAgICAvL1xuICAgIC8vICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbih0b3VjaCkge1xuICAgIC8vICAgICAgICAgICAkc2NvcGUudG91Y2ggPSB0b3VjaDtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIC8vICAgICAgICAgfSxcbiAgICAvL1xuICAgIC8vICAgICAgICAgbW92ZTogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH0sXG4gICAgLy9cbiAgICAvLyAgICAgICAgIGVuZDogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgICB9KTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9XSk7XG4gICAgLy9cbiAgICAvLyAvL1xuICAgIC8vIC8vIGAkZHJhZ2AgZXhhbXBsZTogZHJhZyB0byBkaXNtaXNzXG4gICAgLy8gLy9cbiAgICAvLyBhcHAuZGlyZWN0aXZlKCdkcmFnVG9EaXNtaXNzJywgZnVuY3Rpb24oJGRyYWcsICRwYXJzZSwgJHRpbWVvdXQpe1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAvLyAgICAgY29tcGlsZTogZnVuY3Rpb24oZWxlbSwgYXR0cnMpIHtcbiAgICAvLyAgICAgICB2YXIgZGlzbWlzc0ZuID0gJHBhcnNlKGF0dHJzLmRyYWdUb0Rpc21pc3MpO1xuICAgIC8vICAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbSl7XG4gICAgLy8gICAgICAgICB2YXIgZGlzbWlzcyA9IGZhbHNlO1xuICAgIC8vXG4gICAgLy8gICAgICAgICAkZHJhZy5iaW5kKGVsZW0sIHtcbiAgICAvLyAgICAgICAgICAgdHJhbnNmb3JtOiAkZHJhZy5UUkFOU0xBVEVfUklHSFQsXG4gICAgLy8gICAgICAgICAgIG1vdmU6IGZ1bmN0aW9uKGRyYWcpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiggZHJhZy5kaXN0YW5jZVggPj0gZHJhZy5yZWN0LndpZHRoIC8gNCkge1xuICAgIC8vICAgICAgICAgICAgICAgZGlzbWlzcyA9IHRydWU7XG4gICAgLy8gICAgICAgICAgICAgICBlbGVtLmFkZENsYXNzKCdkaXNtaXNzJyk7XG4gICAgLy8gICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAvLyAgICAgICAgICAgICAgIGRpc21pc3MgPSBmYWxzZTtcbiAgICAvLyAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3MoJ2Rpc21pc3MnKTtcbiAgICAvLyAgICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICAgIH0sXG4gICAgLy8gICAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgICAgICAgICBlbGVtLnJlbW92ZUNsYXNzKCdkaXNtaXNzJyk7XG4gICAgLy8gICAgICAgICAgIH0sXG4gICAgLy8gICAgICAgICAgIGVuZDogZnVuY3Rpb24oZHJhZykge1xuICAgIC8vICAgICAgICAgICAgIGlmIChkaXNtaXNzKSB7XG4gICAgLy8gICAgICAgICAgICAgICBlbGVtLmFkZENsYXNzKCdkaXNtaXR0ZWQnKTtcbiAgICAvLyAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgIC8vICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgICAgICAgICAgICAgICAgZGlzbWlzc0ZuKHNjb3BlKTtcbiAgICAvLyAgICAgICAgICAgICAgICAgfSk7XG4gICAgLy8gICAgICAgICAgICAgICB9LCAzMDApO1xuICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICAgICAgICBkcmFnLnJlc2V0KCk7XG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICB9KTtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9O1xuICAgIC8vIH0pO1xuICAgIC8vXG4gICAgLy8gLy9cbiAgICAvLyAvLyBBbm90aGVyIGAkZHJhZ2AgdXNhZ2UgZXhhbXBsZTogdGhpcyBpcyBob3cgeW91IGNvdWxkIGNyZWF0ZVxuICAgIC8vIC8vIGEgdG91Y2ggZW5hYmxlZCBcImRlY2sgb2YgY2FyZHNcIiBjYXJvdXNlbC4gU2VlIGBjYXJvdXNlbC5odG1sYCBmb3IgbWFya3VwLlxuICAgIC8vIC8vXG4gICAgLy8gYXBwLmRpcmVjdGl2ZSgnY2Fyb3VzZWwnLCBmdW5jdGlvbigpe1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAvLyAgICAgc2NvcGU6IHt9LFxuICAgIC8vICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgICB0aGlzLml0ZW1Db3VudCA9IDA7XG4gICAgLy8gICAgICAgdGhpcy5hY3RpdmVJdGVtID0gbnVsbDtcbiAgICAvL1xuICAgIC8vICAgICAgIHRoaXMuYWRkSXRlbSA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICB2YXIgbmV3SWQgPSB0aGlzLml0ZW1Db3VudCsrO1xuICAgIC8vICAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gdGhpcy5pdGVtQ291bnQgPT09IDEgPyBuZXdJZCA6IHRoaXMuYWN0aXZlSXRlbTtcbiAgICAvLyAgICAgICAgIHJldHVybiBuZXdJZDtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vXG4gICAgLy8gICAgICAgdGhpcy5uZXh0ID0gZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSB8fCAwO1xuICAgIC8vICAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gdGhpcy5hY3RpdmVJdGVtID09PSB0aGlzLml0ZW1Db3VudCAtIDEgPyAwIDogdGhpcy5hY3RpdmVJdGVtICsgMTtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vXG4gICAgLy8gICAgICAgdGhpcy5wcmV2ID0gZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSB8fCAwO1xuICAgIC8vICAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gdGhpcy5hY3RpdmVJdGVtID09PSAwID8gdGhpcy5pdGVtQ291bnQgLSAxIDogdGhpcy5hY3RpdmVJdGVtIC0gMTtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9O1xuICAgIC8vIH0pO1xuXG5cblxuICAgIC8vXG4gICAgLy8gRm9yIHRoaXMgdHJpdmlhbCBkZW1vIHdlIGhhdmUganVzdCBhIHVuaXF1ZSBNYWluQ29udHJvbGxlclxuICAgIC8vIGZvciBldmVyeXRoaW5nXG4gICAgLy9cbiAgICAvLyBhcHAuY29udHJvbGxlcignTWFpbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUpe1xuICAgIC8vXG4gICAgLy8gICAkc2NvcGUuc3dpcGVkID0gZnVuY3Rpb24oZGlyZWN0aW9uKSB7XG4gICAgLy8gICAgIGFsZXJ0KCdTd2lwZWQgJyArIGRpcmVjdGlvbik7XG4gICAgLy8gICB9O1xuICAgIC8vXG4gICAgLy8gICAvLyBVc2VyIGFnZW50IGRpc3BsYXllZCBpbiBob21lIHBhZ2VcbiAgICAvLyAgICRzY29wZS51c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuICAgIC8vXG4gICAgLy8gICAvLyBOZWVkZWQgZm9yIHRoZSBsb2FkaW5nIHNjcmVlblxuICAgIC8vICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgJHJvb3RTY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAvLyAgIH0pO1xuICAgIC8vXG4gICAgLy8gICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgIC8vICAgfSk7XG4gICAgLy9cbiAgICAvLyAgIC8vIEZha2UgdGV4dCBpIHVzZWQgaGVyZSBhbmQgdGhlcmUuXG4gICAgLy8gICAkc2NvcGUubG9yZW0gPSAnTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2ljaW5nIGVsaXQuIFZlbCBleHBsaWNhYm8sIGFsaXF1aWQgZWFxdWUgc29sdXRhIG5paGlsIGVsaWdlbmRpIGFkaXBpc2NpIGVycm9yLCBpbGx1bSBjb3JydXB0aSBuYW0gZnVnYSBvbW5pcyBxdW9kIHF1YWVyYXQgbW9sbGl0aWEgZXhwZWRpdGEgaW1wZWRpdCBkb2xvcmVzIGlwc2FtLiBPYmNhZWNhdGkuJztcbiAgICAvL1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vICdTY3JvbGwnIHNjcmVlblxuICAgIC8vICAgLy9cbiAgICAvLyAgIHZhciBzY3JvbGxJdGVtcyA9IFtdO1xuICAgIC8vXG4gICAgLy8gICBmb3IgKHZhciBpPTE7IGk8PTEwMDsgaSsrKSB7XG4gICAgLy8gICAgIHNjcm9sbEl0ZW1zLnB1c2goJ0l0ZW0gJyArIGkpO1xuICAgIC8vICAgfVxuICAgIC8vXG4gICAgLy8gICAkc2NvcGUuc2Nyb2xsSXRlbXMgPSBzY3JvbGxJdGVtcztcbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLmJvdHRvbVJlYWNoZWQgPSBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgLyogZ2xvYmFsIGFsZXJ0OiBmYWxzZTsgKi9cbiAgICAvLyAgICAgYWxlcnQoJ0NvbmdyYXRzIHlvdSBzY3JvbGxlZCB0byB0aGUgZW5kIG9mIHRoZSBsaXN0IScpO1xuICAgIC8vICAgfTtcbiAgICAvL1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vIFJpZ2h0IFNpZGViYXJcbiAgICAvLyAgIC8vXG4gICAgLy8gICAkc2NvcGUuY2hhdFVzZXJzID0gW1xuICAgIC8vICAgICB7IG5hbWU6ICdDYXJsb3MgIEZsb3dlcnMnLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQnlyb24gVGF5bG9yJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0phbmEgIFRlcnJ5Jywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0RhcnJ5bCAgU3RvbmUnLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnRmFubmllICBDYXJsc29uJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0hvbGx5IE5ndXllbicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdCaWxsICBDaGF2ZXonLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnVmVyb25pY2EgIE1heHdlbGwnLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnSmVzc2ljYSBXZWJzdGVyJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0phY2tpZSAgQmFydG9uJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0NyeXN0YWwgRHJha2UnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ01pbHRvbiAgRGVhbicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnSm9hbm4gSm9obnN0b24nLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0NvcmEgIFZhdWdobicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnTmluYSAgQnJpZ2dzJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdDYXNleSBUdXJuZXInLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0ppbW1pZSAgV2lsc29uJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdOYXRoYW5pZWwgU3RlZWxlJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdBdWJyZXkgIENvbGUnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0Rvbm5pZSAgU3VtbWVycycsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnS2F0ZSAgTXllcnMnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ1ByaXNjaWxsYSBIYXdraW5zJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKb2UgQmFya2VyJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdMZWUgTm9ybWFuJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdFYm9ueSBSaWNlJywgb25saW5lOiBmYWxzZSB9XG4gICAgLy8gICBdO1xuICAgIC8vXG4gICAgLy8gICAvL1xuICAgIC8vICAgLy8gJ0Zvcm1zJyBzY3JlZW5cbiAgICAvLyAgIC8vXG4gICAgLy8gICAkc2NvcGUucmVtZW1iZXJNZSA9IHRydWU7XG4gICAgLy8gICAkc2NvcGUuZW1haWwgPSAnbWVAZXhhbXBsZS5jb20nO1xuICAgIC8vXG4gICAgLy8gICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgYWxlcnQoJ1lvdSBzdWJtaXR0ZWQgdGhlIGxvZ2luIGZvcm0nKTtcbiAgICAvLyAgIH07XG4gICAgLy9cbiAgICAvLyAgIC8vXG4gICAgLy8gICAvLyAnRHJhZycgc2NyZWVuXG4gICAgLy8gICAvL1xuICAgIC8vICAgJHNjb3BlLm5vdGljZXMgPSBbXTtcbiAgICAvL1xuICAgIC8vICAgZm9yICh2YXIgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgLy8gICAgICRzY29wZS5ub3RpY2VzLnB1c2goe2ljb246ICdlbnZlbG9wZScsIG1lc3NhZ2U6ICdOb3RpY2UgJyArIChqICsgMSkgfSk7XG4gICAgLy8gICB9XG4gICAgLy9cbiAgICAvLyAgICRzY29wZS5kZWxldGVOb3RpY2UgPSBmdW5jdGlvbihub3RpY2UpIHtcbiAgICAvLyAgICAgdmFyIGluZGV4ID0gJHNjb3BlLm5vdGljZXMuaW5kZXhPZihub3RpY2UpO1xuICAgIC8vICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgIC8vICAgICAgICRzY29wZS5ub3RpY2VzLnNwbGljZShpbmRleCwgMSk7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH07XG4gICAgLy8gfSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAuaG9tZScsW10pXG4gICAgICAuY29udHJvbGxlcignSG9tZUN0cmwnLFsnTmVjZXNpZGFkJywnbmdOb3RpZnknLGZ1bmN0aW9uIChOZWNlc2lkYWQsbmdOb3RpZnkpIHtcblxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIE5lY2VzaWRhZC5sb2FkKClcbiAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICB2bS5uZWNlc2lkYWRlcyA9IGRhdGE7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwgJ2Vycm9yJyk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAubmVjZXNpZGFkJyxbXG4gICAgICAnYXBwLm5lY2VzaWRhZC5zZXJ2aWNlJyxcbiAgICAgICdhcHAubmVjZXNpZGFkLm51ZXZhJ1xuICAgIF0pXG4gICAgICAuY29udHJvbGxlcignTmVjZXNpZGFkZXNDdHJsJyxbJ05lY2VzaWRhZCcsJ25nTm90aWZ5JyxmdW5jdGlvbiAoTmVjZXNpZGFkLG5nTm90aWZ5KSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICBOZWNlc2lkYWQubG9hZCgpXG4gICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgdm0ubmVjZXNpZGFkZXMgPSBkYXRhO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIG5nTm90aWZ5LnNldChlcnIsICdlcnJvcicpO1xuICAgICAgICAgIH0pO1xuXG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAubmVjZXNpZGFkLnNlcnZpY2UnLFtdKVxuICAgICAgLmZhY3RvcnkoJ05lY2VzaWRhZCcsWyckaHR0cCcsZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBsb2FkOmZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9uZWNlc2lkYWRlcycpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2hvdzpmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvbmVjZXNpZGFkZXMvJyArIGlkKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNhdGVnb3JpYTpmdW5jdGlvbiAoY2xhdmUpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2F0ZWdvcmlhcy8nICsgY2xhdmUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY3JlYXRlOmZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgICBkYXRhICAgIDogIGRhdGEsXG4gICAgICAgICAgICAgIG1ldGhvZCAgOiAnUE9TVCcsXG4gICAgICAgICAgICAgIHVybCAgICAgOiAnL2FwaS9uZWNlc2lkYWRlcydcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICB9XSlcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAubmVjZXNpZGFkLm51ZXZhJyxbXSlcbiAgICAgIC5jb250cm9sbGVyKCdOdWV2YU5lY2VzaWRhZEN0cmwnLFsnTmVjZXNpZGFkJywnbmdOb3RpZnknLGZ1bmN0aW9uIChOZWNlc2lkYWQsbmdOb3RpZnkpIHtcblxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5OZWNlc2lkYWRGb3JtID0ge307XG5cbiAgICAgICAgdm0uY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIE5lY2VzaWRhZC5jcmVhdGUodm0uTmVjZXNpZGFkRm9ybSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIG5nTm90aWZ5LnNldChkYXRhLCdzdWNjZXNzJyk7XG4gICAgICAgICAgICAgIHZtLk5lY2VzaWRhZEZvcm0gPSBudWxsO1xuICAgICAgICAgICAgICB2bS5OZWNlc2lkYWRGb3JtID0ge307XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICB9XSk7XG59KSgpO1xuIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ2FwcC5kaXJlY3RpdmVzJywgW10pXG4gIC5kaXJlY3RpdmUoJ21vbmV5JywgZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIE5VTUJFUl9SRUdFWFAgPSAvXlxccyooXFwtfFxcKyk/KFxcZCt8KFxcZCooXFwuXFxkKikpKVxccyokLztcblxuICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsLCBhdHRycywgbmdNb2RlbEN0cmwpIHtcbiAgICAgIHZhciBtaW4gPSBwYXJzZUZsb2F0KGF0dHJzLm1pbiB8fCAwKTtcbiAgICAgIHZhciBwcmVjaXNpb24gPSBwYXJzZUZsb2F0KGF0dHJzLnByZWNpc2lvbiB8fCAyKTtcbiAgICAgIHZhciBsYXN0VmFsaWRWYWx1ZTtcblxuICAgICAgZnVuY3Rpb24gcm91bmQobnVtKSB7XG4gICAgICAgIHZhciBkID0gTWF0aC5wb3coMTAsIHByZWNpc2lvbik7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKG51bSAqIGQpIC8gZDtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZm9ybWF0UHJlY2lzaW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHZhbHVlKS50b0ZpeGVkKHByZWNpc2lvbik7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGZvcm1hdFZpZXdWYWx1ZSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gbmdNb2RlbEN0cmwuJGlzRW1wdHkodmFsdWUpID8gJycgOiAnJyArIHZhbHVlO1xuICAgICAgfVxuXG5cbiAgICAgIG5nTW9kZWxDdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKHZhbHVlKSkge1xuICAgICAgICAgIHZhbHVlID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBIYW5kbGUgbGVhZGluZyBkZWNpbWFsIHBvaW50LCBsaWtlIFwiLjVcIlxuICAgICAgICBpZiAodmFsdWUuaW5kZXhPZignLicpID09PSAwKSB7XG4gICAgICAgICAgdmFsdWUgPSAnMCcgKyB2YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFsbG93IFwiLVwiIGlucHV0cyBvbmx5IHdoZW4gbWluIDwgMFxuICAgICAgICBpZiAodmFsdWUuaW5kZXhPZignLScpID09PSAwKSB7XG4gICAgICAgICAgaWYgKG1pbiA+PSAwKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IG51bGw7XG4gICAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKCcnKTtcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAnLScpIHtcbiAgICAgICAgICAgIHZhbHVlID0gJyc7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGVtcHR5ID0gbmdNb2RlbEN0cmwuJGlzRW1wdHkodmFsdWUpO1xuICAgICAgICBpZiAoZW1wdHkgfHwgTlVNQkVSX1JFR0VYUC50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgIGxhc3RWYWxpZFZhbHVlID0gKHZhbHVlID09PSAnJylcbiAgICAgICAgICA/IG51bGxcbiAgICAgICAgICA6IChlbXB0eSA/IHZhbHVlIDogcGFyc2VGbG9hdCh2YWx1ZSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIFJlbmRlciB0aGUgbGFzdCB2YWxpZCBpbnB1dCBpbiB0aGUgZmllbGRcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKGZvcm1hdFZpZXdWYWx1ZShsYXN0VmFsaWRWYWx1ZSkpO1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgnbnVtYmVyJywgdHJ1ZSk7XG4gICAgICAgIHJldHVybiBsYXN0VmFsaWRWYWx1ZTtcbiAgICAgIH0pO1xuICAgICAgbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMucHVzaChmb3JtYXRWaWV3VmFsdWUpO1xuXG4gICAgICB2YXIgbWluVmFsaWRhdG9yID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgaWYgKCFuZ01vZGVsQ3RybC4kaXNFbXB0eSh2YWx1ZSkgJiYgdmFsdWUgPCBtaW4pIHtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0VmFsaWRpdHkoJ21pbicsIGZhbHNlKTtcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgnbWluJywgdHJ1ZSk7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChtaW5WYWxpZGF0b3IpO1xuICAgICAgbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMucHVzaChtaW5WYWxpZGF0b3IpO1xuXG4gICAgICBpZiAoYXR0cnMubWF4KSB7XG4gICAgICAgIHZhciBtYXggPSBwYXJzZUZsb2F0KGF0dHJzLm1heCk7XG4gICAgICAgIHZhciBtYXhWYWxpZGF0b3IgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGlmICghbmdNb2RlbEN0cmwuJGlzRW1wdHkodmFsdWUpICYmIHZhbHVlID4gbWF4KSB7XG4gICAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0VmFsaWRpdHkoJ21heCcsIGZhbHNlKTtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgnbWF4JywgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIG5nTW9kZWxDdHJsLiRwYXJzZXJzLnB1c2gobWF4VmFsaWRhdG9yKTtcbiAgICAgICAgbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMucHVzaChtYXhWYWxpZGF0b3IpO1xuICAgICAgfVxuXG4gICAgICAvLyBSb3VuZCBvZmZcbiAgICAgIGlmIChwcmVjaXNpb24gPiAtMSkge1xuICAgICAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiB2YWx1ZSA/IHJvdW5kKHZhbHVlKSA6IHZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgICAgbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWUgPyBmb3JtYXRQcmVjaXNpb24odmFsdWUpIDogdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBlbC5iaW5kKCdibHVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBuZ01vZGVsQ3RybC4kbW9kZWxWYWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSA9IGZvcm1hdFByZWNpc2lvbih2YWx1ZSk7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcbiAgICAgIGxpbms6IGxpbmtcbiAgICB9O1xuICB9KS5kaXJlY3RpdmUoJ251bWJlcnNPbmx5JywgZnVuY3Rpb24oKXtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbW9kZWxDdHJsKSB7XG4gICAgICAgIG1vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uIChpbnB1dFZhbHVlKSB7XG4gICAgICAgICAgLy8gdGhpcyBuZXh0IGlmIGlzIG5lY2Vzc2FyeSBmb3Igd2hlbiB1c2luZyBuZy1yZXF1aXJlZCBvbiB5b3VyIGlucHV0LlxuICAgICAgICAgIC8vIEluIHN1Y2ggY2FzZXMsIHdoZW4gYSBsZXR0ZXIgaXMgdHlwZWQgZmlyc3QsIHRoaXMgcGFyc2VyIHdpbGwgYmUgY2FsbGVkXG4gICAgICAgICAgLy8gYWdhaW4sIGFuZCB0aGUgMm5kIHRpbWUsIHRoZSB2YWx1ZSB3aWxsIGJlIHVuZGVmaW5lZFxuICAgICAgICAgIGlmIChpbnB1dFZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybiAnJztcbiAgICAgICAgICB2YXIgdHJhbnNmb3JtZWRJbnB1dCA9IGlucHV0VmFsdWUucmVwbGFjZSgvW14wLTkrLl0vZywgJycpO1xuICAgICAgICAgIGlmICh0cmFuc2Zvcm1lZElucHV0IT09aW5wdXRWYWx1ZSkge1xuICAgICAgICAgICAgbW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUodHJhbnNmb3JtZWRJbnB1dCk7XG4gICAgICAgICAgICBtb2RlbEN0cmwuJHJlbmRlcigpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB0cmFuc2Zvcm1lZElucHV0O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAuZmlsdGVycycsW10pXG4gIC5maWx0ZXIoJ2RpbmVybycsXG4gIFsgJyRmaWx0ZXInLCAnJGxvY2FsZScsIGZ1bmN0aW9uKGZpbHRlciwgbG9jYWxlKSB7XG4gICAgdmFyIGN1cnJlbmN5RmlsdGVyID0gZmlsdGVyKCdjdXJyZW5jeScpO1xuICAgIHZhciBmb3JtYXRzID0gbG9jYWxlLk5VTUJFUl9GT1JNQVRTO1xuICAgIHJldHVybiBmdW5jdGlvbihhbW91bnQsIG51bSwgY3VycmVuY3lTeW1ib2wpIHtcbiAgICAgIGlmIChudW09PT0wKSBudW0gPSAtMTtcbiAgICAgIHZhciB2YWx1ZSA9IGN1cnJlbmN5RmlsdGVyKGFtb3VudCwgY3VycmVuY3lTeW1ib2wpO1xuICAgICAgdmFyIHNlcCA9IHZhbHVlLmluZGV4T2YoZm9ybWF0cy5ERUNJTUFMX1NFUCkrMTtcbiAgICAgIHZhciBzeW1ib2wgPSAnJztcbiAgICAgIGlmIChzZXA8dmFsdWUuaW5kZXhPZihmb3JtYXRzLkNVUlJFTkNZX1NZTSkpIHN5bWJvbCA9ICcgJytmb3JtYXRzLkNVUlJFTkNZX1NZTTtcbiAgICAgIHJldHVybiB2YWx1ZS5zdWJzdHJpbmcoMCwgc2VwK251bSkrc3ltYm9sO1xuICAgIH07XG4gIH0gXSk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gICAgYW5ndWxhclxuICAgICAgLm1vZHVsZSgnYXBwLm1haW4nLCBbXG4gICAgICAnYXBwLmRpcmVjdGl2ZXMnLFxuICAgICAgJ2FwcC5maWx0ZXJzJ1xuICAgIF0pXG4gICAgLmNvbnRyb2xsZXIoJ01haW5Db250cm9sbGVyJyxbJyRyb290U2NvcGUnLCckc2NvcGUnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUpe1xuXG5cblxuICAgICAgLy8gVXNlciBhZ2VudCBkaXNwbGF5ZWQgaW4gaG9tZSBwYWdlXG4gICAgICAkc2NvcGUudXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcblxuICAgICAgLy8gTmVlZGVkIGZvciB0aGUgbG9hZGluZyBzY3JlZW5cbiAgICAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICRyb290U2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICB9KTtcblxuICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpe1xuICAgICAgICAkcm9vdFNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIH0pO1xuXG5cblxuICAgICAgJHNjb3BlLmJvdHRvbVJlYWNoZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLyogZ2xvYmFsIGFsZXJ0OiBmYWxzZTsgKi9cbiAgICAgICAgYWxlcnQoJ0NvbmdyYXRzIHlvdSBzY3JvbGxlZCB0byB0aGUgZW5kIG9mIHRoZSBsaXN0IScpO1xuICAgICAgfTtcblxuXG4gICAgICAvL1xuICAgICAgLy8gJ0RyYWcnIHNjcmVlblxuICAgICAgLy9cbiAgICAgICRzY29wZS5ub3RpY2VzID0gW107XG5cbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICAkc2NvcGUubm90aWNlcy5wdXNoKHtpY29uOiAnZW52ZWxvcGUnLCBtZXNzYWdlOiAnTm90aWNlICcgKyAoaiArIDEpIH0pO1xuICAgICAgfVxuXG4gICAgICAkc2NvcGUuZGVsZXRlTm90aWNlID0gZnVuY3Rpb24obm90aWNlKSB7XG4gICAgICAgIHZhciBpbmRleCA9ICRzY29wZS5ub3RpY2VzLmluZGV4T2Yobm90aWNlKTtcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAkc2NvcGUubm90aWNlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAudXNlcnMnLCBbJ2FwcC51c2Vycy5zZXJ2aWNlJ10pXG4gICAgLmNvbnRyb2xsZXIoJ1VzZXJDdHJsJyxbJyRzY29wZScsJ1VzZXInLGZ1bmN0aW9uKCRzY29wZSxVc2VyKXtcblxuICAgICAgVXNlci5vbmUoJ3Byb2ZpbGUnKS5nZXQoKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAgKGRhdGEpIHtcbiAgICAgICAgICAkc2NvcGUuRm9ybVVzZXIgPSBkYXRhO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24gIChlcnIpIHtcbiAgICAgICAgICBhbGVydChlcnIuZGF0YSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAkc2NvcGUudXBkYXRlUHJvZmlsZSA9IGZ1bmN0aW9uICAoKSB7XG4gICAgICAgICRzY29wZS5Gb3JtVXNlci5wdXQoKVxuICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAgKGVycikge1xuICAgICAgICAgICAgYWxlcnQoZXJyLmRhdGEpO1xuICAgICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9XSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAudXNlcnMuc2VydmljZScsICBbXSlcblxuICAgICAgLmZhY3RvcnkgKCdVc2VyJywgWyckaHR0cCcsZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBhbGw6UmVzdGFuZ3VsYXIuYWxsKCdhcGkvdXNlcnMnKSxcbiAgICAgICAgICBvbmU6ZnVuY3Rpb24gIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuIFJlc3Rhbmd1bGFyLm9uZSgnYXBpL3VzZXJzJyxpZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfV0pO1xuXG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
