!function(){"use strict";angular.module("app",["ngRoute","mobile-angular-ui","app.main","app.home","ngNotify","app.user","app.necesidad","mobile-angular-ui.gestures"]).run(["$transform",function(e){window.$transform=e}]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"scripts/home/home.html",reloadOnSearch:!1}).when("/",{templateUrl:"scripts/home/scroll.html",reloadOnSearch:!1,controller:"HomeCtrl",controllerAs:"HomeCtrl"}).when("/necesidad/:id",{templateUrl:"scripts/necesidad/detalle.html",controller:"NecesidadDetalleCtrl",controllerAs:"DetalleCtrl"}).when("/necesidad/:id/editar",{templateUrl:"scripts/necesidad/editar.html",controller:"NecesidadDetalleCtrl",controllerAs:"DetalleCtrl"}).when("/categoria/:categoria",{templateUrl:"scripts/necesidad/categoria.html",reloadOnSearch:!1,controller:"CategoriaCtrl",controllerAs:"CategoriaCtrl"}).otherwise({redirectTo:"/"})}])}(),function(){"use strict";angular.module("app.home",[]).controller("HomeCtrl",["Necesidad","ngNotify",function(e,r){var t=this;e.load().success(function(e){t.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),angular.module("app.directives",[]).directive("money",function(){function e(e,t,n,i){function o(e){var r=Math.pow(10,d);return Math.round(e*r)/r}function a(e){return parseFloat(e).toFixed(d)}function s(e){return i.$isEmpty(e)?"":""+e}var c,u=parseFloat(n.min||0),d=parseFloat(n.precision||2);i.$parsers.push(function(e){angular.isUndefined(e)&&(e=""),0===e.indexOf(".")&&(e="0"+e),0===e.indexOf("-")&&(u>=0?(e=null,i.$setViewValue(""),i.$render()):"-"===e&&(e=""));var t=i.$isEmpty(e);return t||r.test(e)?c=""===e?null:t?e:parseFloat(e):(i.$setViewValue(s(c)),i.$render()),i.$setValidity("number",!0),c}),i.$formatters.push(s);var l=function(e){return!i.$isEmpty(e)&&u>e?void i.$setValidity("min",!1):(i.$setValidity("min",!0),e)};if(i.$parsers.push(l),i.$formatters.push(l),n.max){var p=parseFloat(n.max),f=function(e){return!i.$isEmpty(e)&&e>p?void i.$setValidity("max",!1):(i.$setValidity("max",!0),e)};i.$parsers.push(f),i.$formatters.push(f)}d>-1&&(i.$parsers.push(function(e){return e?o(e):e}),i.$formatters.push(function(e){return e?a(e):e})),t.bind("blur",function(){var e=i.$modelValue;e&&(i.$viewValue=a(e),i.$render())})}var r=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/;return{restrict:"A",require:"ngModel",link:e}}).directive("numbersOnly",function(){return{restrict:"A",require:"ngModel",link:function(e,r,t,n){n.$parsers.push(function(e){if(void 0===e)return"";var r=e.replace(/[^0-9+.]/g,"");return r!==e&&(n.$setViewValue(r),n.$render()),r})}}}),angular.module("app.filters",[]).filter("dinero",["$filter","$locale",function(e,r){var t=e("currency"),n=r.NUMBER_FORMATS;return function(e,r,i){0===r&&(r=-1);var o=t(e,i),a=o.indexOf(n.DECIMAL_SEP)+1,s="";return a<o.indexOf(n.CURRENCY_SYM)&&(s=" "+n.CURRENCY_SYM),o.substring(0,a+r)+s}}]),function(){"use strict";angular.module("app.main",["app.directives","app.filters"]).controller("MainController",["$rootScope","$scope","User",function(e,r,t){var n=this;t.me().success(function(e){n.user=e}).error(function(e){console.log(e)}),r.userAgent=navigator.userAgent,e.$on("$routeChangeStart",function(){e.loading=!0}),e.$on("$routeChangeSuccess",function(){e.loading=!1}),r.bottomReached=function(){alert("Congrats you scrolled to the end of the list!")},r.notices=[];for(var i=0;10>i;i++)r.notices.push({icon:"envelope",message:"Notice "+(i+1)});r.deleteNotice=function(e){var t=r.notices.indexOf(e);t>-1&&r.notices.splice(t,1)}}])}(),function(){"use strict";angular.module("app.necesidad.categoria",[]).controller("CategoriaCtrl",["Necesidad","$routeParams",function(e,r){var t=this;e.categoria(r.categoria).success(function(e){t.necesidades=e.necesidades,t.categoria=e.categoria}).error(function(e){console.error(e)})}])}(),function(){"use strict";angular.module("app.comentario.service",[]).factory("Comentario",["$http",function(e){return{"delete":function(r){return e["delete"]("/api/comentarios/"+r)},create:function(r){return e({data:r,method:"POST",url:"/api/necesidades/"+r.necesidadId+"/comentarios"})},update:function(r){return e({data:r,method:"PUT",url:"/api/comentarios/"+r.id})}}}])}(),function(){"use strict";angular.module("app.necesidad.detalle",[]).controller("NecesidadDetalleCtrl",["Necesidad","ngNotify","$routeParams","$window","Comentario",function(e,r,t,n,i){var o=this;o.necesidad={},o.ComentarioForm={},t.id&&e.show(t.id).success(function(e){o.necesidad=e}).error(function(e){r.set(e,"error")}),o.save=function(){e.update(o.necesidad).success(function(e){r.set(e,"success")}).error(function(e){r.set(e,"error")})},o.comentar=function(){o.ComentarioForm.necesidadId=o.necesidad.id,o.ComentarioForm.userId=o.necesidad.userId,o.Comentario.createdAt=new Date,i.create(o.ComentarioForm).success(function(e){r.set(e,"success"),o.necesidad.comentarios.push(o.ComentarioForm)}).error(function(e){r.set(e,"error")})},o["delete"]=function(){var t=confirm("Realmente deseas eliminar esta publicaci√≥n?");t&&e["delete"](o.necesidad.id).success(function(e){r.set(e,"success"),n.location="#/"}).error(function(e){r.set(e,"error")})}}])}(),function(){"use strict";angular.module("app.necesidad",["app.necesidad.service","app.necesidad.nueva","app.necesidad.detalle","app.necesidad.categoria","app.comentario.service"]).controller("NecesidadesCtrl",["Necesidad","ngNotify",function(e,r){var t=this;e.load().success(function(e){t.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad.service",[]).factory("Necesidad",["$http",function(e){return{load:function(r){return e.get("/api/necesidades")},show:function(r){return e.get("/api/necesidades/"+r)},categoria:function(r){return e.get("/api/categorias/"+r)},"delete":function(r){return e["delete"]("/api/necesidades/"+r)},create:function(r){return e({data:r,method:"POST",url:"/api/necesidades"})},update:function(r){return e({data:r,method:"PUT",url:"/api/necesidades/"+r.id})}}}])}(),function(){"use strict";angular.module("app.necesidad.nueva",[]).controller("NuevaNecesidadCtrl",["Necesidad","ngNotify","$window",function(e,r,t){var n=this;n.NecesidadForm={},n.create=function(){e.create(n.NecesidadForm).success(function(e){r.set(e,"success"),t.location="#/necesidad/"+e}).error(function(e){r.set(e,"error")})}}])}(),function(){"use strict";angular.module("app.user",["app.user.service"]).controller("UserCtrl",["$scope","User",function(e,r){r.one("profile").get().then(function(r){e.FormUser=r})["catch"](function(e){alert(e.data)}),e.updateProfile=function(){e.FormUser.put()["catch"](function(e){alert(e.data)})}}])}(),function(){"use strict";angular.module("app.user.service",[]).factory("User",["$http",function(e){return{me:function(){return e.get("/api/users/profile")}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImhvbWUvaG9tZS5jb250cm9sbGVyLmpzIiwic2hhcmVkL2RpcmVjdGl2ZXMuanMiLCJzaGFyZWQvZmlsdGVycy5qcyIsInNoYXJlZC9tYWluLmpzIiwibmVjZXNpZGFkL2NhdGVnb3JpYS5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL2NvbWVudGFyaW8uc2VydmljZS5qcyIsIm5lY2VzaWRhZC9kZXRhbGxlLmNvbnRyb2xsZXIuanMiLCJuZWNlc2lkYWQvbmVjZXNpZGFkLmNvbnRyb2xsZXIuanMiLCJuZWNlc2lkYWQvbmVjZXNpZGFkLnNlcnZpY2UuanMiLCJuZWNlc2lkYWQvbnVldmEuY29udHJvbGxlci5qcyIsInVzZXJzL2NvbnRyb2xsZXIuanMiLCJ1c2Vycy9zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkdHJhbnNmb3JtIiwid2luZG93IiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJyZWxvYWRPblNlYXJjaCIsImNvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiTmVjZXNpZGFkIiwibmdOb3RpZnkiLCJ2bSIsInRoaXMiLCJsb2FkIiwic3VjY2VzcyIsImRhdGEiLCJuZWNlc2lkYWRlcyIsImVycm9yIiwiZXJyIiwic2V0IiwiZGlyZWN0aXZlIiwibGluayIsInNjb3BlIiwiZWwiLCJhdHRycyIsIm5nTW9kZWxDdHJsIiwicm91bmQiLCJudW0iLCJkIiwiTWF0aCIsInBvdyIsInByZWNpc2lvbiIsImZvcm1hdFByZWNpc2lvbiIsInZhbHVlIiwicGFyc2VGbG9hdCIsInRvRml4ZWQiLCJmb3JtYXRWaWV3VmFsdWUiLCIkaXNFbXB0eSIsImxhc3RWYWxpZFZhbHVlIiwibWluIiwiJHBhcnNlcnMiLCJwdXNoIiwiaXNVbmRlZmluZWQiLCJpbmRleE9mIiwiJHNldFZpZXdWYWx1ZSIsIiRyZW5kZXIiLCJlbXB0eSIsIk5VTUJFUl9SRUdFWFAiLCJ0ZXN0IiwiJHNldFZhbGlkaXR5IiwiJGZvcm1hdHRlcnMiLCJtaW5WYWxpZGF0b3IiLCJtYXgiLCJtYXhWYWxpZGF0b3IiLCJiaW5kIiwiJG1vZGVsVmFsdWUiLCIkdmlld1ZhbHVlIiwicmVzdHJpY3QiLCJyZXF1aXJlIiwiZWxlbWVudCIsIm1vZGVsQ3RybCIsImlucHV0VmFsdWUiLCJ1bmRlZmluZWQiLCJ0cmFuc2Zvcm1lZElucHV0IiwicmVwbGFjZSIsImZpbHRlciIsImxvY2FsZSIsImN1cnJlbmN5RmlsdGVyIiwiZm9ybWF0cyIsIk5VTUJFUl9GT1JNQVRTIiwiYW1vdW50IiwiY3VycmVuY3lTeW1ib2wiLCJzZXAiLCJERUNJTUFMX1NFUCIsInN5bWJvbCIsIkNVUlJFTkNZX1NZTSIsInN1YnN0cmluZyIsIiRyb290U2NvcGUiLCIkc2NvcGUiLCJVc2VyIiwibWUiLCJ1c2VyIiwiY29uc29sZSIsImxvZyIsInVzZXJBZ2VudCIsIm5hdmlnYXRvciIsIiRvbiIsImxvYWRpbmciLCJib3R0b21SZWFjaGVkIiwiYWxlcnQiLCJub3RpY2VzIiwiaiIsImljb24iLCJtZXNzYWdlIiwiZGVsZXRlTm90aWNlIiwibm90aWNlIiwiaW5kZXgiLCJzcGxpY2UiLCIkcm91dGVQYXJhbXMiLCJjYXRlZ29yaWEiLCJmYWN0b3J5IiwiJGh0dHAiLCJkZWxldGUiLCJpZCIsImNyZWF0ZSIsIm1ldGhvZCIsInVybCIsIm5lY2VzaWRhZElkIiwidXBkYXRlIiwiJHdpbmRvdyIsIkNvbWVudGFyaW8iLCJuZWNlc2lkYWQiLCJDb21lbnRhcmlvRm9ybSIsInNob3ciLCJzYXZlIiwiY29tZW50YXIiLCJ1c2VySWQiLCJjcmVhdGVkQXQiLCJEYXRlIiwiY29tZW50YXJpb3MiLCJzdXJlIiwiY29uZmlybSIsImxvY2F0aW9uIiwiY2FsbGJhY2siLCJnZXQiLCJjbGF2ZSIsIk5lY2VzaWRhZEZvcm0iLCJvbmUiLCJ0aGVuIiwiRm9ybVVzZXIiLCJ1cGRhdGVQcm9maWxlIiwicHV0Il0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBLFlBRUFBLFNBQ0FDLE9BQUEsT0FDQSxVQUNBLG9CQUNBLFdBQ0EsV0FDQSxXQUNBLFdBQ0EsZ0JBT0EsK0JBRUFDLEtBQUEsYUFBQSxTQUFBQyxHQUNBQyxPQUFBRCxXQUFBQSxLQUVBRSxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLEtBQUEsS0FDQUMsWUFBQSx5QkFDQUMsZ0JBQUEsSUFFQUYsS0FBQSxLQUNBQyxZQUFBLDJCQUNBQyxnQkFBQSxFQUNBQyxXQUFBLFdBQ0FDLGFBQUEsYUFFQUosS0FBQSxrQkFDQUMsWUFBQSxpQ0FDQUUsV0FBQSx1QkFDQUMsYUFBQSxnQkFFQUosS0FBQSx5QkFDQUMsWUFBQSxnQ0FDQUUsV0FBQSx1QkFDQUMsYUFBQSxnQkFFQUosS0FBQSx5QkFDQUMsWUFBQSxtQ0FDQUMsZ0JBQUEsRUFDQUMsV0FBQSxnQkFDQUMsYUFBQSxrQkFHQUMsV0FDQUMsV0FBQSxZQ3JEQSxXQUNBLFlBQ0FiLFNBQ0FDLE9BQUEsZUFDQVMsV0FBQSxZQUFBLFlBQUEsV0FBQSxTQUFBSSxFQUFBQyxHQUVBLEdBQUFDLEdBQUFDLElBRUFILEdBQUFJLE9BQ0FDLFFBQUEsU0FBQUMsR0FDQUosRUFBQUssWUFBQUQsSUFFQUUsTUFBQSxTQUFBQyxHQUNBUixFQUFBUyxJQUFBRCxFQUFBLGlCQ1pBdkIsUUFBQUMsT0FBQSxxQkFDQXdCLFVBQUEsUUFBQSxXQUlBLFFBQUFDLEdBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBS0EsUUFBQUMsR0FBQUMsR0FDQSxHQUFBQyxHQUFBQyxLQUFBQyxJQUFBLEdBQUFDLEVBQ0EsT0FBQUYsTUFBQUgsTUFBQUMsRUFBQUMsR0FBQUEsRUFHQSxRQUFBSSxHQUFBQyxHQUNBLE1BQUFDLFlBQUFELEdBQUFFLFFBQUFKLEdBR0EsUUFBQUssR0FBQUgsR0FDQSxNQUFBUixHQUFBWSxTQUFBSixHQUFBLEdBQUEsR0FBQUEsRUFkQSxHQUVBSyxHQUZBQyxFQUFBTCxXQUFBVixFQUFBZSxLQUFBLEdBQ0FSLEVBQUFHLFdBQUFWLEVBQUFPLFdBQUEsRUFpQkFOLEdBQUFlLFNBQUFDLEtBQUEsU0FBQVIsR0FDQXRDLFFBQUErQyxZQUFBVCxLQUNBQSxFQUFBLElBSUEsSUFBQUEsRUFBQVUsUUFBQSxPQUNBVixFQUFBLElBQUFBLEdBSUEsSUFBQUEsRUFBQVUsUUFBQSxPQUNBSixHQUFBLEdBQ0FOLEVBQUEsS0FDQVIsRUFBQW1CLGNBQUEsSUFDQW5CLEVBQUFvQixXQUNBLE1BQUFaLElBQ0FBLEVBQUEsSUFJQSxJQUFBYSxHQUFBckIsRUFBQVksU0FBQUosRUFZQSxPQVhBYSxJQUFBQyxFQUFBQyxLQUFBZixHQUNBSyxFQUFBLEtBQUFMLEVBQ0EsS0FDQWEsRUFBQWIsRUFBQUMsV0FBQUQsSUFHQVIsRUFBQW1CLGNBQUFSLEVBQUFFLElBQ0FiLEVBQUFvQixXQUdBcEIsRUFBQXdCLGFBQUEsVUFBQSxHQUNBWCxJQUVBYixFQUFBeUIsWUFBQVQsS0FBQUwsRUFFQSxJQUFBZSxHQUFBLFNBQUFsQixHQUNBLE9BQUFSLEVBQUFZLFNBQUFKLElBQUFNLEVBQUFOLE1BQ0FSLEdBQUF3QixhQUFBLE9BQUEsSUFHQXhCLEVBQUF3QixhQUFBLE9BQUEsR0FDQWhCLEdBTUEsSUFIQVIsRUFBQWUsU0FBQUMsS0FBQVUsR0FDQTFCLEVBQUF5QixZQUFBVCxLQUFBVSxHQUVBM0IsRUFBQTRCLElBQUEsQ0FDQSxHQUFBQSxHQUFBbEIsV0FBQVYsRUFBQTRCLEtBQ0FDLEVBQUEsU0FBQXBCLEdBQ0EsT0FBQVIsRUFBQVksU0FBQUosSUFBQUEsRUFBQW1CLE1BQ0EzQixHQUFBd0IsYUFBQSxPQUFBLElBR0F4QixFQUFBd0IsYUFBQSxPQUFBLEdBQ0FoQixHQUlBUixHQUFBZSxTQUFBQyxLQUFBWSxHQUNBNUIsRUFBQXlCLFlBQUFULEtBQUFZLEdBSUF0QixFQUFBLEtBQ0FOLEVBQUFlLFNBQUFDLEtBQUEsU0FBQVIsR0FDQSxNQUFBQSxHQUFBUCxFQUFBTyxHQUFBQSxJQUVBUixFQUFBeUIsWUFBQVQsS0FBQSxTQUFBUixHQUNBLE1BQUFBLEdBQUFELEVBQUFDLEdBQUFBLEtBSUFWLEVBQUErQixLQUFBLE9BQUEsV0FDQSxHQUFBckIsR0FBQVIsRUFBQThCLFdBQ0F0QixLQUNBUixFQUFBK0IsV0FBQXhCLEVBQUFDLEdBQ0FSLEVBQUFvQixhQXBHQSxHQUFBRSxHQUFBLG9DQXlHQSxRQUNBVSxTQUFBLElBQ0FDLFFBQUEsVUFDQXJDLEtBQUFBLEtBRUFELFVBQUEsY0FBQSxXQUNBLE9BQ0FxQyxTQUFBLElBQ0FDLFFBQUEsVUFDQXJDLEtBQUEsU0FBQUMsRUFBQXFDLEVBQUFuQyxFQUFBb0MsR0FDQUEsRUFBQXBCLFNBQUFDLEtBQUEsU0FBQW9CLEdBSUEsR0FBQUMsU0FBQUQsRUFBQSxNQUFBLEVBQ0EsSUFBQUUsR0FBQUYsRUFBQUcsUUFBQSxZQUFBLEdBTUEsT0FMQUQsS0FBQUYsSUFDQUQsRUFBQWhCLGNBQUFtQixHQUNBSCxFQUFBZixXQUdBa0IsUUNsSUFwRSxRQUFBQyxPQUFBLGtCQUNBcUUsT0FBQSxVQUNBLFVBQUEsVUFBQSxTQUFBQSxFQUFBQyxHQUNBLEdBQUFDLEdBQUFGLEVBQUEsWUFDQUcsRUFBQUYsRUFBQUcsY0FDQSxPQUFBLFVBQUFDLEVBQUEzQyxFQUFBNEMsR0FDQSxJQUFBNUMsSUFBQUEsRUFBQSxHQUNBLElBQUFNLEdBQUFrQyxFQUFBRyxFQUFBQyxHQUNBQyxFQUFBdkMsRUFBQVUsUUFBQXlCLEVBQUFLLGFBQUEsRUFDQUMsRUFBQSxFQUVBLE9BREFGLEdBQUF2QyxFQUFBVSxRQUFBeUIsRUFBQU8sZ0JBQUFELEVBQUEsSUFBQU4sRUFBQU8sY0FDQTFDLEVBQUEyQyxVQUFBLEVBQUFKLEVBQUE3QyxHQUFBK0MsTUNYQSxXQUNBLFlBQ0EvRSxTQUNBQyxPQUFBLFlBQ0EsaUJBQ0EsZ0JBRUFTLFdBQUEsa0JBQUEsYUFBQSxTQUFBLE9BQUEsU0FBQXdFLEVBQUFDLEVBQUFDLEdBRUEsR0FBQXBFLEdBQUFDLElBRUFtRSxHQUFBQyxLQUNBbEUsUUFBQSxTQUFBQyxHQUNBSixFQUFBc0UsS0FBQWxFLElBRUFFLE1BQUEsU0FBQUMsR0FDQWdFLFFBQUFDLElBQUFqRSxLQUlBNEQsRUFBQU0sVUFBQUMsVUFBQUQsVUFHQVAsRUFBQVMsSUFBQSxvQkFBQSxXQUNBVCxFQUFBVSxTQUFBLElBR0FWLEVBQUFTLElBQUEsc0JBQUEsV0FDQVQsRUFBQVUsU0FBQSxJQUtBVCxFQUFBVSxjQUFBLFdBRUFDLE1BQUEsa0RBT0FYLEVBQUFZLFVBRUEsS0FBQSxHQUFBQyxHQUFBLEVBQUEsR0FBQUEsRUFBQUEsSUFDQWIsRUFBQVksUUFBQWpELE1BQUFtRCxLQUFBLFdBQUFDLFFBQUEsV0FBQUYsRUFBQSxJQUdBYixHQUFBZ0IsYUFBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUFsQixFQUFBWSxRQUFBL0MsUUFBQW9ELEVBQ0FDLEdBQUEsSUFDQWxCLEVBQUFZLFFBQUFPLE9BQUFELEVBQUEsVUNuREEsV0FDQSxZQUNBckcsU0FDQUMsT0FBQSw4QkFDQVMsV0FBQSxpQkFBQSxZQUFBLGVBQUEsU0FBQUksRUFBQXlGLEdBRUEsR0FBQXZGLEdBQUFDLElBSUFILEdBQUEwRixVQUFBRCxFQUFBQyxXQUNBckYsUUFBQSxTQUFBQyxHQUNBSixFQUFBSyxZQUFBRCxFQUFBQyxZQUNBTCxFQUFBd0YsVUFBQXBGLEVBQUFvRixZQUVBbEYsTUFBQSxTQUFBQyxHQUNBZ0UsUUFBQWpFLE1BQUFDLFdDaEJBLFdBQ0EsWUFDQXZCLFNBQ0FDLE9BQUEsNkJBQ0F3RyxRQUFBLGNBQUEsUUFBQSxTQUFBQyxHQUVBLE9BQ0FDLFNBQUEsU0FBQUMsR0FDQSxNQUFBRixHQUFBQSxVQUFBLG9CQUFBRSxJQUVBQyxPQUFBLFNBQUF6RixHQUNBLE1BQUFzRixJQUNBdEYsS0FBQUEsRUFDQTBGLE9BQUEsT0FDQUMsSUFBQSxvQkFBQTNGLEVBQUE0RixZQUFBLGtCQUdBQyxPQUFBLFNBQUE3RixHQUNBLE1BQUFzRixJQUNBdEYsS0FBQUEsRUFDQTBGLE9BQUEsTUFDQUMsSUFBQSxvQkFBQTNGLEVBQUF3RixhQ3JCQSxXQUNBLFlBQ0E1RyxTQUNBQyxPQUFBLDRCQUNBUyxXQUFBLHdCQUFBLFlBQUEsV0FBQSxlQUFBLFVBQUEsYUFBQSxTQUFBSSxFQUFBQyxFQUFBd0YsRUFBQVcsRUFBQUMsR0FFQSxHQUFBbkcsR0FBQUMsSUFDQUQsR0FBQW9HLGFBQ0FwRyxFQUFBcUcsa0JBRUFkLEVBQUFLLElBQ0E5RixFQUFBd0csS0FBQWYsRUFBQUssSUFDQXpGLFFBQUEsU0FBQUMsR0FDQUosRUFBQW9HLFVBQUFoRyxJQUVBRSxNQUFBLFNBQUFDLEdBQ0FSLEVBQUFTLElBQUFELEVBQUEsV0FJQVAsRUFBQXVHLEtBQUEsV0FDQXpHLEVBQUFtRyxPQUFBakcsRUFBQW9HLFdBQ0FqRyxRQUFBLFNBQUFDLEdBQ0FMLEVBQUFTLElBQUFKLEVBQUEsYUFFQUUsTUFBQSxTQUFBQyxHQUNBUixFQUFBUyxJQUFBRCxFQUFBLFlBSUFQLEVBQUF3RyxTQUFBLFdBQ0F4RyxFQUFBcUcsZUFBQUwsWUFBQWhHLEVBQUFvRyxVQUFBUixHQUNBNUYsRUFBQXFHLGVBQUFJLE9BQUF6RyxFQUFBb0csVUFBQUssT0FDQXpHLEVBQUFtRyxXQUFBTyxVQUFBLEdBQUFDLE1BRUFSLEVBQUFOLE9BQUE3RixFQUFBcUcsZ0JBQ0FsRyxRQUFBLFNBQUFDLEdBQ0FMLEVBQUFTLElBQUFKLEVBQUEsV0FDQUosRUFBQW9HLFVBQUFRLFlBQUE5RSxLQUFBOUIsRUFBQXFHLGtCQUVBL0YsTUFBQSxTQUFBQyxHQUNBUixFQUFBUyxJQUFBRCxFQUFBLFlBSUFQLEVBQUFBLFVBQUEsV0FDQSxHQUFBNkcsR0FBQUMsUUFBQSw4Q0FDQUQsSUFDQS9HLEVBQUFBLFVBQUFFLEVBQUFvRyxVQUFBUixJQUNBekYsUUFBQSxTQUFBQyxHQUNBTCxFQUFBUyxJQUFBSixFQUFBLFdBQ0E4RixFQUFBYSxTQUFBLE9BRUF6RyxNQUFBLFNBQUFDLEdBQ0FSLEVBQUFTLElBQUFELEVBQUEsa0JDdERBLFdBQ0EsWUFDQXZCLFNBQ0FDLE9BQUEsaUJBQ0Esd0JBQ0Esc0JBQ0Esd0JBQ0EsMEJBQ0EsMkJBRUFTLFdBQUEsbUJBQUEsWUFBQSxXQUFBLFNBQUFJLEVBQUFDLEdBRUEsR0FBQUMsR0FBQUMsSUFFQUgsR0FBQUksT0FDQUMsUUFBQSxTQUFBQyxHQUNBSixFQUFBSyxZQUFBRCxJQUVBRSxNQUFBLFNBQUFDLEdBQ0FSLEVBQUFTLElBQUFELEVBQUEsaUJDbkJBLFdBQ0EsWUFDQXZCLFNBQ0FDLE9BQUEsNEJBQ0F3RyxRQUFBLGFBQUEsUUFBQSxTQUFBQyxHQUVBLE9BQ0F4RixLQUFBLFNBQUE4RyxHQUNBLE1BQUF0QixHQUFBdUIsSUFBQSxxQkFFQVgsS0FBQSxTQUFBVixHQUNBLE1BQUFGLEdBQUF1QixJQUFBLG9CQUFBckIsSUFFQUosVUFBQSxTQUFBMEIsR0FDQSxNQUFBeEIsR0FBQXVCLElBQUEsbUJBQUFDLElBRUF2QixTQUFBLFNBQUFDLEdBQ0EsTUFBQUYsR0FBQUEsVUFBQSxvQkFBQUUsSUFFQUMsT0FBQSxTQUFBekYsR0FDQSxNQUFBc0YsSUFDQXRGLEtBQUFBLEVBQ0EwRixPQUFBLE9BQ0FDLElBQUEsc0JBR0FFLE9BQUEsU0FBQTdGLEdBQ0EsTUFBQXNGLElBQ0F0RixLQUFBQSxFQUNBMEYsT0FBQSxNQUNBQyxJQUFBLG9CQUFBM0YsRUFBQXdGLGFDOUJBLFdBQ0EsWUFDQTVHLFNBQ0FDLE9BQUEsMEJBQ0FTLFdBQUEsc0JBQUEsWUFBQSxXQUFBLFVBQUEsU0FBQUksRUFBQUMsRUFBQW1HLEdBR0EsR0FBQWxHLEdBQUFDLElBQ0FELEdBQUFtSCxpQkFFQW5ILEVBQUE2RixPQUFBLFdBQ0EvRixFQUFBK0YsT0FBQTdGLEVBQUFtSCxlQUNBaEgsUUFBQSxTQUFBQyxHQUNBTCxFQUFBUyxJQUFBSixFQUFBLFdBQ0E4RixFQUFBYSxTQUFBLGVBQUEzRyxJQUVBRSxNQUFBLFNBQUFDLEdBQ0FSLEVBQUFTLElBQUFELEVBQUEsa0JDakJBLFdBQ0EsWUFDQXZCLFNBQUFDLE9BQUEsWUFBQSxxQkFDQVMsV0FBQSxZQUFBLFNBQUEsT0FBQSxTQUFBeUUsRUFBQUMsR0FFQUEsRUFBQWdELElBQUEsV0FBQUgsTUFDQUksS0FBQSxTQUFBakgsR0FDQStELEVBQUFtRCxTQUFBbEgsSUFGQWdFLFNBSUEsU0FBQTdELEdBQ0F1RSxNQUFBdkUsRUFBQUgsUUFHQStELEVBQUFvRCxjQUFBLFdBQ0FwRCxFQUFBbUQsU0FBQUUsTUFBQXJELFNBQ0EsU0FBQTVELEdBQ0F1RSxNQUFBdkUsRUFBQUgsZUNoQkEsV0FDQSxZQUNBcEIsU0FDQUMsT0FBQSx1QkFFQXdHLFFBQUEsUUFBQSxRQUFBLFNBQUFDLEdBRUEsT0FDQXJCLEdBQUEsV0FDQSxNQUFBcUIsR0FBQXVCLElBQUEiLCJmaWxlIjoiYnVpbGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcsIFtcbiAgICAgICduZ1JvdXRlJyxcbiAgICAgICdtb2JpbGUtYW5ndWxhci11aScsXG4gICAgICAnYXBwLm1haW4nLFxuICAgICAgJ2FwcC5ob21lJyxcbiAgICAgICduZ05vdGlmeScsXG4gICAgICAnYXBwLnVzZXInLFxuICAgICAgJ2FwcC5uZWNlc2lkYWQnLFxuICAgICAgLy8gdG91Y2gvZHJhZyBmZWF0dXJlOiB0aGlzIGlzIGZyb20gJ21vYmlsZS1hbmd1bGFyLXVpLmdlc3R1cmVzLmpzJ1xuICAgICAgLy8gaXQgaXMgYXQgYSB2ZXJ5IGJlZ2lubmluZyBzdGFnZSwgc28gcGxlYXNlIGJlIGNhcmVmdWwgaWYgeW91IGxpa2UgdG8gdXNlXG4gICAgICAvLyBpbiBwcm9kdWN0aW9uLiBUaGlzIGlzIGludGVuZGVkIHRvIHByb3ZpZGUgYSBmbGV4aWJsZSwgaW50ZWdyYXRlZCBhbmQgYW5kXG4gICAgICAvLyBlYXN5IHRvIHVzZSBhbHRlcm5hdGl2ZSB0byBvdGhlciAzcmQgcGFydHkgbGlicyBsaWtlIGhhbW1lci5qcywgd2l0aCB0aGVcbiAgICAgIC8vIGZpbmFsIHBvdXJwb3NlIHRvIGludGVncmF0ZSBnZXN0dXJlcyBpbnRvIGRlZmF1bHQgdWkgaW50ZXJhY3Rpb25zIGxpa2VcbiAgICAgIC8vIG9wZW5pbmcgc2lkZWJhcnMsIHR1cm5pbmcgc3dpdGNoZXMgb24vb2ZmIC4uXG4gICAgICAnbW9iaWxlLWFuZ3VsYXItdWkuZ2VzdHVyZXMnXG4gICAgXSlcbiAgICAucnVuKFsnJHRyYW5zZm9ybScsZnVuY3Rpb24oJHRyYW5zZm9ybSkge1xuICAgICAgd2luZG93LiR0cmFuc2Zvcm0gPSAkdHJhbnNmb3JtO1xuICAgIH1dKVxuICAgIC5jb25maWcoWyckcm91dGVQcm92aWRlcicsZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAud2hlbignLycsIHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvaG9tZS9ob21lLmh0bWwnLFxuICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZVxuICAgICAgICB9KVxuICAgICAgICAud2hlbignLycsIHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvaG9tZS9zY3JvbGwuaHRtbCcsXG4gICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlLFxuICAgICAgICAgIGNvbnRyb2xsZXI6J0hvbWVDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0hvbWVDdHJsJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL25lY2VzaWRhZC86aWQnLCB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL25lY2VzaWRhZC9kZXRhbGxlLmh0bWwnLFxuICAgICAgICAgIGNvbnRyb2xsZXI6J05lY2VzaWRhZERldGFsbGVDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0RldGFsbGVDdHJsJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL25lY2VzaWRhZC86aWQvZWRpdGFyJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9uZWNlc2lkYWQvZWRpdGFyLmh0bWwnLFxuICAgICAgICAgIGNvbnRyb2xsZXI6J05lY2VzaWRhZERldGFsbGVDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0RldGFsbGVDdHJsJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2NhdGVnb3JpYS86Y2F0ZWdvcmlhJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9uZWNlc2lkYWQvY2F0ZWdvcmlhLmh0bWwnLFxuICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZSxcbiAgICAgICAgICBjb250cm9sbGVyOidDYXRlZ29yaWFDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0NhdGVnb3JpYUN0cmwnXG4gICAgICAgIH0pXG5cbiAgICAgICAgLm90aGVyd2lzZSh7XG4gICAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG4gICAgLy8gYXBwLmRpcmVjdGl2ZSgndG91Y2hhcmVhJywgWyckdG91Y2gnLCBmdW5jdGlvbigkdG91Y2gpe1xuICAgIC8vICAgLy8gUnVucyBkdXJpbmcgY29tcGlsZVxuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAvLyAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCBlbGVtKSB7XG4gICAgLy8gICAgICAgJHNjb3BlLnRvdWNoID0gbnVsbDtcbiAgICAvLyAgICAgICAkdG91Y2guYmluZChlbGVtLCB7XG4gICAgLy8gICAgICAgICBzdGFydDogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH0sXG4gICAgLy9cbiAgICAvLyAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH0sXG4gICAgLy9cbiAgICAvLyAgICAgICAgIG1vdmU6IGZ1bmN0aW9uKHRvdWNoKSB7XG4gICAgLy8gICAgICAgICAgICRzY29wZS50b3VjaCA9IHRvdWNoO1xuICAgIC8vICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgLy8gICAgICAgICB9LFxuICAgIC8vXG4gICAgLy8gICAgICAgICBlbmQ6IGZ1bmN0aW9uKHRvdWNoKSB7XG4gICAgLy8gICAgICAgICAgICRzY29wZS50b3VjaCA9IHRvdWNoO1xuICAgIC8vICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgICAgfSk7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH07XG4gICAgLy8gfV0pO1xuICAgIC8vXG4gICAgLy8gLy9cbiAgICAvLyAvLyBgJGRyYWdgIGV4YW1wbGU6IGRyYWcgdG8gZGlzbWlzc1xuICAgIC8vIC8vXG4gICAgLy8gYXBwLmRpcmVjdGl2ZSgnZHJhZ1RvRGlzbWlzcycsIGZ1bmN0aW9uKCRkcmFnLCAkcGFyc2UsICR0aW1lb3V0KXtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHJlc3RyaWN0OiAnQScsXG4gICAgLy8gICAgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsZW0sIGF0dHJzKSB7XG4gICAgLy8gICAgICAgdmFyIGRpc21pc3NGbiA9ICRwYXJzZShhdHRycy5kcmFnVG9EaXNtaXNzKTtcbiAgICAvLyAgICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0pe1xuICAgIC8vICAgICAgICAgdmFyIGRpc21pc3MgPSBmYWxzZTtcbiAgICAvL1xuICAgIC8vICAgICAgICAgJGRyYWcuYmluZChlbGVtLCB7XG4gICAgLy8gICAgICAgICAgIHRyYW5zZm9ybTogJGRyYWcuVFJBTlNMQVRFX1JJR0hULFxuICAgIC8vICAgICAgICAgICBtb3ZlOiBmdW5jdGlvbihkcmFnKSB7XG4gICAgLy8gICAgICAgICAgICAgaWYoIGRyYWcuZGlzdGFuY2VYID49IGRyYWcucmVjdC53aWR0aCAvIDQpIHtcbiAgICAvLyAgICAgICAgICAgICAgIGRpc21pc3MgPSB0cnVlO1xuICAgIC8vICAgICAgICAgICAgICAgZWxlbS5hZGRDbGFzcygnZGlzbWlzcycpO1xuICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICAgICAgICBkaXNtaXNzID0gZmFsc2U7XG4gICAgLy8gICAgICAgICAgICAgICBlbGVtLnJlbW92ZUNsYXNzKCdkaXNtaXNzJyk7XG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgICB9LFxuICAgIC8vICAgICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICAgICAgZWxlbS5yZW1vdmVDbGFzcygnZGlzbWlzcycpO1xuICAgIC8vICAgICAgICAgICB9LFxuICAgIC8vICAgICAgICAgICBlbmQ6IGZ1bmN0aW9uKGRyYWcpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiAoZGlzbWlzcykge1xuICAgIC8vICAgICAgICAgICAgICAgZWxlbS5hZGRDbGFzcygnZGlzbWl0dGVkJyk7XG4gICAgLy8gICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgIC8vICAgICAgICAgICAgICAgICAgIGRpc21pc3NGbihzY29wZSk7XG4gICAgLy8gICAgICAgICAgICAgICAgIH0pO1xuICAgIC8vICAgICAgICAgICAgICAgfSwgMzAwKTtcbiAgICAvLyAgICAgICAgICAgICB9IGVsc2Uge1xuICAgIC8vICAgICAgICAgICAgICAgZHJhZy5yZXNldCgpO1xuICAgIC8vICAgICAgICAgICAgIH1cbiAgICAvLyAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgfSk7XG4gICAgLy8gICAgICAgfTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9KTtcbiAgICAvL1xuICAgIC8vIC8vXG4gICAgLy8gLy8gQW5vdGhlciBgJGRyYWdgIHVzYWdlIGV4YW1wbGU6IHRoaXMgaXMgaG93IHlvdSBjb3VsZCBjcmVhdGVcbiAgICAvLyAvLyBhIHRvdWNoIGVuYWJsZWQgXCJkZWNrIG9mIGNhcmRzXCIgY2Fyb3VzZWwuIFNlZSBgY2Fyb3VzZWwuaHRtbGAgZm9yIG1hcmt1cC5cbiAgICAvLyAvL1xuICAgIC8vIGFwcC5kaXJlY3RpdmUoJ2Nhcm91c2VsJywgZnVuY3Rpb24oKXtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHJlc3RyaWN0OiAnQycsXG4gICAgLy8gICAgIHNjb3BlOiB7fSxcbiAgICAvLyAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgICAgdGhpcy5pdGVtQ291bnQgPSAwO1xuICAgIC8vICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IG51bGw7XG4gICAgLy9cbiAgICAvLyAgICAgICB0aGlzLmFkZEl0ZW0gPSBmdW5jdGlvbigpe1xuICAgIC8vICAgICAgICAgdmFyIG5ld0lkID0gdGhpcy5pdGVtQ291bnQrKztcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuaXRlbUNvdW50ID09PSAxID8gbmV3SWQgOiB0aGlzLmFjdGl2ZUl0ZW07XG4gICAgLy8gICAgICAgICByZXR1cm4gbmV3SWQ7XG4gICAgLy8gICAgICAgfTtcbiAgICAvL1xuICAgIC8vICAgICAgIHRoaXMubmV4dCA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSB0aGlzLmFjdGl2ZUl0ZW0gfHwgMDtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSA9PT0gdGhpcy5pdGVtQ291bnQgLSAxID8gMCA6IHRoaXMuYWN0aXZlSXRlbSArIDE7XG4gICAgLy8gICAgICAgfTtcbiAgICAvL1xuICAgIC8vICAgICAgIHRoaXMucHJldiA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSB0aGlzLmFjdGl2ZUl0ZW0gfHwgMDtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSA9PT0gMCA/IHRoaXMuaXRlbUNvdW50IC0gMSA6IHRoaXMuYWN0aXZlSXRlbSAtIDE7XG4gICAgLy8gICAgICAgfTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9KTtcblxuXG5cbiAgICAvL1xuICAgIC8vIEZvciB0aGlzIHRyaXZpYWwgZGVtbyB3ZSBoYXZlIGp1c3QgYSB1bmlxdWUgTWFpbkNvbnRyb2xsZXJcbiAgICAvLyBmb3IgZXZlcnl0aGluZ1xuICAgIC8vXG4gICAgLy8gYXBwLmNvbnRyb2xsZXIoJ01haW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlKXtcbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLnN3aXBlZCA9IGZ1bmN0aW9uKGRpcmVjdGlvbikge1xuICAgIC8vICAgICBhbGVydCgnU3dpcGVkICcgKyBkaXJlY3Rpb24pO1xuICAgIC8vICAgfTtcbiAgICAvL1xuICAgIC8vICAgLy8gVXNlciBhZ2VudCBkaXNwbGF5ZWQgaW4gaG9tZSBwYWdlXG4gICAgLy8gICAkc2NvcGUudXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICAvL1xuICAgIC8vICAgLy8gTmVlZGVkIGZvciB0aGUgbG9hZGluZyBzY3JlZW5cbiAgICAvLyAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICRyb290U2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgLy8gICB9KTtcbiAgICAvL1xuICAgIC8vICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpe1xuICAgIC8vICAgICAkcm9vdFNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAvLyAgIH0pO1xuICAgIC8vXG4gICAgLy8gICAvLyBGYWtlIHRleHQgaSB1c2VkIGhlcmUgYW5kIHRoZXJlLlxuICAgIC8vICAgJHNjb3BlLmxvcmVtID0gJ0xvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNpY2luZyBlbGl0LiBWZWwgZXhwbGljYWJvLCBhbGlxdWlkIGVhcXVlIHNvbHV0YSBuaWhpbCBlbGlnZW5kaSBhZGlwaXNjaSBlcnJvciwgaWxsdW0gY29ycnVwdGkgbmFtIGZ1Z2Egb21uaXMgcXVvZCBxdWFlcmF0IG1vbGxpdGlhIGV4cGVkaXRhIGltcGVkaXQgZG9sb3JlcyBpcHNhbS4gT2JjYWVjYXRpLic7XG4gICAgLy9cbiAgICAvLyAgIC8vXG4gICAgLy8gICAvLyAnU2Nyb2xsJyBzY3JlZW5cbiAgICAvLyAgIC8vXG4gICAgLy8gICB2YXIgc2Nyb2xsSXRlbXMgPSBbXTtcbiAgICAvL1xuICAgIC8vICAgZm9yICh2YXIgaT0xOyBpPD0xMDA7IGkrKykge1xuICAgIC8vICAgICBzY3JvbGxJdGVtcy5wdXNoKCdJdGVtICcgKyBpKTtcbiAgICAvLyAgIH1cbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLnNjcm9sbEl0ZW1zID0gc2Nyb2xsSXRlbXM7XG4gICAgLy9cbiAgICAvLyAgICRzY29wZS5ib3R0b21SZWFjaGVkID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgIC8qIGdsb2JhbCBhbGVydDogZmFsc2U7ICovXG4gICAgLy8gICAgIGFsZXJ0KCdDb25ncmF0cyB5b3Ugc2Nyb2xsZWQgdG8gdGhlIGVuZCBvZiB0aGUgbGlzdCEnKTtcbiAgICAvLyAgIH07XG4gICAgLy9cbiAgICAvLyAgIC8vXG4gICAgLy8gICAvLyBSaWdodCBTaWRlYmFyXG4gICAgLy8gICAvL1xuICAgIC8vICAgJHNjb3BlLmNoYXRVc2VycyA9IFtcbiAgICAvLyAgICAgeyBuYW1lOiAnQ2FybG9zICBGbG93ZXJzJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0J5cm9uIFRheWxvcicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKYW5hICBUZXJyeScsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdEYXJyeWwgIFN0b25lJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0Zhbm5pZSAgQ2FybHNvbicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdIb2xseSBOZ3V5ZW4nLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQmlsbCAgQ2hhdmV6Jywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ1Zlcm9uaWNhICBNYXh3ZWxsJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0plc3NpY2EgV2Vic3RlcicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKYWNraWUgIEJhcnRvbicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdDcnlzdGFsIERyYWtlJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdNaWx0b24gIERlYW4nLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0pvYW5uIEpvaG5zdG9uJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdDb3JhICBWYXVnaG4nLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ05pbmEgIEJyaWdncycsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQ2FzZXkgVHVybmVyJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKaW1taWUgIFdpbHNvbicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnTmF0aGFuaWVsIFN0ZWVsZScsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQXVicmV5ICBDb2xlJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdEb25uaWUgIFN1bW1lcnMnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0thdGUgIE15ZXJzJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdQcmlzY2lsbGEgSGF3a2lucycsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnSm9lIEJhcmtlcicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnTGVlIE5vcm1hbicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnRWJvbnkgUmljZScsIG9ubGluZTogZmFsc2UgfVxuICAgIC8vICAgXTtcbiAgICAvL1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vICdGb3Jtcycgc2NyZWVuXG4gICAgLy8gICAvL1xuICAgIC8vICAgJHNjb3BlLnJlbWVtYmVyTWUgPSB0cnVlO1xuICAgIC8vICAgJHNjb3BlLmVtYWlsID0gJ21lQGV4YW1wbGUuY29tJztcbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgIGFsZXJ0KCdZb3Ugc3VibWl0dGVkIHRoZSBsb2dpbiBmb3JtJyk7XG4gICAgLy8gICB9O1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vICdEcmFnJyBzY3JlZW5cbiAgICAvLyAgIC8vXG4gICAgLy8gICAkc2NvcGUubm90aWNlcyA9IFtdO1xuICAgIC8vXG4gICAgLy8gICBmb3IgKHZhciBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAvLyAgICAgJHNjb3BlLm5vdGljZXMucHVzaCh7aWNvbjogJ2VudmVsb3BlJywgbWVzc2FnZTogJ05vdGljZSAnICsgKGogKyAxKSB9KTtcbiAgICAvLyAgIH1cbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLmRlbGV0ZU5vdGljZSA9IGZ1bmN0aW9uKG5vdGljZSkge1xuICAgIC8vICAgICB2YXIgaW5kZXggPSAkc2NvcGUubm90aWNlcy5pbmRleE9mKG5vdGljZSk7XG4gICAgLy8gICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgLy8gICAgICAgJHNjb3BlLm5vdGljZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9KTtcblxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5ob21lJyxbXSlcbiAgICAgIC5jb250cm9sbGVyKCdIb21lQ3RybCcsWydOZWNlc2lkYWQnLCduZ05vdGlmeScsZnVuY3Rpb24gKE5lY2VzaWRhZCxuZ05vdGlmeSkge1xuXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgTmVjZXNpZGFkLmxvYWQoKVxuICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHZtLm5lY2VzaWRhZGVzID0gZGF0YTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCAnZXJyb3InKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgfV0pO1xufSkoKTtcbiIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCdhcHAuZGlyZWN0aXZlcycsIFtdKVxuICAuZGlyZWN0aXZlKCdtb25leScsIGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBOVU1CRVJfUkVHRVhQID0gL15cXHMqKFxcLXxcXCspPyhcXGQrfChcXGQqKFxcLlxcZCopKSlcXHMqJC87XG5cbiAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbCwgYXR0cnMsIG5nTW9kZWxDdHJsKSB7XG4gICAgICB2YXIgbWluID0gcGFyc2VGbG9hdChhdHRycy5taW4gfHwgMCk7XG4gICAgICB2YXIgcHJlY2lzaW9uID0gcGFyc2VGbG9hdChhdHRycy5wcmVjaXNpb24gfHwgMik7XG4gICAgICB2YXIgbGFzdFZhbGlkVmFsdWU7XG5cbiAgICAgIGZ1bmN0aW9uIHJvdW5kKG51bSkge1xuICAgICAgICB2YXIgZCA9IE1hdGgucG93KDEwLCBwcmVjaXNpb24pO1xuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChudW0gKiBkKSAvIGQ7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGZvcm1hdFByZWNpc2lvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSkudG9GaXhlZChwcmVjaXNpb24pO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBmb3JtYXRWaWV3VmFsdWUodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIG5nTW9kZWxDdHJsLiRpc0VtcHR5KHZhbHVlKSA/ICcnIDogJycgKyB2YWx1ZTtcbiAgICAgIH1cblxuXG4gICAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgICAgICB2YWx1ZSA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSGFuZGxlIGxlYWRpbmcgZGVjaW1hbCBwb2ludCwgbGlrZSBcIi41XCJcbiAgICAgICAgaWYgKHZhbHVlLmluZGV4T2YoJy4nKSA9PT0gMCkge1xuICAgICAgICAgIHZhbHVlID0gJzAnICsgdmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBbGxvdyBcIi1cIiBpbnB1dHMgb25seSB3aGVuIG1pbiA8IDBcbiAgICAgICAgaWYgKHZhbHVlLmluZGV4T2YoJy0nKSA9PT0gMCkge1xuICAgICAgICAgIGlmIChtaW4gPj0gMCkge1xuICAgICAgICAgICAgdmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSgnJyk7XG4gICAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gJy0nKSB7XG4gICAgICAgICAgICB2YWx1ZSA9ICcnO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBlbXB0eSA9IG5nTW9kZWxDdHJsLiRpc0VtcHR5KHZhbHVlKTtcbiAgICAgICAgaWYgKGVtcHR5IHx8IE5VTUJFUl9SRUdFWFAudGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgICBsYXN0VmFsaWRWYWx1ZSA9ICh2YWx1ZSA9PT0gJycpXG4gICAgICAgICAgPyBudWxsXG4gICAgICAgICAgOiAoZW1wdHkgPyB2YWx1ZSA6IHBhcnNlRmxvYXQodmFsdWUpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBSZW5kZXIgdGhlIGxhc3QgdmFsaWQgaW5wdXQgaW4gdGhlIGZpZWxkXG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZShmb3JtYXRWaWV3VmFsdWUobGFzdFZhbGlkVmFsdWUpKTtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICBuZ01vZGVsQ3RybC4kc2V0VmFsaWRpdHkoJ251bWJlcicsIHRydWUpO1xuICAgICAgICByZXR1cm4gbGFzdFZhbGlkVmFsdWU7XG4gICAgICB9KTtcbiAgICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2goZm9ybWF0Vmlld1ZhbHVlKTtcblxuICAgICAgdmFyIG1pblZhbGlkYXRvciA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGlmICghbmdNb2RlbEN0cmwuJGlzRW1wdHkodmFsdWUpICYmIHZhbHVlIDwgbWluKSB7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdtaW4nLCBmYWxzZSk7XG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0VmFsaWRpdHkoJ21pbicsIHRydWUpO1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIG5nTW9kZWxDdHJsLiRwYXJzZXJzLnB1c2gobWluVmFsaWRhdG9yKTtcbiAgICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2gobWluVmFsaWRhdG9yKTtcblxuICAgICAgaWYgKGF0dHJzLm1heCkge1xuICAgICAgICB2YXIgbWF4ID0gcGFyc2VGbG9hdChhdHRycy5tYXgpO1xuICAgICAgICB2YXIgbWF4VmFsaWRhdG9yID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBpZiAoIW5nTW9kZWxDdHJsLiRpc0VtcHR5KHZhbHVlKSAmJiB2YWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdtYXgnLCBmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0VmFsaWRpdHkoJ21heCcsIHRydWUpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKG1heFZhbGlkYXRvcik7XG4gICAgICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2gobWF4VmFsaWRhdG9yKTtcbiAgICAgIH1cblxuICAgICAgLy8gUm91bmQgb2ZmXG4gICAgICBpZiAocHJlY2lzaW9uID4gLTEpIHtcbiAgICAgICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWUgPyByb3VuZCh2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlID8gZm9ybWF0UHJlY2lzaW9uKHZhbHVlKSA6IHZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZWwuYmluZCgnYmx1cicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gbmdNb2RlbEN0cmwuJG1vZGVsVmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUgPSBmb3JtYXRQcmVjaXNpb24odmFsdWUpO1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICBsaW5rOiBsaW5rXG4gICAgfTtcbiAgfSkuZGlyZWN0aXZlKCdudW1iZXJzT25seScsIGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG1vZGVsQ3RybCkge1xuICAgICAgICBtb2RlbEN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbiAoaW5wdXRWYWx1ZSkge1xuICAgICAgICAgIC8vIHRoaXMgbmV4dCBpZiBpcyBuZWNlc3NhcnkgZm9yIHdoZW4gdXNpbmcgbmctcmVxdWlyZWQgb24geW91ciBpbnB1dC5cbiAgICAgICAgICAvLyBJbiBzdWNoIGNhc2VzLCB3aGVuIGEgbGV0dGVyIGlzIHR5cGVkIGZpcnN0LCB0aGlzIHBhcnNlciB3aWxsIGJlIGNhbGxlZFxuICAgICAgICAgIC8vIGFnYWluLCBhbmQgdGhlIDJuZCB0aW1lLCB0aGUgdmFsdWUgd2lsbCBiZSB1bmRlZmluZWRcbiAgICAgICAgICBpZiAoaW5wdXRWYWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gJyc7XG4gICAgICAgICAgdmFyIHRyYW5zZm9ybWVkSW5wdXQgPSBpbnB1dFZhbHVlLnJlcGxhY2UoL1teMC05Ky5dL2csICcnKTtcbiAgICAgICAgICBpZiAodHJhbnNmb3JtZWRJbnB1dCE9PWlucHV0VmFsdWUpIHtcbiAgICAgICAgICAgIG1vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKHRyYW5zZm9ybWVkSW5wdXQpO1xuICAgICAgICAgICAgbW9kZWxDdHJsLiRyZW5kZXIoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gdHJhbnNmb3JtZWRJbnB1dDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwLmZpbHRlcnMnLFtdKVxuICAuZmlsdGVyKCdkaW5lcm8nLFxuICBbICckZmlsdGVyJywgJyRsb2NhbGUnLCBmdW5jdGlvbihmaWx0ZXIsIGxvY2FsZSkge1xuICAgIHZhciBjdXJyZW5jeUZpbHRlciA9IGZpbHRlcignY3VycmVuY3knKTtcbiAgICB2YXIgZm9ybWF0cyA9IGxvY2FsZS5OVU1CRVJfRk9STUFUUztcbiAgICByZXR1cm4gZnVuY3Rpb24oYW1vdW50LCBudW0sIGN1cnJlbmN5U3ltYm9sKSB7XG4gICAgICBpZiAobnVtPT09MCkgbnVtID0gLTE7XG4gICAgICB2YXIgdmFsdWUgPSBjdXJyZW5jeUZpbHRlcihhbW91bnQsIGN1cnJlbmN5U3ltYm9sKTtcbiAgICAgIHZhciBzZXAgPSB2YWx1ZS5pbmRleE9mKGZvcm1hdHMuREVDSU1BTF9TRVApKzE7XG4gICAgICB2YXIgc3ltYm9sID0gJyc7XG4gICAgICBpZiAoc2VwPHZhbHVlLmluZGV4T2YoZm9ybWF0cy5DVVJSRU5DWV9TWU0pKSBzeW1ib2wgPSAnICcrZm9ybWF0cy5DVVJSRU5DWV9TWU07XG4gICAgICByZXR1cm4gdmFsdWUuc3Vic3RyaW5nKDAsIHNlcCtudW0pK3N5bWJvbDtcbiAgICB9O1xuICB9IF0pO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICAgIGFuZ3VsYXJcbiAgICAgIC5tb2R1bGUoJ2FwcC5tYWluJywgW1xuICAgICAgJ2FwcC5kaXJlY3RpdmVzJyxcbiAgICAgICdhcHAuZmlsdGVycydcbiAgICBdKVxuICAgIC5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsWyckcm9vdFNjb3BlJywnJHNjb3BlJywnVXNlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgVXNlcil7XG5cbiAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgIFVzZXIubWUoKVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIHZtLnVzZXIgPSBkYXRhO1xuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgIH0pO1xuXG4gICAgICAvLyBVc2VyIGFnZW50IGRpc3BsYXllZCBpbiBob21lIHBhZ2VcbiAgICAgICRzY29wZS51c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuXG4gICAgICAvLyBOZWVkZWQgZm9yIHRoZSBsb2FkaW5nIHNjcmVlblxuICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24oKXtcbiAgICAgICAgJHJvb3RTY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgIH0pO1xuXG4gICAgICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgfSk7XG5cblxuXG4gICAgICAkc2NvcGUuYm90dG9tUmVhY2hlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvKiBnbG9iYWwgYWxlcnQ6IGZhbHNlOyAqL1xuICAgICAgICBhbGVydCgnQ29uZ3JhdHMgeW91IHNjcm9sbGVkIHRvIHRoZSBlbmQgb2YgdGhlIGxpc3QhJyk7XG4gICAgICB9O1xuXG5cbiAgICAgIC8vXG4gICAgICAvLyAnRHJhZycgc2NyZWVuXG4gICAgICAvL1xuICAgICAgJHNjb3BlLm5vdGljZXMgPSBbXTtcblxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgICRzY29wZS5ub3RpY2VzLnB1c2goe2ljb246ICdlbnZlbG9wZScsIG1lc3NhZ2U6ICdOb3RpY2UgJyArIChqICsgMSkgfSk7XG4gICAgICB9XG5cbiAgICAgICRzY29wZS5kZWxldGVOb3RpY2UgPSBmdW5jdGlvbihub3RpY2UpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gJHNjb3BlLm5vdGljZXMuaW5kZXhPZihub3RpY2UpO1xuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICRzY29wZS5ub3RpY2VzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5uZWNlc2lkYWQuY2F0ZWdvcmlhJyxbXSlcbiAgICAgIC5jb250cm9sbGVyKCdDYXRlZ29yaWFDdHJsJyxbJ05lY2VzaWRhZCcsJyRyb3V0ZVBhcmFtcycsZnVuY3Rpb24gKE5lY2VzaWRhZCwkcm91dGVQYXJhbXMpIHtcblxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG5cblxuICAgICAgICBOZWNlc2lkYWQuY2F0ZWdvcmlhKCRyb3V0ZVBhcmFtcy5jYXRlZ29yaWEpXG4gICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZtLm5lY2VzaWRhZGVzID0gZGF0YS5uZWNlc2lkYWRlcztcbiAgICAgICAgICAgIHZtLmNhdGVnb3JpYSA9IGRhdGEuY2F0ZWdvcmlhO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5jb21lbnRhcmlvLnNlcnZpY2UnLFtdKVxuICAgICAgLmZhY3RvcnkoJ0NvbWVudGFyaW8nLFsnJGh0dHAnLGZ1bmN0aW9uICgkaHR0cCkge1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGVsZXRlOmZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9jb21lbnRhcmlvcy8nICsgaWQpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY3JlYXRlOmZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgICBkYXRhICAgIDogIGRhdGEsXG4gICAgICAgICAgICAgIG1ldGhvZCAgOiAnUE9TVCcsXG4gICAgICAgICAgICAgIHVybCAgICAgOiAnL2FwaS9uZWNlc2lkYWRlcy8nICsgZGF0YS5uZWNlc2lkYWRJZCArICcvY29tZW50YXJpb3MnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHVwZGF0ZTpmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgZGF0YSAgICA6ICBkYXRhLFxuICAgICAgICAgICAgICBtZXRob2QgIDogJ1BVVCcsXG4gICAgICAgICAgICAgIHVybCAgICAgOiAnL2FwaS9jb21lbnRhcmlvcy8nICsgZGF0YS5pZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH1dKVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5uZWNlc2lkYWQuZGV0YWxsZScsW10pXG4gICAgICAuY29udHJvbGxlcignTmVjZXNpZGFkRGV0YWxsZUN0cmwnLFsnTmVjZXNpZGFkJywnbmdOb3RpZnknLCckcm91dGVQYXJhbXMnLCckd2luZG93JywnQ29tZW50YXJpbycsZnVuY3Rpb24gKE5lY2VzaWRhZCxuZ05vdGlmeSwkcm91dGVQYXJhbXMsJHdpbmRvdyxDb21lbnRhcmlvKSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0ubmVjZXNpZGFkID0ge307XG4gICAgICAgIHZtLkNvbWVudGFyaW9Gb3JtID0ge307XG5cbiAgICAgICAgaWYgKCRyb3V0ZVBhcmFtcy5pZCkge1xuICAgICAgICAgIE5lY2VzaWRhZC5zaG93KCRyb3V0ZVBhcmFtcy5pZClcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHZtLm5lY2VzaWRhZCA9IGRhdGE7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uc2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBOZWNlc2lkYWQudXBkYXRlKHZtLm5lY2VzaWRhZClcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIG5nTm90aWZ5LnNldChkYXRhLCdzdWNjZXNzJyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmNvbWVudGFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZtLkNvbWVudGFyaW9Gb3JtLm5lY2VzaWRhZElkID0gdm0ubmVjZXNpZGFkLmlkO1xuICAgICAgICAgIHZtLkNvbWVudGFyaW9Gb3JtLnVzZXJJZCA9IHZtLm5lY2VzaWRhZC51c2VySWQ7XG4gICAgICAgICAgdm0uQ29tZW50YXJpby5jcmVhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgQ29tZW50YXJpby5jcmVhdGUodm0uQ29tZW50YXJpb0Zvcm0pXG4gICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZGF0YSwnc3VjY2VzcycpO1xuICAgICAgICAgICAgICB2bS5uZWNlc2lkYWQuY29tZW50YXJpb3MucHVzaCh2bS5Db21lbnRhcmlvRm9ybSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgc3VyZSA9IGNvbmZpcm0oJ1JlYWxtZW50ZSBkZXNlYXMgZWxpbWluYXIgZXN0YSBwdWJsaWNhY2nDs24/Jyk7XG4gICAgICAgICAgaWYgKHN1cmUpIHtcbiAgICAgICAgICAgIE5lY2VzaWRhZC5kZWxldGUodm0ubmVjZXNpZGFkLmlkKVxuICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIG5nTm90aWZ5LnNldChkYXRhLCdzdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbiA9ICcjLyc7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAubmVjZXNpZGFkJyxbXG4gICAgICAnYXBwLm5lY2VzaWRhZC5zZXJ2aWNlJyxcbiAgICAgICdhcHAubmVjZXNpZGFkLm51ZXZhJyxcbiAgICAgICdhcHAubmVjZXNpZGFkLmRldGFsbGUnLFxuICAgICAgJ2FwcC5uZWNlc2lkYWQuY2F0ZWdvcmlhJyxcbiAgICAgICdhcHAuY29tZW50YXJpby5zZXJ2aWNlJ1xuICAgIF0pXG4gICAgICAuY29udHJvbGxlcignTmVjZXNpZGFkZXNDdHJsJyxbJ05lY2VzaWRhZCcsJ25nTm90aWZ5JyxmdW5jdGlvbiAoTmVjZXNpZGFkLG5nTm90aWZ5KSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICBOZWNlc2lkYWQubG9hZCgpXG4gICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgdm0ubmVjZXNpZGFkZXMgPSBkYXRhO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIG5nTm90aWZ5LnNldChlcnIsICdlcnJvcicpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLm5lY2VzaWRhZC5zZXJ2aWNlJyxbXSlcbiAgICAgIC5mYWN0b3J5KCdOZWNlc2lkYWQnLFsnJGh0dHAnLGZ1bmN0aW9uICgkaHR0cCkge1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbG9hZDpmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvbmVjZXNpZGFkZXMnKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNob3c6ZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL25lY2VzaWRhZGVzLycgKyBpZCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBjYXRlZ29yaWE6ZnVuY3Rpb24gKGNsYXZlKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NhdGVnb3JpYXMvJyArIGNsYXZlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRlbGV0ZTpmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvbmVjZXNpZGFkZXMvJyArIGlkKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNyZWF0ZTpmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgZGF0YSAgICA6ICBkYXRhLFxuICAgICAgICAgICAgICBtZXRob2QgIDogJ1BPU1QnLFxuICAgICAgICAgICAgICB1cmwgICAgIDogJy9hcGkvbmVjZXNpZGFkZXMnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHVwZGF0ZTpmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgZGF0YSAgICA6ICBkYXRhLFxuICAgICAgICAgICAgICBtZXRob2QgIDogJ1BVVCcsXG4gICAgICAgICAgICAgIHVybCAgICAgOiAnL2FwaS9uZWNlc2lkYWRlcy8nICsgZGF0YS5pZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH1dKVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5uZWNlc2lkYWQubnVldmEnLFtdKVxuICAgICAgLmNvbnRyb2xsZXIoJ051ZXZhTmVjZXNpZGFkQ3RybCcsWydOZWNlc2lkYWQnLCduZ05vdGlmeScsJyR3aW5kb3cnLGZ1bmN0aW9uIChOZWNlc2lkYWQsbmdOb3RpZnksJHdpbmRvd1xuICAgICAgKSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uTmVjZXNpZGFkRm9ybSA9IHt9O1xuXG4gICAgICAgIHZtLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBOZWNlc2lkYWQuY3JlYXRlKHZtLk5lY2VzaWRhZEZvcm0pXG4gICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZGF0YSwnc3VjY2VzcycpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbiA9ICcjL25lY2VzaWRhZC8nICsgZGF0YTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAudXNlcicsIFsnYXBwLnVzZXIuc2VydmljZSddKVxuICAgIC5jb250cm9sbGVyKCdVc2VyQ3RybCcsWyckc2NvcGUnLCdVc2VyJyxmdW5jdGlvbigkc2NvcGUsVXNlcil7XG5cbiAgICAgIFVzZXIub25lKCdwcm9maWxlJykuZ2V0KClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gIChkYXRhKSB7XG4gICAgICAgICAgJHNjb3BlLkZvcm1Vc2VyID0gZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uICAoZXJyKSB7XG4gICAgICAgICAgYWxlcnQoZXJyLmRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgJHNjb3BlLnVwZGF0ZVByb2ZpbGUgPSBmdW5jdGlvbiAgKCkge1xuICAgICAgICAkc2NvcGUuRm9ybVVzZXIucHV0KClcbiAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gIChlcnIpIHtcbiAgICAgICAgICAgIGFsZXJ0KGVyci5kYXRhKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfV0pO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLnVzZXIuc2VydmljZScsICBbXSlcblxuICAgICAgLmZhY3RvcnkgKCdVc2VyJywgWyckaHR0cCcsZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBtZTpmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzL3Byb2ZpbGUnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XSk7XG5cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
