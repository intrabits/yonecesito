!function(){"use strict";angular.module("app",["ngRoute","mobile-angular-ui","app.main","app.home","ngNotify","app.user","app.necesidad","mobile-angular-ui.gestures"]).run(["$transform",function(e){window.$transform=e}]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"scripts/home/home.html",reloadOnSearch:!1}).when("/",{templateUrl:"scripts/home/scroll.html",reloadOnSearch:!1,controller:"HomeCtrl",controllerAs:"HomeCtrl"}).when("/necesidad/:id",{templateUrl:"scripts/necesidad/detalle.html",controller:"NecesidadDetalleCtrl",controllerAs:"DetalleCtrl"}).when("/necesidad/:id/editar",{templateUrl:"scripts/necesidad/editar.html",controller:"NecesidadDetalleCtrl",controllerAs:"DetalleCtrl"}).when("/categoria/:categoria",{templateUrl:"scripts/necesidad/categoria.html",reloadOnSearch:!1,controller:"CategoriaCtrl",controllerAs:"CategoriaCtrl"}).otherwise({redirectTo:"/"})}])}(),function(){"use strict";angular.module("app.home",[]).controller("HomeCtrl",["Necesidad","ngNotify",function(e,r){var t=this;e.load().success(function(e){t.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad.categoria",[]).controller("CategoriaCtrl",["Necesidad","$routeParams",function(e,r){var t=this;e.categoria(r.categoria).success(function(e){t.necesidades=e.necesidades,t.categoria=e.categoria}).error(function(e){console.error(e)})}])}(),function(){"use strict";angular.module("app.necesidad.detalle",[]).controller("NecesidadDetalleCtrl",["Necesidad","ngNotify","$routeParams","$window",function(e,r,t,n){var i=this;i.necesidad={},t.id&&e.show(t.id).success(function(e){i.necesidad=e}).error(function(e){r.set(e,"error")}),i.save=function(){e.update(i.necesidad).success(function(e){r.set(e,"success")}).error(function(e){r.set(e,"error")})},i["delete"]=function(){var t=confirm("Realmente deseas eliminar esta publicaciÃ³n?");t&&e["delete"](i.necesidad.id).success(function(e){r.set(e,"success"),n.location="#/"}).error(function(e){r.set(e,"error")})}}])}(),function(){"use strict";angular.module("app.necesidad",["app.necesidad.service","app.necesidad.nueva","app.necesidad.detalle","app.necesidad.categoria"]).controller("NecesidadesCtrl",["Necesidad","ngNotify",function(e,r){var t=this;e.load().success(function(e){t.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad.service",[]).factory("Necesidad",["$http",function(e){return{load:function(r){return e.get("/api/necesidades")},show:function(r){return e.get("/api/necesidades/"+r)},categoria:function(r){return e.get("/api/categorias/"+r)},"delete":function(r){return e["delete"]("/api/necesidades/"+r)},create:function(r){return e({data:r,method:"POST",url:"/api/necesidades"})},update:function(r){return e({data:r,method:"PUT",url:"/api/necesidades/"+r.id})}}}])}(),function(){"use strict";angular.module("app.necesidad.nueva",[]).controller("NuevaNecesidadCtrl",["Necesidad","ngNotify","$window",function(e,r,t){var n=this;n.NecesidadForm={},n.create=function(){e.create(n.NecesidadForm).success(function(e){r.set(e,"success"),t.location="#/necesidad/"+e}).error(function(e){r.set(e,"error")})}}])}(),angular.module("app.directives",[]).directive("money",function(){function e(e,t,n,i){function a(e){var r=Math.pow(10,l);return Math.round(e*r)/r}function o(e){return parseFloat(e).toFixed(l)}function s(e){return i.$isEmpty(e)?"":""+e}var c,u=parseFloat(n.min||0),l=parseFloat(n.precision||2);i.$parsers.push(function(e){angular.isUndefined(e)&&(e=""),0===e.indexOf(".")&&(e="0"+e),0===e.indexOf("-")&&(u>=0?(e=null,i.$setViewValue(""),i.$render()):"-"===e&&(e=""));var t=i.$isEmpty(e);return t||r.test(e)?c=""===e?null:t?e:parseFloat(e):(i.$setViewValue(s(c)),i.$render()),i.$setValidity("number",!0),c}),i.$formatters.push(s);var d=function(e){return!i.$isEmpty(e)&&u>e?void i.$setValidity("min",!1):(i.$setValidity("min",!0),e)};if(i.$parsers.push(d),i.$formatters.push(d),n.max){var p=parseFloat(n.max),f=function(e){return!i.$isEmpty(e)&&e>p?void i.$setValidity("max",!1):(i.$setValidity("max",!0),e)};i.$parsers.push(f),i.$formatters.push(f)}l>-1&&(i.$parsers.push(function(e){return e?a(e):e}),i.$formatters.push(function(e){return e?o(e):e})),t.bind("blur",function(){var e=i.$modelValue;e&&(i.$viewValue=o(e),i.$render())})}var r=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/;return{restrict:"A",require:"ngModel",link:e}}).directive("numbersOnly",function(){return{restrict:"A",require:"ngModel",link:function(e,r,t,n){n.$parsers.push(function(e){if(void 0===e)return"";var r=e.replace(/[^0-9+.]/g,"");return r!==e&&(n.$setViewValue(r),n.$render()),r})}}}),angular.module("app.filters",[]).filter("dinero",["$filter","$locale",function(e,r){var t=e("currency"),n=r.NUMBER_FORMATS;return function(e,r,i){0===r&&(r=-1);var a=t(e,i),o=a.indexOf(n.DECIMAL_SEP)+1,s="";return o<a.indexOf(n.CURRENCY_SYM)&&(s=" "+n.CURRENCY_SYM),a.substring(0,o+r)+s}}]),function(){"use strict";angular.module("app.main",["app.directives","app.filters"]).controller("MainController",["$rootScope","$scope","User",function(e,r,t){var n=this;t.me().success(function(e){n.user=e}).error(function(e){console.log(e)}),r.userAgent=navigator.userAgent,e.$on("$routeChangeStart",function(){e.loading=!0}),e.$on("$routeChangeSuccess",function(){e.loading=!1}),r.bottomReached=function(){alert("Congrats you scrolled to the end of the list!")},r.notices=[];for(var i=0;10>i;i++)r.notices.push({icon:"envelope",message:"Notice "+(i+1)});r.deleteNotice=function(e){var t=r.notices.indexOf(e);t>-1&&r.notices.splice(t,1)}}])}(),function(){"use strict";angular.module("app.user",["app.user.service"]).controller("UserCtrl",["$scope","User",function(e,r){r.one("profile").get().then(function(r){e.FormUser=r})["catch"](function(e){alert(e.data)}),e.updateProfile=function(){e.FormUser.put()["catch"](function(e){alert(e.data)})}}])}(),function(){"use strict";angular.module("app.user.service",[]).factory("User",["$http",function(e){return{me:function(){return e.get("/api/users/profile")}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImhvbWUvaG9tZS5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL2NhdGVnb3JpYS5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL2RldGFsbGUuY29udHJvbGxlci5qcyIsIm5lY2VzaWRhZC9uZWNlc2lkYWQuY29udHJvbGxlci5qcyIsIm5lY2VzaWRhZC9uZWNlc2lkYWQuc2VydmljZS5qcyIsIm5lY2VzaWRhZC9udWV2YS5jb250cm9sbGVyLmpzIiwic2hhcmVkL2RpcmVjdGl2ZXMuanMiLCJzaGFyZWQvZmlsdGVycy5qcyIsInNoYXJlZC9tYWluLmpzIiwidXNlcnMvY29udHJvbGxlci5qcyIsInVzZXJzL3NlcnZpY2UuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiR0cmFuc2Zvcm0iLCJ3aW5kb3ciLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInJlbG9hZE9uU2VhcmNoIiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJOZWNlc2lkYWQiLCJuZ05vdGlmeSIsInZtIiwidGhpcyIsImxvYWQiLCJzdWNjZXNzIiwiZGF0YSIsIm5lY2VzaWRhZGVzIiwiZXJyb3IiLCJlcnIiLCJzZXQiLCIkcm91dGVQYXJhbXMiLCJjYXRlZ29yaWEiLCJjb25zb2xlIiwiJHdpbmRvdyIsIm5lY2VzaWRhZCIsImlkIiwic2hvdyIsInNhdmUiLCJ1cGRhdGUiLCJzdXJlIiwiY29uZmlybSIsImxvY2F0aW9uIiwiZmFjdG9yeSIsIiRodHRwIiwiY2FsbGJhY2siLCJnZXQiLCJjbGF2ZSIsImRlbGV0ZSIsImNyZWF0ZSIsIm1ldGhvZCIsInVybCIsIk5lY2VzaWRhZEZvcm0iLCJkaXJlY3RpdmUiLCJsaW5rIiwic2NvcGUiLCJlbCIsImF0dHJzIiwibmdNb2RlbEN0cmwiLCJyb3VuZCIsIm51bSIsImQiLCJNYXRoIiwicG93IiwicHJlY2lzaW9uIiwiZm9ybWF0UHJlY2lzaW9uIiwidmFsdWUiLCJwYXJzZUZsb2F0IiwidG9GaXhlZCIsImZvcm1hdFZpZXdWYWx1ZSIsIiRpc0VtcHR5IiwibGFzdFZhbGlkVmFsdWUiLCJtaW4iLCIkcGFyc2VycyIsInB1c2giLCJpc1VuZGVmaW5lZCIsImluZGV4T2YiLCIkc2V0Vmlld1ZhbHVlIiwiJHJlbmRlciIsImVtcHR5IiwiTlVNQkVSX1JFR0VYUCIsInRlc3QiLCIkc2V0VmFsaWRpdHkiLCIkZm9ybWF0dGVycyIsIm1pblZhbGlkYXRvciIsIm1heCIsIm1heFZhbGlkYXRvciIsImJpbmQiLCIkbW9kZWxWYWx1ZSIsIiR2aWV3VmFsdWUiLCJyZXN0cmljdCIsInJlcXVpcmUiLCJlbGVtZW50IiwibW9kZWxDdHJsIiwiaW5wdXRWYWx1ZSIsInVuZGVmaW5lZCIsInRyYW5zZm9ybWVkSW5wdXQiLCJyZXBsYWNlIiwiZmlsdGVyIiwibG9jYWxlIiwiY3VycmVuY3lGaWx0ZXIiLCJmb3JtYXRzIiwiTlVNQkVSX0ZPUk1BVFMiLCJhbW91bnQiLCJjdXJyZW5jeVN5bWJvbCIsInNlcCIsIkRFQ0lNQUxfU0VQIiwic3ltYm9sIiwiQ1VSUkVOQ1lfU1lNIiwic3Vic3RyaW5nIiwiJHJvb3RTY29wZSIsIiRzY29wZSIsIlVzZXIiLCJtZSIsInVzZXIiLCJsb2ciLCJ1c2VyQWdlbnQiLCJuYXZpZ2F0b3IiLCIkb24iLCJsb2FkaW5nIiwiYm90dG9tUmVhY2hlZCIsImFsZXJ0Iiwibm90aWNlcyIsImoiLCJpY29uIiwibWVzc2FnZSIsImRlbGV0ZU5vdGljZSIsIm5vdGljZSIsImluZGV4Iiwic3BsaWNlIiwib25lIiwidGhlbiIsIkZvcm1Vc2VyIiwidXBkYXRlUHJvZmlsZSIsInB1dCJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxZQUVBQSxTQUNBQyxPQUFBLE9BQ0EsVUFDQSxvQkFDQSxXQUNBLFdBQ0EsV0FDQSxXQUNBLGdCQU9BLCtCQUVBQyxLQUFBLGFBQUEsU0FBQUMsR0FDQUMsT0FBQUQsV0FBQUEsS0FFQUUs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QSxJQUNBakIsRUFBQVcsUUFBQU8sT0FBQUQsRUFBQSxVQ25EQSxXQUNBLFlBQ0ExSCxTQUFBQyxPQUFBLFlBQUEscUJBQ0FTLFdBQUEsWUFBQSxTQUFBLE9BQUEsU0FBQStGLEVBQUFDLEdBRUFBLEVBQUFrQixJQUFBLFdBQUFwRixNQUNBcUYsS0FBQSxTQUFBekcsR0FDQXFGLEVBQUFxQixTQUFBMUcsSUFGQXNGLFNBSUEsU0FBQW5GLEdBQ0E0RixNQUFBNUYsRUFBQUgsUUFHQXFGLEVBQUFzQixjQUFBLFdBQ0F0QixFQUFBcUIsU0FBQUUsTUFBQXZCLFNBQ0EsU0FBQWxGLEdBQ0E0RixNQUFBNUYsRUFBQUgsZUNoQkEsV0FDQSxZQUNBcEIsU0FDQUMsT0FBQSx1QkFFQW9DLFFBQUEsUUFBQSxRQUFBLFNBQUFDLEdBRUEsT0FDQXFFLEdBQUEsV0FDQSxNQUFBckUsR0FBQUUsSUFBQSIsImZpbGUiOiJidWlsZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJywgW1xuICAgICAgJ25nUm91dGUnLFxuICAgICAgJ21vYmlsZS1hbmd1bGFyLXVpJyxcbiAgICAgICdhcHAubWFpbicsXG4gICAgICAnYXBwLmhvbWUnLFxuICAgICAgJ25nTm90aWZ5JyxcbiAgICAgICdhcHAudXNlcicsXG4gICAgICAnYXBwLm5lY2VzaWRhZCcsXG4gICAgICAvLyB0b3VjaC9kcmFnIGZlYXR1cmU6IHRoaXMgaXMgZnJvbSAnbW9iaWxlLWFuZ3VsYXItdWkuZ2VzdHVyZXMuanMnXG4gICAgICAvLyBpdCBpcyBhdCBhIHZlcnkgYmVnaW5uaW5nIHN0YWdlLCBzbyBwbGVhc2UgYmUgY2FyZWZ1bCBpZiB5b3UgbGlrZSB0byB1c2VcbiAgICAgIC8vIGluIHByb2R1Y3Rpb24uIFRoaXMgaXMgaW50ZW5kZWQgdG8gcHJvdmlkZSBhIGZsZXhpYmxlLCBpbnRlZ3JhdGVkIGFuZCBhbmRcbiAgICAgIC8vIGVhc3kgdG8gdXNlIGFsdGVybmF0aXZlIHRvIG90aGVyIDNyZCBwYXJ0eSBsaWJzIGxpa2UgaGFtbWVyLmpzLCB3aXRoIHRoZVxuICAgICAgLy8gZmluYWwgcG91cnBvc2UgdG8gaW50ZWdyYXRlIGdlc3R1cmVzIGludG8gZGVmYXVsdCB1aSBpbnRlcmFjdGlvbnMgbGlrZVxuICAgICAgLy8gb3BlbmluZyBzaWRlYmFycywgdHVybmluZyBzd2l0Y2hlcyBvbi9vZmYgLi5cbiAgICAgICdtb2JpbGUtYW5ndWxhci11aS5nZXN0dXJlcydcbiAgICBdKVxuICAgIC5ydW4oWyckdHJhbnNmb3JtJyxmdW5jdGlvbigkdHJhbnNmb3JtKSB7XG4gICAgICB3aW5kb3cuJHRyYW5zZm9ybSA9ICR0cmFuc2Zvcm07XG4gICAgfV0pXG4gICAgLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJyxmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAgICRyb3V0ZVByb3ZpZGVyXG4gICAgICAgIC53aGVuKCcvJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9ob21lL2hvbWUuaHRtbCcsXG4gICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9ob21lL3Njcm9sbC5odG1sJyxcbiAgICAgICAgICByZWxvYWRPblNlYXJjaDogZmFsc2UsXG4gICAgICAgICAgY29udHJvbGxlcjonSG9tZUN0cmwnLFxuICAgICAgICAgIGNvbnRyb2xsZXJBczonSG9tZUN0cmwnXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvbmVjZXNpZGFkLzppZCcsIHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvbmVjZXNpZGFkL2RldGFsbGUuaHRtbCcsXG4gICAgICAgICAgY29udHJvbGxlcjonTmVjZXNpZGFkRGV0YWxsZUN0cmwnLFxuICAgICAgICAgIGNvbnRyb2xsZXJBczonRGV0YWxsZUN0cmwnXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvbmVjZXNpZGFkLzppZC9lZGl0YXInLCB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL25lY2VzaWRhZC9lZGl0YXIuaHRtbCcsXG4gICAgICAgICAgY29udHJvbGxlcjonTmVjZXNpZGFkRGV0YWxsZUN0cmwnLFxuICAgICAgICAgIGNvbnRyb2xsZXJBczonRGV0YWxsZUN0cmwnXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvY2F0ZWdvcmlhLzpjYXRlZ29yaWEnLCB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL25lY2VzaWRhZC9jYXRlZ29yaWEuaHRtbCcsXG4gICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlLFxuICAgICAgICAgIGNvbnRyb2xsZXI6J0NhdGVnb3JpYUN0cmwnLFxuICAgICAgICAgIGNvbnRyb2xsZXJBczonQ2F0ZWdvcmlhQ3RybCdcbiAgICAgICAgfSlcblxuICAgICAgICAub3RoZXJ3aXNlKHtcbiAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuXG5cbiAgICAvLyBhcHAuZGlyZWN0aXZlKCd0b3VjaGFyZWEnLCBbJyR0b3VjaCcsIGZ1bmN0aW9uKCR0b3VjaCl7XG4gICAgLy8gICAvLyBSdW5zIGR1cmluZyBjb21waWxlXG4gICAgLy8gICByZXR1cm4ge1xuICAgIC8vICAgICByZXN0cmljdDogJ0MnLFxuICAgIC8vICAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsIGVsZW0pIHtcbiAgICAvLyAgICAgICAkc2NvcGUudG91Y2ggPSBudWxsO1xuICAgIC8vICAgICAgICR0b3VjaC5iaW5kKGVsZW0sIHtcbiAgICAvLyAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbih0b3VjaCkge1xuICAgIC8vICAgICAgICAgICAkc2NvcGUudG91Y2ggPSB0b3VjaDtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIC8vICAgICAgICAgfSxcbiAgICAvL1xuICAgIC8vICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbih0b3VjaCkge1xuICAgIC8vICAgICAgICAgICAkc2NvcGUudG91Y2ggPSB0b3VjaDtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIC8vICAgICAgICAgfSxcbiAgICAvL1xuICAgIC8vICAgICAgICAgbW92ZTogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH0sXG4gICAgLy9cbiAgICAvLyAgICAgICAgIGVuZDogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgICB9KTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9XSk7XG4gICAgLy9cbiAgICAvLyAvL1xuICAgIC8vIC8vIGAkZHJhZ2AgZXhhbXBsZTogZHJhZyB0byBkaXNtaXNzXG4gICAgLy8gLy9cbiAgICAvLyBhcHAuZGlyZWN0aXZlKCdkcmFnVG9EaXNtaXNzJywgZnVuY3Rpb24oJGRyYWcsICRwYXJzZSwgJHRpbWVvdXQpe1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAvLyAgICAgY29tcGlsZTogZnVuY3Rpb24oZWxlbSwgYXR0cnMpIHtcbiAgICAvLyAgICAgICB2YXIgZGlzbWlzc0ZuID0gJHBhcnNlKGF0dHJzLmRyYWdUb0Rpc21pc3MpO1xuICAgIC8vICAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbSl7XG4gICAgLy8gICAgICAgICB2YXIgZGlzbWlzcyA9IGZhbHNlO1xuICAgIC8vXG4gICAgLy8gICAgICAgICAkZHJhZy5iaW5kKGVsZW0sIHtcbiAgICAvLyAgICAgICAgICAgdHJhbnNmb3JtOiAkZHJhZy5UUkFOU0xBVEVfUklHSFQsXG4gICAgLy8gICAgICAgICAgIG1vdmU6IGZ1bmN0aW9uKGRyYWcpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiggZHJhZy5kaXN0YW5jZVggPj0gZHJhZy5yZWN0LndpZHRoIC8gNCkge1xuICAgIC8vICAgICAgICAgICAgICAgZGlzbWlzcyA9IHRydWU7XG4gICAgLy8gICAgICAgICAgICAgICBlbGVtLmFkZENsYXNzKCdkaXNtaXNzJyk7XG4gICAgLy8gICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAvLyAgICAgICAgICAgICAgIGRpc21pc3MgPSBmYWxzZTtcbiAgICAvLyAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3MoJ2Rpc21pc3MnKTtcbiAgICAvLyAgICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICAgIH0sXG4gICAgLy8gICAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgICAgICAgICBlbGVtLnJlbW92ZUNsYXNzKCdkaXNtaXNzJyk7XG4gICAgLy8gICAgICAgICAgIH0sXG4gICAgLy8gICAgICAgICAgIGVuZDogZnVuY3Rpb24oZHJhZykge1xuICAgIC8vICAgICAgICAgICAgIGlmIChkaXNtaXNzKSB7XG4gICAgLy8gICAgICAgICAgICAgICBlbGVtLmFkZENsYXNzKCdkaXNtaXR0ZWQnKTtcbiAgICAvLyAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgIC8vICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgICAgICAgICAgICAgICAgZGlzbWlzc0ZuKHNjb3BlKTtcbiAgICAvLyAgICAgICAgICAgICAgICAgfSk7XG4gICAgLy8gICAgICAgICAgICAgICB9LCAzMDApO1xuICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICAgICAgICBkcmFnLnJlc2V0KCk7XG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICB9KTtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9O1xuICAgIC8vIH0pO1xuICAgIC8vXG4gICAgLy8gLy9cbiAgICAvLyAvLyBBbm90aGVyIGAkZHJhZ2AgdXNhZ2UgZXhhbXBsZTogdGhpcyBpcyBob3cgeW91IGNvdWxkIGNyZWF0ZVxuICAgIC8vIC8vIGEgdG91Y2ggZW5hYmxlZCBcImRlY2sgb2YgY2FyZHNcIiBjYXJvdXNlbC4gU2VlIGBjYXJvdXNlbC5odG1sYCBmb3IgbWFya3VwLlxuICAgIC8vIC8vXG4gICAgLy8gYXBwLmRpcmVjdGl2ZSgnY2Fyb3VzZWwnLCBmdW5jdGlvbigpe1xuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAvLyAgICAgc2NvcGU6IHt9LFxuICAgIC8vICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgICB0aGlzLml0ZW1Db3VudCA9IDA7XG4gICAgLy8gICAgICAgdGhpcy5hY3RpdmVJdGVtID0gbnVsbDtcbiAgICAvL1xuICAgIC8vICAgICAgIHRoaXMuYWRkSXRlbSA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICB2YXIgbmV3SWQgPSB0aGlzLml0ZW1Db3VudCsrO1xuICAgIC8vICAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gdGhpcy5pdGVtQ291bnQgPT09IDEgPyBuZXdJZCA6IHRoaXMuYWN0aXZlSXRlbTtcbiAgICAvLyAgICAgICAgIHJldHVybiBuZXdJZDtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vXG4gICAgLy8gICAgICAgdGhpcy5uZXh0ID0gZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSB8fCAwO1xuICAgIC8vICAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gdGhpcy5hY3RpdmVJdGVtID09PSB0aGlzLml0ZW1Db3VudCAtIDEgPyAwIDogdGhpcy5hY3RpdmVJdGVtICsgMTtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vXG4gICAgLy8gICAgICAgdGhpcy5wcmV2ID0gZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSB8fCAwO1xuICAgIC8vICAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gdGhpcy5hY3RpdmVJdGVtID09PSAwID8gdGhpcy5pdGVtQ291bnQgLSAxIDogdGhpcy5hY3RpdmVJdGVtIC0gMTtcbiAgICAvLyAgICAgICB9O1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9O1xuICAgIC8vIH0pO1xuXG5cblxuICAgIC8vXG4gICAgLy8gRm9yIHRoaXMgdHJpdmlhbCBkZW1vIHdlIGhhdmUganVzdCBhIHVuaXF1ZSBNYWluQ29udHJvbGxlclxuICAgIC8vIGZvciBldmVyeXRoaW5nXG4gICAgLy9cbiAgICAvLyBhcHAuY29udHJvbGxlcignTWFpbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUpe1xuICAgIC8vXG4gICAgLy8gICAkc2NvcGUuc3dpcGVkID0gZnVuY3Rpb24oZGlyZWN0aW9uKSB7XG4gICAgLy8gICAgIGFsZXJ0KCdTd2lwZWQgJyArIGRpcmVjdGlvbik7XG4gICAgLy8gICB9O1xuICAgIC8vXG4gICAgLy8gICAvLyBVc2VyIGFnZW50IGRpc3BsYXllZCBpbiBob21lIHBhZ2VcbiAgICAvLyAgICRzY29wZS51c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuICAgIC8vXG4gICAgLy8gICAvLyBOZWVkZWQgZm9yIHRoZSBsb2FkaW5nIHNjcmVlblxuICAgIC8vICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24oKXtcbiAgICAvLyAgICAgJHJvb3RTY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAvLyAgIH0pO1xuICAgIC8vXG4gICAgLy8gICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgIC8vICAgfSk7XG4gICAgLy9cbiAgICAvLyAgIC8vIEZha2UgdGV4dCBpIHVzZWQgaGVyZSBhbmQgdGhlcmUuXG4gICAgLy8gICAkc2NvcGUubG9yZW0gPSAnTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2ljaW5nIGVsaXQuIFZlbCBleHBsaWNhYm8sIGFsaXF1aWQgZWFxdWUgc29sdXRhIG5paGlsIGVsaWdlbmRpIGFkaXBpc2NpIGVycm9yLCBpbGx1bSBjb3JydXB0aSBuYW0gZnVnYSBvbW5pcyBxdW9kIHF1YWVyYXQgbW9sbGl0aWEgZXhwZWRpdGEgaW1wZWRpdCBkb2xvcmVzIGlwc2FtLiBPYmNhZWNhdGkuJztcbiAgICAvL1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vICdTY3JvbGwnIHNjcmVlblxuICAgIC8vICAgLy9cbiAgICAvLyAgIHZhciBzY3JvbGxJdGVtcyA9IFtdO1xuICAgIC8vXG4gICAgLy8gICBmb3IgKHZhciBpPTE7IGk8PTEwMDsgaSsrKSB7XG4gICAgLy8gICAgIHNjcm9sbEl0ZW1zLnB1c2goJ0l0ZW0gJyArIGkpO1xuICAgIC8vICAgfVxuICAgIC8vXG4gICAgLy8gICAkc2NvcGUuc2Nyb2xsSXRlbXMgPSBzY3JvbGxJdGVtcztcbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLmJvdHRvbVJlYWNoZWQgPSBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgLyogZ2xvYmFsIGFsZXJ0OiBmYWxzZTsgKi9cbiAgICAvLyAgICAgYWxlcnQoJ0NvbmdyYXRzIHlvdSBzY3JvbGxlZCB0byB0aGUgZW5kIG9mIHRoZSBsaXN0IScpO1xuICAgIC8vICAgfTtcbiAgICAvL1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vIFJpZ2h0IFNpZGViYXJcbiAgICAvLyAgIC8vXG4gICAgLy8gICAkc2NvcGUuY2hhdFVzZXJzID0gW1xuICAgIC8vICAgICB7IG5hbWU6ICdDYXJsb3MgIEZsb3dlcnMnLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQnlyb24gVGF5bG9yJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0phbmEgIFRlcnJ5Jywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0RhcnJ5bCAgU3RvbmUnLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnRmFubmllICBDYXJsc29uJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0hvbGx5IE5ndXllbicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdCaWxsICBDaGF2ZXonLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnVmVyb25pY2EgIE1heHdlbGwnLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnSmVzc2ljYSBXZWJzdGVyJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0phY2tpZSAgQmFydG9uJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0NyeXN0YWwgRHJha2UnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ01pbHRvbiAgRGVhbicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnSm9hbm4gSm9obnN0b24nLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0NvcmEgIFZhdWdobicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnTmluYSAgQnJpZ2dzJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdDYXNleSBUdXJuZXInLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0ppbW1pZSAgV2lsc29uJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdOYXRoYW5pZWwgU3RlZWxlJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdBdWJyZXkgIENvbGUnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0Rvbm5pZSAgU3VtbWVycycsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnS2F0ZSAgTXllcnMnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ1ByaXNjaWxsYSBIYXdraW5zJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKb2UgQmFya2VyJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdMZWUgTm9ybWFuJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdFYm9ueSBSaWNlJywgb25saW5lOiBmYWxzZSB9XG4gICAgLy8gICBdO1xuICAgIC8vXG4gICAgLy8gICAvL1xuICAgIC8vICAgLy8gJ0Zvcm1zJyBzY3JlZW5cbiAgICAvLyAgIC8vXG4gICAgLy8gICAkc2NvcGUucmVtZW1iZXJNZSA9IHRydWU7XG4gICAgLy8gICAkc2NvcGUuZW1haWwgPSAnbWVAZXhhbXBsZS5jb20nO1xuICAgIC8vXG4gICAgLy8gICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgYWxlcnQoJ1lvdSBzdWJtaXR0ZWQgdGhlIGxvZ2luIGZvcm0nKTtcbiAgICAvLyAgIH07XG4gICAgLy8gICAvL1xuICAgIC8vICAgLy8gJ0RyYWcnIHNjcmVlblxuICAgIC8vICAgLy9cbiAgICAvLyAgICRzY29wZS5ub3RpY2VzID0gW107XG4gICAgLy9cbiAgICAvLyAgIGZvciAodmFyIGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgIC8vICAgICAkc2NvcGUubm90aWNlcy5wdXNoKHtpY29uOiAnZW52ZWxvcGUnLCBtZXNzYWdlOiAnTm90aWNlICcgKyAoaiArIDEpIH0pO1xuICAgIC8vICAgfVxuICAgIC8vXG4gICAgLy8gICAkc2NvcGUuZGVsZXRlTm90aWNlID0gZnVuY3Rpb24obm90aWNlKSB7XG4gICAgLy8gICAgIHZhciBpbmRleCA9ICRzY29wZS5ub3RpY2VzLmluZGV4T2Yobm90aWNlKTtcbiAgICAvLyAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAvLyAgICAgICAkc2NvcGUubm90aWNlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9O1xuICAgIC8vIH0pO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLmhvbWUnLFtdKVxuICAgICAgLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJyxbJ05lY2VzaWRhZCcsJ25nTm90aWZ5JyxmdW5jdGlvbiAoTmVjZXNpZGFkLG5nTm90aWZ5KSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICBOZWNlc2lkYWQubG9hZCgpXG4gICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgdm0ubmVjZXNpZGFkZXMgPSBkYXRhO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIG5nTm90aWZ5LnNldChlcnIsICdlcnJvcicpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLm5lY2VzaWRhZC5jYXRlZ29yaWEnLFtdKVxuICAgICAgLmNvbnRyb2xsZXIoJ0NhdGVnb3JpYUN0cmwnLFsnTmVjZXNpZGFkJywnJHJvdXRlUGFyYW1zJyxmdW5jdGlvbiAoTmVjZXNpZGFkLCRyb3V0ZVBhcmFtcykge1xuXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cblxuXG4gICAgICAgIE5lY2VzaWRhZC5jYXRlZ29yaWEoJHJvdXRlUGFyYW1zLmNhdGVnb3JpYSlcbiAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdm0ubmVjZXNpZGFkZXMgPSBkYXRhLm5lY2VzaWRhZGVzO1xuICAgICAgICAgICAgdm0uY2F0ZWdvcmlhID0gZGF0YS5jYXRlZ29yaWE7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLm5lY2VzaWRhZC5kZXRhbGxlJyxbXSlcbiAgICAgIC5jb250cm9sbGVyKCdOZWNlc2lkYWREZXRhbGxlQ3RybCcsWydOZWNlc2lkYWQnLCduZ05vdGlmeScsJyRyb3V0ZVBhcmFtcycsJyR3aW5kb3cnLGZ1bmN0aW9uIChOZWNlc2lkYWQsbmdOb3RpZnksJHJvdXRlUGFyYW1zLCR3aW5kb3cpIHtcblxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5uZWNlc2lkYWQgPSB7fTtcblxuICAgICAgICBpZiAoJHJvdXRlUGFyYW1zLmlkKSB7XG4gICAgICAgICAgTmVjZXNpZGFkLnNob3coJHJvdXRlUGFyYW1zLmlkKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgdm0ubmVjZXNpZGFkID0gZGF0YTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2bS5zYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIE5lY2VzaWRhZC51cGRhdGUodm0ubmVjZXNpZGFkKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGRhdGEsJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdm0uZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBzdXJlID0gY29uZmlybSgnUmVhbG1lbnRlIGRlc2VhcyBlbGltaW5hciBlc3RhIHB1YmxpY2FjacOzbj8nKTtcbiAgICAgICAgICBpZiAoc3VyZSkge1xuICAgICAgICAgICAgTmVjZXNpZGFkLmRlbGV0ZSh2bS5uZWNlc2lkYWQuaWQpXG4gICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGRhdGEsJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uID0gJyMvJztcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cblxuICAgICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5uZWNlc2lkYWQnLFtcbiAgICAgICdhcHAubmVjZXNpZGFkLnNlcnZpY2UnLFxuICAgICAgJ2FwcC5uZWNlc2lkYWQubnVldmEnLFxuICAgICAgJ2FwcC5uZWNlc2lkYWQuZGV0YWxsZScsXG4gICAgICAnYXBwLm5lY2VzaWRhZC5jYXRlZ29yaWEnXG4gICAgXSlcbiAgICAgIC5jb250cm9sbGVyKCdOZWNlc2lkYWRlc0N0cmwnLFsnTmVjZXNpZGFkJywnbmdOb3RpZnknLGZ1bmN0aW9uIChOZWNlc2lkYWQsbmdOb3RpZnkpIHtcblxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIE5lY2VzaWRhZC5sb2FkKClcbiAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICB2bS5uZWNlc2lkYWRlcyA9IGRhdGE7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwgJ2Vycm9yJyk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAubmVjZXNpZGFkLnNlcnZpY2UnLFtdKVxuICAgICAgLmZhY3RvcnkoJ05lY2VzaWRhZCcsWyckaHR0cCcsZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBsb2FkOmZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9uZWNlc2lkYWRlcycpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2hvdzpmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvbmVjZXNpZGFkZXMvJyArIGlkKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNhdGVnb3JpYTpmdW5jdGlvbiAoY2xhdmUpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY2F0ZWdvcmlhcy8nICsgY2xhdmUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZGVsZXRlOmZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9uZWNlc2lkYWRlcy8nICsgaWQpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY3JlYXRlOmZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgICBkYXRhICAgIDogIGRhdGEsXG4gICAgICAgICAgICAgIG1ldGhvZCAgOiAnUE9TVCcsXG4gICAgICAgICAgICAgIHVybCAgICAgOiAnL2FwaS9uZWNlc2lkYWRlcydcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdXBkYXRlOmZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgICBkYXRhICAgIDogIGRhdGEsXG4gICAgICAgICAgICAgIG1ldGhvZCAgOiAnUFVUJyxcbiAgICAgICAgICAgICAgdXJsICAgICA6ICcvYXBpL25lY2VzaWRhZGVzLycgKyBkYXRhLmlkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfV0pXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLm5lY2VzaWRhZC5udWV2YScsW10pXG4gICAgICAuY29udHJvbGxlcignTnVldmFOZWNlc2lkYWRDdHJsJyxbJ05lY2VzaWRhZCcsJ25nTm90aWZ5JywnJHdpbmRvdycsZnVuY3Rpb24gKE5lY2VzaWRhZCxuZ05vdGlmeSwkd2luZG93XG4gICAgICApIHtcblxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5OZWNlc2lkYWRGb3JtID0ge307XG5cbiAgICAgICAgdm0uY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIE5lY2VzaWRhZC5jcmVhdGUodm0uTmVjZXNpZGFkRm9ybSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIG5nTm90aWZ5LnNldChkYXRhLCdzdWNjZXNzJyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAkd2luZG93LmxvY2F0aW9uID0gJyMvbmVjZXNpZGFkLycgKyBkYXRhO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgIG5nTm90aWZ5LnNldChlcnIsJ2Vycm9yJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgfV0pO1xufSkoKTtcbiIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCdhcHAuZGlyZWN0aXZlcycsIFtdKVxuICAuZGlyZWN0aXZlKCdtb25leScsIGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBOVU1CRVJfUkVHRVhQID0gL15cXHMqKFxcLXxcXCspPyhcXGQrfChcXGQqKFxcLlxcZCopKSlcXHMqJC87XG5cbiAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbCwgYXR0cnMsIG5nTW9kZWxDdHJsKSB7XG4gICAgICB2YXIgbWluID0gcGFyc2VGbG9hdChhdHRycy5taW4gfHwgMCk7XG4gICAgICB2YXIgcHJlY2lzaW9uID0gcGFyc2VGbG9hdChhdHRycy5wcmVjaXNpb24gfHwgMik7XG4gICAgICB2YXIgbGFzdFZhbGlkVmFsdWU7XG5cbiAgICAgIGZ1bmN0aW9uIHJvdW5kKG51bSkge1xuICAgICAgICB2YXIgZCA9IE1hdGgucG93KDEwLCBwcmVjaXNpb24pO1xuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChudW0gKiBkKSAvIGQ7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGZvcm1hdFByZWNpc2lvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSkudG9GaXhlZChwcmVjaXNpb24pO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBmb3JtYXRWaWV3VmFsdWUodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIG5nTW9kZWxDdHJsLiRpc0VtcHR5KHZhbHVlKSA/ICcnIDogJycgKyB2YWx1ZTtcbiAgICAgIH1cblxuXG4gICAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgICAgICB2YWx1ZSA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSGFuZGxlIGxlYWRpbmcgZGVjaW1hbCBwb2ludCwgbGlrZSBcIi41XCJcbiAgICAgICAgaWYgKHZhbHVlLmluZGV4T2YoJy4nKSA9PT0gMCkge1xuICAgICAgICAgIHZhbHVlID0gJzAnICsgdmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBbGxvdyBcIi1cIiBpbnB1dHMgb25seSB3aGVuIG1pbiA8IDBcbiAgICAgICAgaWYgKHZhbHVlLmluZGV4T2YoJy0nKSA9PT0gMCkge1xuICAgICAgICAgIGlmIChtaW4gPj0gMCkge1xuICAgICAgICAgICAgdmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSgnJyk7XG4gICAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gJy0nKSB7XG4gICAgICAgICAgICB2YWx1ZSA9ICcnO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBlbXB0eSA9IG5nTW9kZWxDdHJsLiRpc0VtcHR5KHZhbHVlKTtcbiAgICAgICAgaWYgKGVtcHR5IHx8IE5VTUJFUl9SRUdFWFAudGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgICBsYXN0VmFsaWRWYWx1ZSA9ICh2YWx1ZSA9PT0gJycpXG4gICAgICAgICAgPyBudWxsXG4gICAgICAgICAgOiAoZW1wdHkgPyB2YWx1ZSA6IHBhcnNlRmxvYXQodmFsdWUpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBSZW5kZXIgdGhlIGxhc3QgdmFsaWQgaW5wdXQgaW4gdGhlIGZpZWxkXG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZShmb3JtYXRWaWV3VmFsdWUobGFzdFZhbGlkVmFsdWUpKTtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICBuZ01vZGVsQ3RybC4kc2V0VmFsaWRpdHkoJ251bWJlcicsIHRydWUpO1xuICAgICAgICByZXR1cm4gbGFzdFZhbGlkVmFsdWU7XG4gICAgICB9KTtcbiAgICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2goZm9ybWF0Vmlld1ZhbHVlKTtcblxuICAgICAgdmFyIG1pblZhbGlkYXRvciA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGlmICghbmdNb2RlbEN0cmwuJGlzRW1wdHkodmFsdWUpICYmIHZhbHVlIDwgbWluKSB7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdtaW4nLCBmYWxzZSk7XG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0VmFsaWRpdHkoJ21pbicsIHRydWUpO1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIG5nTW9kZWxDdHJsLiRwYXJzZXJzLnB1c2gobWluVmFsaWRhdG9yKTtcbiAgICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2gobWluVmFsaWRhdG9yKTtcblxuICAgICAgaWYgKGF0dHJzLm1heCkge1xuICAgICAgICB2YXIgbWF4ID0gcGFyc2VGbG9hdChhdHRycy5tYXgpO1xuICAgICAgICB2YXIgbWF4VmFsaWRhdG9yID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBpZiAoIW5nTW9kZWxDdHJsLiRpc0VtcHR5KHZhbHVlKSAmJiB2YWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdtYXgnLCBmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZ01vZGVsQ3RybC4kc2V0VmFsaWRpdHkoJ21heCcsIHRydWUpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKG1heFZhbGlkYXRvcik7XG4gICAgICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2gobWF4VmFsaWRhdG9yKTtcbiAgICAgIH1cblxuICAgICAgLy8gUm91bmQgb2ZmXG4gICAgICBpZiAocHJlY2lzaW9uID4gLTEpIHtcbiAgICAgICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWUgPyByb3VuZCh2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlID8gZm9ybWF0UHJlY2lzaW9uKHZhbHVlKSA6IHZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZWwuYmluZCgnYmx1cicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gbmdNb2RlbEN0cmwuJG1vZGVsVmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUgPSBmb3JtYXRQcmVjaXNpb24odmFsdWUpO1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICBsaW5rOiBsaW5rXG4gICAgfTtcbiAgfSkuZGlyZWN0aXZlKCdudW1iZXJzT25seScsIGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIG1vZGVsQ3RybCkge1xuICAgICAgICBtb2RlbEN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbiAoaW5wdXRWYWx1ZSkge1xuICAgICAgICAgIC8vIHRoaXMgbmV4dCBpZiBpcyBuZWNlc3NhcnkgZm9yIHdoZW4gdXNpbmcgbmctcmVxdWlyZWQgb24geW91ciBpbnB1dC5cbiAgICAgICAgICAvLyBJbiBzdWNoIGNhc2VzLCB3aGVuIGEgbGV0dGVyIGlzIHR5cGVkIGZpcnN0LCB0aGlzIHBhcnNlciB3aWxsIGJlIGNhbGxlZFxuICAgICAgICAgIC8vIGFnYWluLCBhbmQgdGhlIDJuZCB0aW1lLCB0aGUgdmFsdWUgd2lsbCBiZSB1bmRlZmluZWRcbiAgICAgICAgICBpZiAoaW5wdXRWYWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gJyc7XG4gICAgICAgICAgdmFyIHRyYW5zZm9ybWVkSW5wdXQgPSBpbnB1dFZhbHVlLnJlcGxhY2UoL1teMC05Ky5dL2csICcnKTtcbiAgICAgICAgICBpZiAodHJhbnNmb3JtZWRJbnB1dCE9PWlucHV0VmFsdWUpIHtcbiAgICAgICAgICAgIG1vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKHRyYW5zZm9ybWVkSW5wdXQpO1xuICAgICAgICAgICAgbW9kZWxDdHJsLiRyZW5kZXIoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gdHJhbnNmb3JtZWRJbnB1dDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwLmZpbHRlcnMnLFtdKVxuICAuZmlsdGVyKCdkaW5lcm8nLFxuICBbICckZmlsdGVyJywgJyRsb2NhbGUnLCBmdW5jdGlvbihmaWx0ZXIsIGxvY2FsZSkge1xuICAgIHZhciBjdXJyZW5jeUZpbHRlciA9IGZpbHRlcignY3VycmVuY3knKTtcbiAgICB2YXIgZm9ybWF0cyA9IGxvY2FsZS5OVU1CRVJfRk9STUFUUztcbiAgICByZXR1cm4gZnVuY3Rpb24oYW1vdW50LCBudW0sIGN1cnJlbmN5U3ltYm9sKSB7XG4gICAgICBpZiAobnVtPT09MCkgbnVtID0gLTE7XG4gICAgICB2YXIgdmFsdWUgPSBjdXJyZW5jeUZpbHRlcihhbW91bnQsIGN1cnJlbmN5U3ltYm9sKTtcbiAgICAgIHZhciBzZXAgPSB2YWx1ZS5pbmRleE9mKGZvcm1hdHMuREVDSU1BTF9TRVApKzE7XG4gICAgICB2YXIgc3ltYm9sID0gJyc7XG4gICAgICBpZiAoc2VwPHZhbHVlLmluZGV4T2YoZm9ybWF0cy5DVVJSRU5DWV9TWU0pKSBzeW1ib2wgPSAnICcrZm9ybWF0cy5DVVJSRU5DWV9TWU07XG4gICAgICByZXR1cm4gdmFsdWUuc3Vic3RyaW5nKDAsIHNlcCtudW0pK3N5bWJvbDtcbiAgICB9O1xuICB9IF0pO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICAgIGFuZ3VsYXJcbiAgICAgIC5tb2R1bGUoJ2FwcC5tYWluJywgW1xuICAgICAgJ2FwcC5kaXJlY3RpdmVzJyxcbiAgICAgICdhcHAuZmlsdGVycydcbiAgICBdKVxuICAgIC5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsWyckcm9vdFNjb3BlJywnJHNjb3BlJywnVXNlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgVXNlcil7XG5cbiAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgIFVzZXIubWUoKVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIHZtLnVzZXIgPSBkYXRhO1xuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgIH0pO1xuXG4gICAgICAvLyBVc2VyIGFnZW50IGRpc3BsYXllZCBpbiBob21lIHBhZ2VcbiAgICAgICRzY29wZS51c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuXG4gICAgICAvLyBOZWVkZWQgZm9yIHRoZSBsb2FkaW5nIHNjcmVlblxuICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24oKXtcbiAgICAgICAgJHJvb3RTY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgIH0pO1xuXG4gICAgICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgfSk7XG5cblxuXG4gICAgICAkc2NvcGUuYm90dG9tUmVhY2hlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvKiBnbG9iYWwgYWxlcnQ6IGZhbHNlOyAqL1xuICAgICAgICBhbGVydCgnQ29uZ3JhdHMgeW91IHNjcm9sbGVkIHRvIHRoZSBlbmQgb2YgdGhlIGxpc3QhJyk7XG4gICAgICB9O1xuXG5cbiAgICAgIC8vXG4gICAgICAvLyAnRHJhZycgc2NyZWVuXG4gICAgICAvL1xuICAgICAgJHNjb3BlLm5vdGljZXMgPSBbXTtcblxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgICRzY29wZS5ub3RpY2VzLnB1c2goe2ljb246ICdlbnZlbG9wZScsIG1lc3NhZ2U6ICdOb3RpY2UgJyArIChqICsgMSkgfSk7XG4gICAgICB9XG5cbiAgICAgICRzY29wZS5kZWxldGVOb3RpY2UgPSBmdW5jdGlvbihub3RpY2UpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gJHNjb3BlLm5vdGljZXMuaW5kZXhPZihub3RpY2UpO1xuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICRzY29wZS5ub3RpY2VzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC51c2VyJywgWydhcHAudXNlci5zZXJ2aWNlJ10pXG4gICAgLmNvbnRyb2xsZXIoJ1VzZXJDdHJsJyxbJyRzY29wZScsJ1VzZXInLGZ1bmN0aW9uKCRzY29wZSxVc2VyKXtcblxuICAgICAgVXNlci5vbmUoJ3Byb2ZpbGUnKS5nZXQoKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAgKGRhdGEpIHtcbiAgICAgICAgICAkc2NvcGUuRm9ybVVzZXIgPSBkYXRhO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24gIChlcnIpIHtcbiAgICAgICAgICBhbGVydChlcnIuZGF0YSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAkc2NvcGUudXBkYXRlUHJvZmlsZSA9IGZ1bmN0aW9uICAoKSB7XG4gICAgICAgICRzY29wZS5Gb3JtVXNlci5wdXQoKVxuICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAgKGVycikge1xuICAgICAgICAgICAgYWxlcnQoZXJyLmRhdGEpO1xuICAgICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9XSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAudXNlci5zZXJ2aWNlJywgIFtdKVxuXG4gICAgICAuZmFjdG9yeSAoJ1VzZXInLCBbJyRodHRwJyxmdW5jdGlvbiAoJGh0dHApIHtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIG1lOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvcHJvZmlsZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1dKTtcblxufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
