!function(){"use strict";angular.module("app",["ngRoute","mobile-angular-ui","app.main","app.home","ngNotify","app.necesidad","mobile-angular-ui.gestures"]).run(["$transform",function(e){window.$transform=e}]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"scripts/home/home.html",reloadOnSearch:!1}).when("/",{templateUrl:"scripts/home/scroll.html",reloadOnSearch:!1,controller:"HomeCtrl",controllerAs:"HomeCtrl"}).when("/necesidad/:id",{templateUrl:"scripts/necesidad/detalle.html",reloadOnSearch:!1,controller:"NecesidadDetalleCtrl",controllerAs:"DetalleCtrl"}).when("/categoria/:categoria",{templateUrl:"scripts/necesidad/categoria.html",reloadOnSearch:!1,controller:"CategoriaCtrl",controllerAs:"CategoriaCtrl"}).otherwise({redirectTo:"/"})}])}(),function(){"use strict";angular.module("app.home",[]).controller("HomeCtrl",["Necesidad","ngNotify",function(e,r){var t=this;e.load().success(function(e){t.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad.categoria",[]).controller("CategoriaCtrl",["Necesidad","$routeParams",function(e,r){var t=this;e.categoria(r.categoria).success(function(e){t.necesidades=e.necesidades,t.categoria=e.categoria}).error(function(e){console.error(e)})}])}(),function(){"use strict";angular.module("app.necesidad.detalle",[]).controller("NecesidadDetalleCtrl",["Necesidad","ngNotify","$routeParams",function(e,r,t){var n=this;t.id&&e.show(t.id).success(function(e){n.necesidad=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad",["app.necesidad.service","app.necesidad.nueva","app.necesidad.detalle","app.necesidad.categoria"]).controller("NecesidadesCtrl",["Necesidad","ngNotify",function(e,r){var t=this;e.load().success(function(e){t.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad.service",[]).factory("Necesidad",["$http",function(e){return{load:function(r){return e.get("/api/necesidades")},show:function(r){return e.get("/api/necesidades/"+r)},categoria:function(r){return e.get("/api/categorias/"+r)},create:function(r){return e({data:r,method:"POST",url:"/api/necesidades"})}}}])}(),function(){"use strict";angular.module("app.necesidad.nueva",[]).controller("NuevaNecesidadCtrl",["Necesidad","ngNotify","$window",function(e,r,t){var n=this;n.NecesidadForm={},n.create=function(){e.create(n.NecesidadForm).success(function(e){r.set(e,"success"),t.location="#/necesidad/"+e}).error(function(e){r.set(e,"error")})}}])}(),angular.module("app.directives",[]).directive("money",function(){function e(e,t,n,a){function i(e){var r=Math.pow(10,l);return Math.round(e*r)/r}function o(e){return parseFloat(e).toFixed(l)}function s(e){return a.$isEmpty(e)?"":""+e}var c,u=parseFloat(n.min||0),l=parseFloat(n.precision||2);a.$parsers.push(function(e){angular.isUndefined(e)&&(e=""),0===e.indexOf(".")&&(e="0"+e),0===e.indexOf("-")&&(u>=0?(e=null,a.$setViewValue(""),a.$render()):"-"===e&&(e=""));var t=a.$isEmpty(e);return t||r.test(e)?c=""===e?null:t?e:parseFloat(e):(a.$setViewValue(s(c)),a.$render()),a.$setValidity("number",!0),c}),a.$formatters.push(s);var d=function(e){return!a.$isEmpty(e)&&u>e?void a.$setValidity("min",!1):(a.$setValidity("min",!0),e)};if(a.$parsers.push(d),a.$formatters.push(d),n.max){var p=parseFloat(n.max),f=function(e){return!a.$isEmpty(e)&&e>p?void a.$setValidity("max",!1):(a.$setValidity("max",!0),e)};a.$parsers.push(f),a.$formatters.push(f)}l>-1&&(a.$parsers.push(function(e){return e?i(e):e}),a.$formatters.push(function(e){return e?o(e):e})),t.bind("blur",function(){var e=a.$modelValue;e&&(a.$viewValue=o(e),a.$render())})}var r=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/;return{restrict:"A",require:"ngModel",link:e}}).directive("numbersOnly",function(){return{restrict:"A",require:"ngModel",link:function(e,r,t,n){n.$parsers.push(function(e){if(void 0===e)return"";var r=e.replace(/[^0-9+.]/g,"");return r!==e&&(n.$setViewValue(r),n.$render()),r})}}}),angular.module("app.filters",[]).filter("dinero",["$filter","$locale",function(e,r){var t=e("currency"),n=r.NUMBER_FORMATS;return function(e,r,a){0===r&&(r=-1);var i=t(e,a),o=i.indexOf(n.DECIMAL_SEP)+1,s="";return o<i.indexOf(n.CURRENCY_SYM)&&(s=" "+n.CURRENCY_SYM),i.substring(0,o+r)+s}}]),function(){"use strict";angular.module("app.main",["app.directives","app.filters"]).controller("MainController",["$rootScope","$scope",function(e,r){r.userAgent=navigator.userAgent,e.$on("$routeChangeStart",function(){e.loading=!0}),e.$on("$routeChangeSuccess",function(){e.loading=!1}),r.bottomReached=function(){alert("Congrats you scrolled to the end of the list!")},r.notices=[];for(var t=0;10>t;t++)r.notices.push({icon:"envelope",message:"Notice "+(t+1)});r.deleteNotice=function(e){var t=r.notices.indexOf(e);t>-1&&r.notices.splice(t,1)}}])}(),function(){"use strict";angular.module("app.users",["app.users.service"]).controller("UserCtrl",["$scope","User",function(e,r){r.one("profile").get().then(function(r){e.FormUser=r})["catch"](function(e){alert(e.data)}),e.updateProfile=function(){e.FormUser.put()["catch"](function(e){alert(e.data)})}}])}(),function(){"use strict";angular.module("app.users.service",[]).factory("User",["$http",function(e){return{all:Restangular.all("api/users"),one:function(e){return Restangular.one("api/users",e)}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImhvbWUvaG9tZS5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL2NhdGVnb3JpYS5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL2RldGFsbGUuY29udHJvbGxlci5qcyIsIm5lY2VzaWRhZC9uZWNlc2lkYWQuY29udHJvbGxlci5qcyIsIm5lY2VzaWRhZC9uZWNlc2lkYWQuc2VydmljZS5qcyIsIm5lY2VzaWRhZC9udWV2YS5jb250cm9sbGVyLmpzIiwic2hhcmVkL2RpcmVjdGl2ZXMuanMiLCJzaGFyZWQvZmlsdGVycy5qcyIsInNoYXJlZC9tYWluLmpzIiwidXNlcnMvY29udHJvbGxlci5qcyIsInVzZXJzL3NlcnZpY2UuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiR0cmFuc2Zvcm0iLCJ3aW5kb3ciLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInJlbG9hZE9uU2VhcmNoIiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJOZWNlc2lkYWQiLCJuZ05vdGlmeSIsInZtIiwidGhpcyIsImxvYWQiLCJzdWNjZXNzIiwiZGF0YSIsIm5lY2VzaWRhZGVzIiwiZXJyb3IiLCJlcnIiLCJzZXQiLCIkcm91dGVQYXJhbXMiLCJjYXRlZ29yaWEiLCJjb25zb2xlIiwiaWQiLCJzaG93IiwibmVjZXNpZGFkIiwiZmFjdG9yeSIsIiRodHRwIiwiY2FsbGJhY2siLCJnZXQiLCJjbGF2ZSIsImNyZWF0ZSIsIm1ldGhvZCIsInVybCIsIiR3aW5kb3ciLCJOZWNlc2lkYWRGb3JtIiwibG9jYXRpb24iLCJkaXJlY3RpdmUiLCJsaW5rIiwic2NvcGUiLCJlbCIsImF0dHJzIiwibmdNb2RlbEN0cmwiLCJyb3VuZCIsIm51bSIsImQiLCJNYXRoIiwicG93IiwicHJlY2lzaW9uIiwiZm9ybWF0UHJlY2lzaW9uIiwidmFsdWUiLCJwYXJzZUZsb2F0IiwidG9GaXhlZCIsImZvcm1hdFZpZXdWYWx1ZSIsIiRpc0VtcHR5IiwibGFzdFZhbGlkVmFsdWUiLCJtaW4iLCIkcGFyc2VycyIsInB1c2giLCJpc1VuZGVmaW5lZCIsImluZGV4T2YiLCIkc2V0Vmlld1ZhbHVlIiwiJHJlbmRlciIsImVtcHR5IiwiTlVNQkVSX1JFR0VYUCIsInRlc3QiLCIkc2V0VmFsaWRpdHkiLCIkZm9ybWF0dGVycyIsIm1pblZhbGlkYXRvciIsIm1heCIsIm1heFZhbGlkYXRvciIsImJpbmQiLCIkbW9kZWxWYWx1ZSIsIiR2aWV3VmFsdWUiLCJyZXN0cmljdCIsInJlcXVpcmUiLCJlbGVtZW50IiwibW9kZWxDdHJsIiwiaW5wdXRWYWx1ZSIsInVuZGVmaW5lZCIsInRyYW5zZm9ybWVkSW5wdXQiLCJyZXBsYWNlIiwiZmlsdGVyIiwibG9jYWxlIiwiY3VycmVuY3lGaWx0ZXIiLCJmb3JtYXRzIiwiTlVNQkVSX0ZPUk1BVFMiLCJhbW91bnQiLCJjdXJyZW5jeVN5bWJvbCIsInNlcCIsIkRFQ0lNQUxfU0VQIiwic3ltYm9sIiwiQ1VSUkVOQ1lfU1lNIiwic3Vic3RyaW5nIiwiJHJvb3RTY29wZSIsIiRzY29wZSIsInVzZXJBZ2VudCIsIm5hdmlnYXRvciIsIiRvbiIsImxvYWRpbmciLCJib3R0b21SZWFjaGVkIiwiYWxlcnQiLCJub3RpY2VzIiwiaiIsImljb24iLCJtZXNzYWdlIiwiZGVsZXRlTm90aWNlIiwibm90aWNlIiwiaW5kZXgiLCJzcGxpY2UiLCJVc2VyIiwib25lIiwidGhlbiIsIkZvcm1Vc2VyIiwidXBkYXRlUHJvZmlsZSIsInB1dCIsImFsbCIsIlJlc3Rhbmd1bGFyIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBLFlBRUFBLFNBQ0FDLE9BQUEsT0FDQSxVQUNBLG9CQUNBLFdBQ0EsV0FDQSxXQUNBLGdCQU9BLCtCQUVBQyxLQUFBLGFBQUEsU0FBQUMsR0FDQUMsT0FBQUQsV0FBQUEsS0FFQUUsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxLQUFBLEtBQ0FDLFlBQUEseUJBQ0FDLGdCQUFBLElBRUFGLEtBQUEsS0FDQUMsWUFBQSwyQkFDQUMsZ0JBQUEsRUFDQUMsV0FBQSxXQUNBQyxhQUFBLGFBRUFKLEtBQUEsa0JBQ0FDLFlBQUEsaUNBQ0FDLGdCQUFBLEVBQ0FDLFdBQUEsdUJBQ0FDLGFBQUEsZ0JBRUFKLEtBQUEseUJBQ0FDLFlBQUEsbUNBQ0FDLGdCQUFBLEVBQ0FDLFdBQUEsZ0JBQ0FDLGFBQUEsa0JBR0FDLFdBQ0FDLFdBQUEsWUNoREEsV0FDQSxZQUNBYixTQUNBQyxPQUFBLGVBQ0FTLFdBQUEsWUFBQSxZQUFBLFdBQUEsU0FBQUksRUFBQUMsR0FFQSxHQUFBQyxHQUFBQyxJQUVBSCxHQUFBSSxPQUNBQyxRQUFBLFNBQUFDLEdBQ0FKLEVBQUFLLFlBQUFELElBRUFFLE1BQUEsU0FBQUMsR0FDQVIsRUFBQVMsSUFBQUQsRUFBQSxpQkNiQSxXQUNBLFlBQ0F2QixTQUNBQyxPQUFBLDhCQUNBUyxXQUFBLGlCQUFBLFlBQUEsZUFBQSxTQUFBSSxFQUFBVyxHQUVBLEdBQUFULEdBQUFDLElBSUFILEdBQUFZLFVBQUFELEVBQUFDLFdBQ0FQLFFBQUEsU0FBQUMsR0FDQUosRUFBQUssWUFBQUQsRUFBQUMsWUFDQUwsRUFBQVUsVUFBQU4sRUFBQU0sWUFFQUosTUFBQSxTQUFBQyxHQUNBSSxRQUFBTCxNQUFBQyxXQ2hCQSxXQUNBLFlBQ0F2QixTQUNBQyxPQUFBLDRCQUNBUyxXQUFBLHdCQUFBLFlBQUEsV0FBQSxlQUFBLFNBQUFJLEVBQUFDLEVBQUFVLEdBRUEsR0FBQVQsR0FBQUMsSUFFQVEsR0FBQUcsSUFDQWQsRUFBQWUsS0FBQUosRUFBQUcsSUFDQVQsUUFBQSxTQUFBQyxHQUNBSixFQUFBYyxVQUFBVixJQUVBRSxNQUFBLFNBQUFDLEdBQ0FSLEVBQUFTLElBQUFELEVBQUEsaUJDZEEsV0FDQSxZQUNBdkIsU0FDQUMsT0FBQSxpQkFDQSx3QkFDQSxzQkFDQSx3QkFDQSw0QkFFQVMsV0FBQSxtQkFBQSxZQUFBLFdBQUEsU0FBQUksRUFBQUMsR0FFQSxHQUFBQyxHQUFBQyxJQUVBSCxHQUFBSSxPQUNBQyxRQUFBLFNBQUFDLEdBQ0FKLEVBQUFLLFlBQUFELElBRUFFLE1BQUEsU0FBQUMsR0FDQVIsRUFBQVMsSUFBQUQsRUFBQSxpQkNsQkEsV0FDQSxZQUNBdkIsU0FDQUMsT0FBQSw0QkFDQThCLFFBQUEsYUFBQSxRQUFBLFNBQUFDLEdBRUEsT0FDQWQsS0FBQSxTQUFBZSxHQUNBLE1BQUFELEdBQUFFLElBQUEscUJBRUFMLEtBQUEsU0FBQUQsR0FDQSxNQUFBSSxHQUFBRSxJQUFBLG9CQUFBTixJQUVBRixVQUFBLFNBQUFTLEdBQ0EsTUFBQUgsR0FBQUUsSUFBQSxtQkFBQUMsSUFFQUMsT0FBQSxTQUFBaEIsR0FDQSxNQUFBWSxJQUNBWixLQUFBQSxFQUNBaUIsT0FBQSxPQUNBQyxJQUFBLDZCQ3BCQSxXQUNBLFlBQ0F0QyxTQUNBQyxPQUFBLDBCQUNBUyxXQUFBLHNCQUFBLFlBQUEsV0FBQSxVQUFBLFNBQUFJLEVBQUFDLEVBQUF3QixHQUdBLEdBQUF2QixHQUFBQyxJQUNBRCxHQUFBd0IsaUJBRUF4QixFQUFBb0IsT0FBQSxXQUNBdEIsRUFBQXNCLE9BQUFwQixFQUFBd0IsZUFDQXJCLFFBQUEsU0FBQUMsR0FDQUwsRUFBQVMsSUFBQUosRUFBQSxXQUNBbUIsRUFBQUUsU0FBQSxlQUFBckIsSUFFQUUsTUFBQSxTQUFBQyxHQUNBUixFQUFBUyxJQUFBRCxFQUFBLGtCQ2hCQXZCLFFBQUFDLE9BQUEscUJBQ0F5QyxVQUFBLFFBQUEsV0FJQSxRQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUtBLFFBQUFDLEdBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsS0FBQUMsSUFBQSxHQUFBQyxFQUNBLE9BQUFGLE1BQUFILE1BQUFDLEVBQUFDLEdBQUFBLEVBR0EsUUFBQUksR0FBQUMsR0FDQSxNQUFBQyxZQUFBRCxHQUFBRSxRQUFBSixHQUdBLFFBQUFLLEdBQUFILEdBQ0EsTUFBQVIsR0FBQVksU0FBQUosR0FBQSxHQUFBLEdBQUFBLEVBZEEsR0FFQUssR0FGQUMsRUFBQUwsV0FBQVYsRUFBQWUsS0FBQSxHQUNBUixFQUFBRyxXQUFBVixFQUFBTyxXQUFBLEVBaUJBTixHQUFBZSxTQUFBQyxLQUFBLFNBQUFSLEdBQ0F2RCxRQUFBZ0UsWUFBQVQsS0FDQUEsRUFBQSxJQUlBLElBQUFBLEVBQUFVLFFBQUEsT0FDQVYsRUFBQSxJQUFBQSxHQUlBLElBQUFBLEVBQUFVLFFBQUEsT0FDQUosR0FBQSxHQUNBTixFQUFBLEtBQ0FSLEVBQUFtQixjQUFBLElBQ0FuQixFQUFBb0IsV0FDQSxNQUFBWixJQUNBQSxFQUFBLElBSUEsSUFBQWEsR0FBQXJCLEVBQUFZLFNBQUFKLEVBWUEsT0FYQWEsSUFBQUMsRUFBQUMsS0FBQWYsR0FDQUssRUFBQSxLQUFBTCxFQUNBLEtBQ0FhLEVBQUFiLEVBQUFDLFdBQUFELElBR0FSLEVBQUFtQixjQUFBUixFQUFBRSxJQUNBYixFQUFBb0IsV0FHQXBCLEVBQUF3QixhQUFBLFVBQUEsR0FDQVgsSUFFQWIsRUFBQXlCLFlBQUFULEtBQUFMLEVBRUEsSUFBQWUsR0FBQSxTQUFBbEIsR0FDQSxPQUFBUixFQUFBWSxTQUFBSixJQUFBTSxFQUFBTixNQUNBUixHQUFBd0IsYUFBQSxPQUFBLElBR0F4QixFQUFBd0IsYUFBQSxPQUFBLEdBQ0FoQixHQU1BLElBSEFSLEVBQUFlLFNBQUFDLEtBQUFVLEdBQ0ExQixFQUFBeUIsWUFBQVQsS0FBQVUsR0FFQTNCLEVBQUE0QixJQUFBLENBQ0EsR0FBQUEsR0FBQWxCLFdBQUFWLEVBQUE0QixLQUNBQyxFQUFBLFNBQUFwQixHQUNBLE9BQUFSLEVBQUFZLFNBQUFKLElBQUFBLEVBQUFtQixNQUNBM0IsR0FBQXdCLGFBQUEsT0FBQSxJQUdBeEIsRUFBQXdCLGFBQUEsT0FBQSxHQUNBaEIsR0FJQVIsR0FBQWUsU0FBQUMsS0FBQVksR0FDQTVCLEVBQUF5QixZQUFBVCxLQUFBWSxHQUlBdEIsRUFBQSxLQUNBTixFQUFBZSxTQUFBQyxLQUFBLFNBQUFSLEdBQ0EsTUFBQUEsR0FBQVAsRUFBQU8sR0FBQUEsSUFFQVIsRUFBQXlCLFlBQUFULEtBQUEsU0FBQVIsR0FDQSxNQUFBQSxHQUFBRCxFQUFBQyxHQUFBQSxLQUlBVixFQUFBK0IsS0FBQSxPQUFBLFdBQ0EsR0FBQXJCLEdBQUFSLEVBQUE4QixXQUNBdEIsS0FDQVIsRUFBQStCLFdBQUF4QixFQUFBQyxHQUNBUixFQUFBb0IsYUFwR0EsR0FBQUUsR0FBQSxvQ0F5R0EsUUFDQVUsU0FBQSxJQUNBQyxRQUFBLFVBQ0FyQyxLQUFBQSxLQUVBRCxVQUFBLGNBQUEsV0FDQSxPQUNBcUMsU0FBQSxJQUNBQyxRQUFBLFVBQ0FyQyxLQUFBLFNBQUFDLEVBQUFxQyxFQUFBbkMsRUFBQW9DLEdBQ0FBLEVBQUFwQixTQUFBQyxLQUFBLFNBQUFvQixHQUlBLEdBQUFDLFNBQUFELEVBQUEsTUFBQSxFQUNBLElBQUFFLEdBQUFGLEVBQUFHLFFBQUEsWUFBQSxHQU1BLE9BTEFELEtBQUFGLElBQ0FELEVBQUFoQixjQUFBbUIsR0FDQUgsRUFBQWYsV0FHQWtCLFFDbElBckYsUUFBQUMsT0FBQSxrQkFDQXNGLE9BQUEsVUFDQSxVQUFBLFVBQUEsU0FBQUEsRUFBQUMsR0FDQSxHQUFBQyxHQUFBRixFQUFBLFlBQ0FHLEVBQUFGLEVBQUFHLGNBQ0EsT0FBQSxVQUFBQyxFQUFBM0MsRUFBQTRDLEdBQ0EsSUFBQTVDLElBQUFBLEVBQUEsR0FDQSxJQUFBTSxHQUFBa0MsRUFBQUcsRUFBQUMsR0FDQUMsRUFBQXZDLEVBQUFVLFFBQUF5QixFQUFBSyxhQUFBLEVBQ0FDLEVBQUEsRUFFQSxPQURBRixHQUFBdkMsRUFBQVUsUUFBQXlCLEVBQUFPLGdCQUFBRCxFQUFBLElBQUFOLEVBQUFPLGNBQ0ExQyxFQUFBMkMsVUFBQSxFQUFBSixFQUFBN0MsR0FBQStDLE1DWEEsV0FDQSxZQUNBaEcsU0FDQUMsT0FBQSxZQUNBLGlCQUNBLGdCQUVBUyxXQUFBLGtCQUFBLGFBQUEsU0FBQSxTQUFBeUYsRUFBQUMsR0FLQUEsRUFBQUMsVUFBQUMsVUFBQUQsVUFHQUYsRUFBQUksSUFBQSxvQkFBQSxXQUNBSixFQUFBSyxTQUFBLElBR0FMLEVBQUFJLElBQUEsc0JBQUEsV0FDQUosRUFBQUssU0FBQSxJQUtBSixFQUFBSyxjQUFBLFdBRUFDLE1BQUEsa0RBT0FOLEVBQUFPLFVBRUEsS0FBQSxHQUFBQyxHQUFBLEVBQUEsR0FBQUEsRUFBQUEsSUFDQVIsRUFBQU8sUUFBQTVDLE1BQUE4QyxLQUFBLFdBQUFDLFFBQUEsV0FBQUYsRUFBQSxJQUdBUixHQUFBVyxhQUFBLFNBQUFDLEdBQ0EsR0FBQUMsR0FBQWIsRUFBQU8sUUFBQTFDLFFBQUErQyxFQUNBQyxHQUFBLElBQ0FiLEVBQUFPLFFBQUFPLE9BQUFELEVBQUEsVUMzQ0EsV0FDQSxZQUNBakgsU0FBQUMsT0FBQSxhQUFBLHNCQUNBUyxXQUFBLFlBQUEsU0FBQSxPQUFBLFNBQUEwRixFQUFBZSxHQUVBQSxFQUFBQyxJQUFBLFdBQUFsRixNQUNBbUYsS0FBQSxTQUFBakcsR0FDQWdGLEVBQUFrQixTQUFBbEcsSUFGQStGLFNBSUEsU0FBQTVGLEdBQ0FtRixNQUFBbkYsRUFBQUgsUUFHQWdGLEVBQUFtQixjQUFBLFdBQ0FuQixFQUFBa0IsU0FBQUUsTUFBQXBCLFNBQ0EsU0FBQTdFLEdBQ0FtRixNQUFBbkYsRUFBQUgsZUNoQkEsV0FDQSxZQUNBcEIsU0FDQUMsT0FBQSx3QkFFQThCLFFBQUEsUUFBQSxRQUFBLFNBQUFDLEdBRUEsT0FDQXlGLElBQUFDLFlBQUFELElBQUEsYUFDQUwsSUFBQSxTQUFBeEYsR0FDQSxNQUFBOEYsYUFBQU4sSUFBQSxZQUFBeEYiLCJmaWxlIjoiYnVpbGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcsIFtcbiAgICAgICduZ1JvdXRlJyxcbiAgICAgICdtb2JpbGUtYW5ndWxhci11aScsXG4gICAgICAnYXBwLm1haW4nLFxuICAgICAgJ2FwcC5ob21lJyxcbiAgICAgICduZ05vdGlmeScsXG4gICAgICAnYXBwLm5lY2VzaWRhZCcsXG4gICAgICAvLyB0b3VjaC9kcmFnIGZlYXR1cmU6IHRoaXMgaXMgZnJvbSAnbW9iaWxlLWFuZ3VsYXItdWkuZ2VzdHVyZXMuanMnXG4gICAgICAvLyBpdCBpcyBhdCBhIHZlcnkgYmVnaW5uaW5nIHN0YWdlLCBzbyBwbGVhc2UgYmUgY2FyZWZ1bCBpZiB5b3UgbGlrZSB0byB1c2VcbiAgICAgIC8vIGluIHByb2R1Y3Rpb24uIFRoaXMgaXMgaW50ZW5kZWQgdG8gcHJvdmlkZSBhIGZsZXhpYmxlLCBpbnRlZ3JhdGVkIGFuZCBhbmRcbiAgICAgIC8vIGVhc3kgdG8gdXNlIGFsdGVybmF0aXZlIHRvIG90aGVyIDNyZCBwYXJ0eSBsaWJzIGxpa2UgaGFtbWVyLmpzLCB3aXRoIHRoZVxuICAgICAgLy8gZmluYWwgcG91cnBvc2UgdG8gaW50ZWdyYXRlIGdlc3R1cmVzIGludG8gZGVmYXVsdCB1aSBpbnRlcmFjdGlvbnMgbGlrZVxuICAgICAgLy8gb3BlbmluZyBzaWRlYmFycywgdHVybmluZyBzd2l0Y2hlcyBvbi9vZmYgLi5cbiAgICAgICdtb2JpbGUtYW5ndWxhci11aS5nZXN0dXJlcydcbiAgICBdKVxuICAgIC5ydW4oWyckdHJhbnNmb3JtJyxmdW5jdGlvbigkdHJhbnNmb3JtKSB7XG4gICAgICB3aW5kb3cuJHRyYW5zZm9ybSA9ICR0cmFuc2Zvcm07XG4gICAgfV0pXG4gICAgLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJyxmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAgICRyb3V0ZVByb3ZpZGVyXG4gICAgICAgIC53aGVuKCcvJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9ob21lL2hvbWUuaHRtbCcsXG4gICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9ob21lL3Njcm9sbC5odG1sJyxcbiAgICAgICAgICByZWxvYWRPblNlYXJjaDogZmFsc2UsXG4gICAgICAgICAgY29udHJvbGxlcjonSG9tZUN0cmwnLFxuICAgICAgICAgIGNvbnRyb2xsZXJBczonSG9tZUN0cmwnXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvbmVjZXNpZGFkLzppZCcsIHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvbmVjZXNpZGFkL2RldGFsbGUuaHRtbCcsXG4gICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlLFxuICAgICAgICAgIGNvbnRyb2xsZXI6J05lY2VzaWRhZERldGFsbGVDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0RldGFsbGVDdHJsJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2NhdGVnb3JpYS86Y2F0ZWdvcmlhJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9uZWNlc2lkYWQvY2F0ZWdvcmlhLmh0bWwnLFxuICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZSxcbiAgICAgICAgICBjb250cm9sbGVyOidDYXRlZ29yaWFDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0NhdGVnb3JpYUN0cmwnXG4gICAgICAgIH0pXG5cbiAgICAgICAgLm90aGVyd2lzZSh7XG4gICAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG4gICAgLy8gYXBwLmRpcmVjdGl2ZSgndG91Y2hhcmVhJywgWyckdG91Y2gnLCBmdW5jdGlvbigkdG91Y2gpe1xuICAgIC8vICAgLy8gUnVucyBkdXJpbmcgY29tcGlsZVxuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAvLyAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCBlbGVtKSB7XG4gICAgLy8gICAgICAgJHNjb3BlLnRvdWNoID0gbnVsbDtcbiAgICAvLyAgICAgICAkdG91Y2guYmluZChlbGVtLCB7XG4gICAgLy8gICAgICAgICBzdGFydDogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH0sXG4gICAgLy9cbiAgICAvLyAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH0sXG4gICAgLy9cbiAgICAvLyAgICAgICAgIG1vdmU6IGZ1bmN0aW9uKHRvdWNoKSB7XG4gICAgLy8gICAgICAgICAgICRzY29wZS50b3VjaCA9IHRvdWNoO1xuICAgIC8vICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgLy8gICAgICAgICB9LFxuICAgIC8vXG4gICAgLy8gICAgICAgICBlbmQ6IGZ1bmN0aW9uKHRvdWNoKSB7XG4gICAgLy8gICAgICAgICAgICRzY29wZS50b3VjaCA9IHRvdWNoO1xuICAgIC8vICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgICAgfSk7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH07XG4gICAgLy8gfV0pO1xuICAgIC8vXG4gICAgLy8gLy9cbiAgICAvLyAvLyBgJGRyYWdgIGV4YW1wbGU6IGRyYWcgdG8gZGlzbWlzc1xuICAgIC8vIC8vXG4gICAgLy8gYXBwLmRpcmVjdGl2ZSgnZHJhZ1RvRGlzbWlzcycsIGZ1bmN0aW9uKCRkcmFnLCAkcGFyc2UsICR0aW1lb3V0KXtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHJlc3RyaWN0OiAnQScsXG4gICAgLy8gICAgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsZW0sIGF0dHJzKSB7XG4gICAgLy8gICAgICAgdmFyIGRpc21pc3NGbiA9ICRwYXJzZShhdHRycy5kcmFnVG9EaXNtaXNzKTtcbiAgICAvLyAgICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0pe1xuICAgIC8vICAgICAgICAgdmFyIGRpc21pc3MgPSBmYWxzZTtcbiAgICAvL1xuICAgIC8vICAgICAgICAgJGRyYWcuYmluZChlbGVtLCB7XG4gICAgLy8gICAgICAgICAgIHRyYW5zZm9ybTogJGRyYWcuVFJBTlNMQVRFX1JJR0hULFxuICAgIC8vICAgICAgICAgICBtb3ZlOiBmdW5jdGlvbihkcmFnKSB7XG4gICAgLy8gICAgICAgICAgICAgaWYoIGRyYWcuZGlzdGFuY2VYID49IGRyYWcucmVjdC53aWR0aCAvIDQpIHtcbiAgICAvLyAgICAgICAgICAgICAgIGRpc21pc3MgPSB0cnVlO1xuICAgIC8vICAgICAgICAgICAgICAgZWxlbS5hZGRDbGFzcygnZGlzbWlzcycpO1xuICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICAgICAgICBkaXNtaXNzID0gZmFsc2U7XG4gICAgLy8gICAgICAgICAgICAgICBlbGVtLnJlbW92ZUNsYXNzKCdkaXNtaXNzJyk7XG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgICB9LFxuICAgIC8vICAgICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICAgICAgZWxlbS5yZW1vdmVDbGFzcygnZGlzbWlzcycpO1xuICAgIC8vICAgICAgICAgICB9LFxuICAgIC8vICAgICAgICAgICBlbmQ6IGZ1bmN0aW9uKGRyYWcpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiAoZGlzbWlzcykge1xuICAgIC8vICAgICAgICAgICAgICAgZWxlbS5hZGRDbGFzcygnZGlzbWl0dGVkJyk7XG4gICAgLy8gICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgIC8vICAgICAgICAgICAgICAgICAgIGRpc21pc3NGbihzY29wZSk7XG4gICAgLy8gICAgICAgICAgICAgICAgIH0pO1xuICAgIC8vICAgICAgICAgICAgICAgfSwgMzAwKTtcbiAgICAvLyAgICAgICAgICAgICB9IGVsc2Uge1xuICAgIC8vICAgICAgICAgICAgICAgZHJhZy5yZXNldCgpO1xuICAgIC8vICAgICAgICAgICAgIH1cbiAgICAvLyAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgfSk7XG4gICAgLy8gICAgICAgfTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9KTtcbiAgICAvL1xuICAgIC8vIC8vXG4gICAgLy8gLy8gQW5vdGhlciBgJGRyYWdgIHVzYWdlIGV4YW1wbGU6IHRoaXMgaXMgaG93IHlvdSBjb3VsZCBjcmVhdGVcbiAgICAvLyAvLyBhIHRvdWNoIGVuYWJsZWQgXCJkZWNrIG9mIGNhcmRzXCIgY2Fyb3VzZWwuIFNlZSBgY2Fyb3VzZWwuaHRtbGAgZm9yIG1hcmt1cC5cbiAgICAvLyAvL1xuICAgIC8vIGFwcC5kaXJlY3RpdmUoJ2Nhcm91c2VsJywgZnVuY3Rpb24oKXtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHJlc3RyaWN0OiAnQycsXG4gICAgLy8gICAgIHNjb3BlOiB7fSxcbiAgICAvLyAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgICAgdGhpcy5pdGVtQ291bnQgPSAwO1xuICAgIC8vICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IG51bGw7XG4gICAgLy9cbiAgICAvLyAgICAgICB0aGlzLmFkZEl0ZW0gPSBmdW5jdGlvbigpe1xuICAgIC8vICAgICAgICAgdmFyIG5ld0lkID0gdGhpcy5pdGVtQ291bnQrKztcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuaXRlbUNvdW50ID09PSAxID8gbmV3SWQgOiB0aGlzLmFjdGl2ZUl0ZW07XG4gICAgLy8gICAgICAgICByZXR1cm4gbmV3SWQ7XG4gICAgLy8gICAgICAgfTtcbiAgICAvL1xuICAgIC8vICAgICAgIHRoaXMubmV4dCA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSB0aGlzLmFjdGl2ZUl0ZW0gfHwgMDtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSA9PT0gdGhpcy5pdGVtQ291bnQgLSAxID8gMCA6IHRoaXMuYWN0aXZlSXRlbSArIDE7XG4gICAgLy8gICAgICAgfTtcbiAgICAvL1xuICAgIC8vICAgICAgIHRoaXMucHJldiA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSB0aGlzLmFjdGl2ZUl0ZW0gfHwgMDtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSA9PT0gMCA/IHRoaXMuaXRlbUNvdW50IC0gMSA6IHRoaXMuYWN0aXZlSXRlbSAtIDE7XG4gICAgLy8gICAgICAgfTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9KTtcblxuXG5cbiAgICAvL1xuICAgIC8vIEZvciB0aGlzIHRyaXZpYWwgZGVtbyB3ZSBoYXZlIGp1c3QgYSB1bmlxdWUgTWFpbkNvbnRyb2xsZXJcbiAgICAvLyBmb3IgZXZlcnl0aGluZ1xuICAgIC8vXG4gICAgLy8gYXBwLmNvbnRyb2xsZXIoJ01haW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlKXtcbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLnN3aXBlZCA9IGZ1bmN0aW9uKGRpcmVjdGlvbikge1xuICAgIC8vICAgICBhbGVydCgnU3dpcGVkICcgKyBkaXJlY3Rpb24pO1xuICAgIC8vICAgfTtcbiAgICAvL1xuICAgIC8vICAgLy8gVXNlciBhZ2VudCBkaXNwbGF5ZWQgaW4gaG9tZSBwYWdlXG4gICAgLy8gICAkc2NvcGUudXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICAvL1xuICAgIC8vICAgLy8gTmVlZGVkIGZvciB0aGUgbG9hZGluZyBzY3JlZW5cbiAgICAvLyAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICRyb290U2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgLy8gICB9KTtcbiAgICAvL1xuICAgIC8vICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpe1xuICAgIC8vICAgICAkcm9vdFNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAvLyAgIH0pO1xuICAgIC8vXG4gICAgLy8gICAvLyBGYWtlIHRleHQgaSB1c2VkIGhlcmUgYW5kIHRoZXJlLlxuICAgIC8vICAgJHNjb3BlLmxvcmVtID0gJ0xvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNpY2luZyBlbGl0LiBWZWwgZXhwbGljYWJvLCBhbGlxdWlkIGVhcXVlIHNvbHV0YSBuaWhpbCBlbGlnZW5kaSBhZGlwaXNjaSBlcnJvciwgaWxsdW0gY29ycnVwdGkgbmFtIGZ1Z2Egb21uaXMgcXVvZCBxdWFlcmF0IG1vbGxpdGlhIGV4cGVkaXRhIGltcGVkaXQgZG9sb3JlcyBpcHNhbS4gT2JjYWVjYXRpLic7XG4gICAgLy9cbiAgICAvLyAgIC8vXG4gICAgLy8gICAvLyAnU2Nyb2xsJyBzY3JlZW5cbiAgICAvLyAgIC8vXG4gICAgLy8gICB2YXIgc2Nyb2xsSXRlbXMgPSBbXTtcbiAgICAvL1xuICAgIC8vICAgZm9yICh2YXIgaT0xOyBpPD0xMDA7IGkrKykge1xuICAgIC8vICAgICBzY3JvbGxJdGVtcy5wdXNoKCdJdGVtICcgKyBpKTtcbiAgICAvLyAgIH1cbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLnNjcm9sbEl0ZW1zID0gc2Nyb2xsSXRlbXM7XG4gICAgLy9cbiAgICAvLyAgICRzY29wZS5ib3R0b21SZWFjaGVkID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgIC8qIGdsb2JhbCBhbGVydDogZmFsc2U7ICovXG4gICAgLy8gICAgIGFsZXJ0KCdDb25ncmF0cyB5b3Ugc2Nyb2xsZWQgdG8gdGhlIGVuZCBvZiB0aGUgbGlzdCEnKTtcbiAgICAvLyAgIH07XG4gICAgLy9cbiAgICAvLyAgIC8vXG4gICAgLy8gICAvLyBSaWdodCBTaWRlYmFyXG4gICAgLy8gICAvL1xuICAgIC8vICAgJHNjb3BlLmNoYXRVc2VycyA9IFtcbiAgICAvLyAgICAgeyBuYW1lOiAnQ2FybG9zICBGbG93ZXJzJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0J5cm9uIFRheWxvcicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKYW5hICBUZXJyeScsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdEYXJyeWwgIFN0b25lJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0Zhbm5pZSAgQ2FybHNvbicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdIb2xseSBOZ3V5ZW4nLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQmlsbCAgQ2hhdmV6Jywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ1Zlcm9uaWNhICBNYXh3ZWxsJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0plc3NpY2EgV2Vic3RlcicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKYWNraWUgIEJhcnRvbicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdDcnlzdGFsIERyYWtlJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdNaWx0b24gIERlYW4nLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0pvYW5uIEpvaG5zdG9uJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdDb3JhICBWYXVnaG4nLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ05pbmEgIEJyaWdncycsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQ2FzZXkgVHVybmVyJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKaW1taWUgIFdpbHNvbicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnTmF0aGFuaWVsIFN0ZWVsZScsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQXVicmV5ICBDb2xlJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdEb25uaWUgIFN1bW1lcnMnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0thdGUgIE15ZXJzJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdQcmlzY2lsbGEgSGF3a2lucycsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnSm9lIEJhcmtlcicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnTGVlIE5vcm1hbicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnRWJvbnkgUmljZScsIG9ubGluZTogZmFsc2UgfVxuICAgIC8vICAgXTtcbiAgICAvL1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vICdGb3Jtcycgc2NyZWVuXG4gICAgLy8gICAvL1xuICAgIC8vICAgJHNjb3BlLnJlbWVtYmVyTWUgPSB0cnVlO1xuICAgIC8vICAgJHNjb3BlLmVtYWlsID0gJ21lQGV4YW1wbGUuY29tJztcbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgIGFsZXJ0KCdZb3Ugc3VibWl0dGVkIHRoZSBsb2dpbiBmb3JtJyk7XG4gICAgLy8gICB9OyAgICBcbiAgICAvLyAgIC8vXG4gICAgLy8gICAvLyAnRHJhZycgc2NyZWVuXG4gICAgLy8gICAvL1xuICAgIC8vICAgJHNjb3BlLm5vdGljZXMgPSBbXTtcbiAgICAvL1xuICAgIC8vICAgZm9yICh2YXIgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgLy8gICAgICRzY29wZS5ub3RpY2VzLnB1c2goe2ljb246ICdlbnZlbG9wZScsIG1lc3NhZ2U6ICdOb3RpY2UgJyArIChqICsgMSkgfSk7XG4gICAgLy8gICB9XG4gICAgLy9cbiAgICAvLyAgICRzY29wZS5kZWxldGVOb3RpY2UgPSBmdW5jdGlvbihub3RpY2UpIHtcbiAgICAvLyAgICAgdmFyIGluZGV4ID0gJHNjb3BlLm5vdGljZXMuaW5kZXhPZihub3RpY2UpO1xuICAgIC8vICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgIC8vICAgICAgICRzY29wZS5ub3RpY2VzLnNwbGljZShpbmRleCwgMSk7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH07XG4gICAgLy8gfSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAuaG9tZScsW10pXG4gICAgICAuY29udHJvbGxlcignSG9tZUN0cmwnLFsnTmVjZXNpZGFkJywnbmdOb3RpZnknLGZ1bmN0aW9uIChOZWNlc2lkYWQsbmdOb3RpZnkpIHtcblxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIE5lY2VzaWRhZC5sb2FkKClcbiAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICB2bS5uZWNlc2lkYWRlcyA9IGRhdGE7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwgJ2Vycm9yJyk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAubmVjZXNpZGFkLmNhdGVnb3JpYScsW10pXG4gICAgICAuY29udHJvbGxlcignQ2F0ZWdvcmlhQ3RybCcsWydOZWNlc2lkYWQnLCckcm91dGVQYXJhbXMnLGZ1bmN0aW9uIChOZWNlc2lkYWQsJHJvdXRlUGFyYW1zKSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuXG5cbiAgICAgICAgTmVjZXNpZGFkLmNhdGVnb3JpYSgkcm91dGVQYXJhbXMuY2F0ZWdvcmlhKVxuICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2bS5uZWNlc2lkYWRlcyA9IGRhdGEubmVjZXNpZGFkZXM7XG4gICAgICAgICAgICB2bS5jYXRlZ29yaWEgPSBkYXRhLmNhdGVnb3JpYTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgfSk7XG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAubmVjZXNpZGFkLmRldGFsbGUnLFtdKVxuICAgICAgLmNvbnRyb2xsZXIoJ05lY2VzaWRhZERldGFsbGVDdHJsJyxbJ05lY2VzaWRhZCcsJ25nTm90aWZ5JywnJHJvdXRlUGFyYW1zJyxmdW5jdGlvbiAoTmVjZXNpZGFkLG5nTm90aWZ5LCRyb3V0ZVBhcmFtcykge1xuXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIFxuICAgICAgICBpZiAoJHJvdXRlUGFyYW1zLmlkKSB7XG4gICAgICAgICAgTmVjZXNpZGFkLnNob3coJHJvdXRlUGFyYW1zLmlkKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgdm0ubmVjZXNpZGFkID0gZGF0YTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuXG4gICAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLm5lY2VzaWRhZCcsW1xuICAgICAgJ2FwcC5uZWNlc2lkYWQuc2VydmljZScsXG4gICAgICAnYXBwLm5lY2VzaWRhZC5udWV2YScsXG4gICAgICAnYXBwLm5lY2VzaWRhZC5kZXRhbGxlJyxcbiAgICAgICdhcHAubmVjZXNpZGFkLmNhdGVnb3JpYSdcbiAgICBdKVxuICAgICAgLmNvbnRyb2xsZXIoJ05lY2VzaWRhZGVzQ3RybCcsWydOZWNlc2lkYWQnLCduZ05vdGlmeScsZnVuY3Rpb24gKE5lY2VzaWRhZCxuZ05vdGlmeSkge1xuXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgTmVjZXNpZGFkLmxvYWQoKVxuICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHZtLm5lY2VzaWRhZGVzID0gZGF0YTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCAnZXJyb3InKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5uZWNlc2lkYWQuc2VydmljZScsW10pXG4gICAgICAuZmFjdG9yeSgnTmVjZXNpZGFkJyxbJyRodHRwJyxmdW5jdGlvbiAoJGh0dHApIHtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGxvYWQ6ZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL25lY2VzaWRhZGVzJyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBzaG93OmZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9uZWNlc2lkYWRlcy8nICsgaWQpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY2F0ZWdvcmlhOmZ1bmN0aW9uIChjbGF2ZSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jYXRlZ29yaWFzLycgKyBjbGF2ZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBjcmVhdGU6ZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICAgIGRhdGEgICAgOiAgZGF0YSxcbiAgICAgICAgICAgICAgbWV0aG9kICA6ICdQT1NUJyxcbiAgICAgICAgICAgICAgdXJsICAgICA6ICcvYXBpL25lY2VzaWRhZGVzJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH1dKVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5uZWNlc2lkYWQubnVldmEnLFtdKVxuICAgICAgLmNvbnRyb2xsZXIoJ051ZXZhTmVjZXNpZGFkQ3RybCcsWydOZWNlc2lkYWQnLCduZ05vdGlmeScsJyR3aW5kb3cnLGZ1bmN0aW9uIChOZWNlc2lkYWQsbmdOb3RpZnksJHdpbmRvd1xuICAgICAgKSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uTmVjZXNpZGFkRm9ybSA9IHt9O1xuXG4gICAgICAgIHZtLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBOZWNlc2lkYWQuY3JlYXRlKHZtLk5lY2VzaWRhZEZvcm0pXG4gICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZGF0YSwnc3VjY2VzcycpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbiA9ICcjL25lY2VzaWRhZC8nICsgZGF0YTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnLCBbXSlcbiAgLmRpcmVjdGl2ZSgnbW9uZXknLCBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgTlVNQkVSX1JFR0VYUCA9IC9eXFxzKihcXC18XFwrKT8oXFxkK3woXFxkKihcXC5cXGQqKSkpXFxzKiQvO1xuXG4gICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWwsIGF0dHJzLCBuZ01vZGVsQ3RybCkge1xuICAgICAgdmFyIG1pbiA9IHBhcnNlRmxvYXQoYXR0cnMubWluIHx8IDApO1xuICAgICAgdmFyIHByZWNpc2lvbiA9IHBhcnNlRmxvYXQoYXR0cnMucHJlY2lzaW9uIHx8IDIpO1xuICAgICAgdmFyIGxhc3RWYWxpZFZhbHVlO1xuXG4gICAgICBmdW5jdGlvbiByb3VuZChudW0pIHtcbiAgICAgICAgdmFyIGQgPSBNYXRoLnBvdygxMCwgcHJlY2lzaW9uKTtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQobnVtICogZCkgLyBkO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBmb3JtYXRQcmVjaXNpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodmFsdWUpLnRvRml4ZWQocHJlY2lzaW9uKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZm9ybWF0Vmlld1ZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBuZ01vZGVsQ3RybC4kaXNFbXB0eSh2YWx1ZSkgPyAnJyA6ICcnICsgdmFsdWU7XG4gICAgICB9XG5cblxuICAgICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQodmFsdWUpKSB7XG4gICAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEhhbmRsZSBsZWFkaW5nIGRlY2ltYWwgcG9pbnQsIGxpa2UgXCIuNVwiXG4gICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCcuJykgPT09IDApIHtcbiAgICAgICAgICB2YWx1ZSA9ICcwJyArIHZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWxsb3cgXCItXCIgaW5wdXRzIG9ubHkgd2hlbiBtaW4gPCAwXG4gICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCctJykgPT09IDApIHtcbiAgICAgICAgICBpZiAobWluID49IDApIHtcbiAgICAgICAgICAgIHZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUoJycpO1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09ICctJykge1xuICAgICAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZW1wdHkgPSBuZ01vZGVsQ3RybC4kaXNFbXB0eSh2YWx1ZSk7XG4gICAgICAgIGlmIChlbXB0eSB8fCBOVU1CRVJfUkVHRVhQLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgbGFzdFZhbGlkVmFsdWUgPSAodmFsdWUgPT09ICcnKVxuICAgICAgICAgID8gbnVsbFxuICAgICAgICAgIDogKGVtcHR5ID8gdmFsdWUgOiBwYXJzZUZsb2F0KHZhbHVlKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gUmVuZGVyIHRoZSBsYXN0IHZhbGlkIGlucHV0IGluIHRoZSBmaWVsZFxuICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUoZm9ybWF0Vmlld1ZhbHVlKGxhc3RWYWxpZFZhbHVlKSk7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdudW1iZXInLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuIGxhc3RWYWxpZFZhbHVlO1xuICAgICAgfSk7XG4gICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKGZvcm1hdFZpZXdWYWx1ZSk7XG5cbiAgICAgIHZhciBtaW5WYWxpZGF0b3IgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBpZiAoIW5nTW9kZWxDdHJsLiRpc0VtcHR5KHZhbHVlKSAmJiB2YWx1ZSA8IG1pbikge1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgnbWluJywgZmFsc2UpO1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdtaW4nLCB0cnVlKTtcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKG1pblZhbGlkYXRvcik7XG4gICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKG1pblZhbGlkYXRvcik7XG5cbiAgICAgIGlmIChhdHRycy5tYXgpIHtcbiAgICAgICAgdmFyIG1heCA9IHBhcnNlRmxvYXQoYXR0cnMubWF4KTtcbiAgICAgICAgdmFyIG1heFZhbGlkYXRvciA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKCFuZ01vZGVsQ3RybC4kaXNFbXB0eSh2YWx1ZSkgJiYgdmFsdWUgPiBtYXgpIHtcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgnbWF4JywgZmFsc2UpO1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdtYXgnLCB0cnVlKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChtYXhWYWxpZGF0b3IpO1xuICAgICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKG1heFZhbGlkYXRvcik7XG4gICAgICB9XG5cbiAgICAgIC8vIFJvdW5kIG9mZlxuICAgICAgaWYgKHByZWNpc2lvbiA+IC0xKSB7XG4gICAgICAgIG5nTW9kZWxDdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlID8gcm91bmQodmFsdWUpIDogdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiB2YWx1ZSA/IGZvcm1hdFByZWNpc2lvbih2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGVsLmJpbmQoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IG5nTW9kZWxDdHJsLiRtb2RlbFZhbHVlO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlID0gZm9ybWF0UHJlY2lzaW9uKHZhbHVlKTtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgbGluazogbGlua1xuICAgIH07XG4gIH0pLmRpcmVjdGl2ZSgnbnVtYmVyc09ubHknLCBmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBtb2RlbEN0cmwpIHtcbiAgICAgICAgbW9kZWxDdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24gKGlucHV0VmFsdWUpIHtcbiAgICAgICAgICAvLyB0aGlzIG5leHQgaWYgaXMgbmVjZXNzYXJ5IGZvciB3aGVuIHVzaW5nIG5nLXJlcXVpcmVkIG9uIHlvdXIgaW5wdXQuXG4gICAgICAgICAgLy8gSW4gc3VjaCBjYXNlcywgd2hlbiBhIGxldHRlciBpcyB0eXBlZCBmaXJzdCwgdGhpcyBwYXJzZXIgd2lsbCBiZSBjYWxsZWRcbiAgICAgICAgICAvLyBhZ2FpbiwgYW5kIHRoZSAybmQgdGltZSwgdGhlIHZhbHVlIHdpbGwgYmUgdW5kZWZpbmVkXG4gICAgICAgICAgaWYgKGlucHV0VmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuICcnO1xuICAgICAgICAgIHZhciB0cmFuc2Zvcm1lZElucHV0ID0gaW5wdXRWYWx1ZS5yZXBsYWNlKC9bXjAtOSsuXS9nLCAnJyk7XG4gICAgICAgICAgaWYgKHRyYW5zZm9ybWVkSW5wdXQhPT1pbnB1dFZhbHVlKSB7XG4gICAgICAgICAgICBtb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSh0cmFuc2Zvcm1lZElucHV0KTtcbiAgICAgICAgICAgIG1vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkSW5wdXQ7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcC5maWx0ZXJzJyxbXSlcbiAgLmZpbHRlcignZGluZXJvJyxcbiAgWyAnJGZpbHRlcicsICckbG9jYWxlJywgZnVuY3Rpb24oZmlsdGVyLCBsb2NhbGUpIHtcbiAgICB2YXIgY3VycmVuY3lGaWx0ZXIgPSBmaWx0ZXIoJ2N1cnJlbmN5Jyk7XG4gICAgdmFyIGZvcm1hdHMgPSBsb2NhbGUuTlVNQkVSX0ZPUk1BVFM7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGFtb3VudCwgbnVtLCBjdXJyZW5jeVN5bWJvbCkge1xuICAgICAgaWYgKG51bT09PTApIG51bSA9IC0xO1xuICAgICAgdmFyIHZhbHVlID0gY3VycmVuY3lGaWx0ZXIoYW1vdW50LCBjdXJyZW5jeVN5bWJvbCk7XG4gICAgICB2YXIgc2VwID0gdmFsdWUuaW5kZXhPZihmb3JtYXRzLkRFQ0lNQUxfU0VQKSsxO1xuICAgICAgdmFyIHN5bWJvbCA9ICcnO1xuICAgICAgaWYgKHNlcDx2YWx1ZS5pbmRleE9mKGZvcm1hdHMuQ1VSUkVOQ1lfU1lNKSkgc3ltYm9sID0gJyAnK2Zvcm1hdHMuQ1VSUkVOQ1lfU1lNO1xuICAgICAgcmV0dXJuIHZhbHVlLnN1YnN0cmluZygwLCBzZXArbnVtKStzeW1ib2w7XG4gICAgfTtcbiAgfSBdKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgICBhbmd1bGFyXG4gICAgICAubW9kdWxlKCdhcHAubWFpbicsIFtcbiAgICAgICdhcHAuZGlyZWN0aXZlcycsXG4gICAgICAnYXBwLmZpbHRlcnMnXG4gICAgXSlcbiAgICAuY29udHJvbGxlcignTWFpbkNvbnRyb2xsZXInLFsnJHJvb3RTY29wZScsJyRzY29wZScsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSl7XG5cblxuXG4gICAgICAvLyBVc2VyIGFnZW50IGRpc3BsYXllZCBpbiBob21lIHBhZ2VcbiAgICAgICRzY29wZS51c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuXG4gICAgICAvLyBOZWVkZWQgZm9yIHRoZSBsb2FkaW5nIHNjcmVlblxuICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24oKXtcbiAgICAgICAgJHJvb3RTY29wZS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgIH0pO1xuXG4gICAgICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAgICAgfSk7XG5cblxuXG4gICAgICAkc2NvcGUuYm90dG9tUmVhY2hlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvKiBnbG9iYWwgYWxlcnQ6IGZhbHNlOyAqL1xuICAgICAgICBhbGVydCgnQ29uZ3JhdHMgeW91IHNjcm9sbGVkIHRvIHRoZSBlbmQgb2YgdGhlIGxpc3QhJyk7XG4gICAgICB9O1xuXG5cbiAgICAgIC8vXG4gICAgICAvLyAnRHJhZycgc2NyZWVuXG4gICAgICAvL1xuICAgICAgJHNjb3BlLm5vdGljZXMgPSBbXTtcblxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgICRzY29wZS5ub3RpY2VzLnB1c2goe2ljb246ICdlbnZlbG9wZScsIG1lc3NhZ2U6ICdOb3RpY2UgJyArIChqICsgMSkgfSk7XG4gICAgICB9XG5cbiAgICAgICRzY29wZS5kZWxldGVOb3RpY2UgPSBmdW5jdGlvbihub3RpY2UpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gJHNjb3BlLm5vdGljZXMuaW5kZXhPZihub3RpY2UpO1xuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICRzY29wZS5ub3RpY2VzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC51c2VycycsIFsnYXBwLnVzZXJzLnNlcnZpY2UnXSlcbiAgICAuY29udHJvbGxlcignVXNlckN0cmwnLFsnJHNjb3BlJywnVXNlcicsZnVuY3Rpb24oJHNjb3BlLFVzZXIpe1xuXG4gICAgICBVc2VyLm9uZSgncHJvZmlsZScpLmdldCgpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uICAoZGF0YSkge1xuICAgICAgICAgICRzY29wZS5Gb3JtVXNlciA9IGRhdGE7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbiAgKGVycikge1xuICAgICAgICAgIGFsZXJ0KGVyci5kYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICRzY29wZS51cGRhdGVQcm9maWxlID0gZnVuY3Rpb24gICgpIHtcbiAgICAgICAgJHNjb3BlLkZvcm1Vc2VyLnB1dCgpXG4gICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uICAoZXJyKSB7XG4gICAgICAgICAgICBhbGVydChlcnIuZGF0YSk7XG4gICAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH1dKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC51c2Vycy5zZXJ2aWNlJywgIFtdKVxuXG4gICAgICAuZmFjdG9yeSAoJ1VzZXInLCBbJyRodHRwJyxmdW5jdGlvbiAoJGh0dHApIHtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFsbDpSZXN0YW5ndWxhci5hbGwoJ2FwaS91c2VycycpLFxuICAgICAgICAgIG9uZTpmdW5jdGlvbiAgKGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gUmVzdGFuZ3VsYXIub25lKCdhcGkvdXNlcnMnLGlkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XSk7XG5cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
