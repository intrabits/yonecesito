!function(){"use strict";angular.module("app",["ngRoute","mobile-angular-ui","app.main","app.home","ngNotify","app.user","app.necesidad","mobile-angular-ui.gestures"]).run(["$transform",function(e){window.$transform=e}]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"scripts/home/home.html",reloadOnSearch:!1}).when("/",{templateUrl:"scripts/home/scroll.html",reloadOnSearch:!1,controller:"HomeCtrl",controllerAs:"HomeCtrl"}).when("/necesidad/:id",{templateUrl:"scripts/necesidad/detalle.html",controller:"NecesidadDetalleCtrl",controllerAs:"DetalleCtrl"}).when("/necesidad/:id/editar",{templateUrl:"scripts/necesidad/editar.html",controller:"NecesidadDetalleCtrl",controllerAs:"DetalleCtrl"}).when("/categoria/:categoria",{templateUrl:"scripts/necesidad/categoria.html",reloadOnSearch:!1,controller:"CategoriaCtrl",controllerAs:"CategoriaCtrl"}).when("/perfil",{templateUrl:"scripts/users/config.html",reloadOnSearch:!1,controller:"ConfigCtrl",controllerAs:"ConfigCtrl"}).when("/usuario/:id",{templateUrl:"scripts/users/profile.html",reloadOnSearch:!1,controller:"UserCtrl",controllerAs:"UserCtrl"}).when("/contacto",{templateUrl:"scripts/shared/contacto.html"}).otherwise({redirectTo:"/"})}])}(),function(){"use strict";angular.module("app.home",[]).controller("HomeCtrl",["Necesidad","ngNotify",function(e,r){var t=this;e.load().success(function(e){t.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad.categoria",[]).controller("CategoriaCtrl",["Necesidad","$routeParams",function(e,r){var t=this;e.categoria(r.categoria).success(function(e){t.necesidades=e.necesidades,t.categoria=e.categoria}).error(function(e){console.error(e)})}])}(),function(){"use strict";angular.module("app.comentario.service",[]).factory("Comentario",["$http",function(e){return{"delete":function(r){return e["delete"]("/api/comentarios/"+r)},create:function(r){return e({data:r,method:"POST",url:"/api/necesidades/"+r.necesidadId+"/comentarios"})},update:function(r){return e({data:r,method:"PUT",url:"/api/comentarios/"+r.id})}}}])}(),function(){"use strict";angular.module("app.necesidad.detalle",[]).controller("NecesidadDetalleCtrl",["Necesidad","ngNotify","$routeParams","$window","Comentario",function(e,r,t,n,o){var i=this;i.necesidad={},i.ComentarioForm={},t.id&&e.show(t.id).success(function(e){i.necesidad=e}).error(function(e){r.set(e,"error")}),i.save=function(){e.update(i.necesidad).success(function(e){r.set(e,"success")}).error(function(e){r.set(e,"error")})},i.comentar=function(){i.ComentarioForm.necesidadId=i.necesidad.id,i.ComentarioForm.userId=i.necesidad.userId,i.Comentario.createdAt=new Date,o.create(i.ComentarioForm).success(function(e){r.set(e,"success"),i.necesidad.comentarios.push(i.ComentarioForm)}).error(function(e){r.set(e,"error")})},i["delete"]=function(){var t=confirm("Realmente deseas eliminar esta publicaciÃ³n?");t&&e["delete"](i.necesidad.id).success(function(e){r.set(e,"success"),n.location="#/"}).error(function(e){r.set(e,"error")})}}])}(),function(){"use strict";angular.module("app.necesidad",["app.necesidad.service","app.necesidad.nueva","app.necesidad.detalle","app.necesidad.categoria","app.comentario.service"]).controller("NecesidadesCtrl",["Necesidad","ngNotify",function(e,r){var t=this;e.load().success(function(e){t.necesidades=e}).error(function(e){r.set(e,"error")})}])}(),function(){"use strict";angular.module("app.necesidad.service",[]).factory("Necesidad",["$http",function(e){return{load:function(r){return e.get("/api/necesidades")},show:function(r){return e.get("/api/necesidades/"+r)},categoria:function(r){return e.get("/api/categorias/"+r)},"delete":function(r){return e["delete"]("/api/necesidades/"+r)},create:function(r){return e({data:r,method:"POST",url:"/api/necesidades"})},update:function(r){return e({data:r,method:"PUT",url:"/api/necesidades/"+r.id})}}}])}(),function(){"use strict";angular.module("app.necesidad.nueva",[]).controller("NuevaNecesidadCtrl",["Necesidad","ngNotify","$window",function(e,r,t){var n=this;n.NecesidadForm={},n.create=function(){e.create(n.NecesidadForm).success(function(e){r.set(e,"success"),t.location="#/necesidad/"+e}).error(function(e){r.set(e,"error")})}}])}(),angular.module("app.directives",[]).directive("money",function(){function e(e,t,n,o){function i(e){var r=Math.pow(10,l);return Math.round(e*r)/r}function a(e){return parseFloat(e).toFixed(l)}function s(e){return o.$isEmpty(e)?"":""+e}var c,u=parseFloat(n.min||0),l=parseFloat(n.precision||2);o.$parsers.push(function(e){angular.isUndefined(e)&&(e=""),0===e.indexOf(".")&&(e="0"+e),0===e.indexOf("-")&&(u>=0?(e=null,o.$setViewValue(""),o.$render()):"-"===e&&(e=""));var t=o.$isEmpty(e);return t||r.test(e)?c=""===e?null:t?e:parseFloat(e):(o.$setViewValue(s(c)),o.$render()),o.$setValidity("number",!0),c}),o.$formatters.push(s);var d=function(e){return!o.$isEmpty(e)&&u>e?void o.$setValidity("min",!1):(o.$setValidity("min",!0),e)};if(o.$parsers.push(d),o.$formatters.push(d),n.max){var f=parseFloat(n.max),p=function(e){return!o.$isEmpty(e)&&e>f?void o.$setValidity("max",!1):(o.$setValidity("max",!0),e)};o.$parsers.push(p),o.$formatters.push(p)}l>-1&&(o.$parsers.push(function(e){return e?i(e):e}),o.$formatters.push(function(e){return e?a(e):e})),t.bind("blur",function(){var e=o.$modelValue;e&&(o.$viewValue=a(e),o.$render())})}var r=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/;return{restrict:"A",require:"ngModel",link:e}}).directive("numbersOnly",function(){return{restrict:"A",require:"ngModel",link:function(e,r,t,n){n.$parsers.push(function(e){if(void 0===e)return"";var r=e.replace(/[^0-9+.]/g,"");return r!==e&&(n.$setViewValue(r),n.$render()),r})}}}),angular.module("app.filters",[]).filter("dinero",["$filter","$locale",function(e,r){var t=e("currency"),n=r.NUMBER_FORMATS;return function(e,r,o){0===r&&(r=-1);var i=t(e,o),a=i.indexOf(n.DECIMAL_SEP)+1,s="";return a<i.indexOf(n.CURRENCY_SYM)&&(s=" "+n.CURRENCY_SYM),i.substring(0,a+r)+s}}]),function(){"use strict";angular.module("app.main",["app.directives","app.filters"]).controller("MainController",["$rootScope","$scope","User",function(e,r,t){var n=this;t.me().success(function(e){n.user=e}).error(function(e){console.log(e)}),r.userAgent=navigator.userAgent,e.$on("$routeChangeStart",function(){e.loading=!0}),e.$on("$routeChangeSuccess",function(){e.loading=!1}),r.bottomReached=function(){},r.notices=[];for(var o=0;10>o;o++)r.notices.push({icon:"envelope",message:"Notice "+(o+1)});r.deleteNotice=function(e){var t=r.notices.indexOf(e);t>-1&&r.notices.splice(t,1)}}])}(),function(){"use strict";angular.module("app.user.config",[]).controller("ConfigCtrl",["ngNotify","User",function(e,r){var t=this;t.user={},console.log("Cargando"),r.me().success(function(e){t.user=e}).error(function(r){e.set(r,"error")}),t.save=function(){r.update(t.user).success(function(r){e.set(r,"success")}).error(function(r){e.set(r,"error")})}}])}(),function(){"use strict";angular.module("app.user",["app.user.service","app.user.config"]).controller("UserCtrl",["ngNotify","User","$routeParams",function(e,r,t){var n=this;console.log("Cargando"),r.show(t.id).success(function(e){n.user=e,console.log("no"),console.log(e)}).error(function(r){e.set(r,"error")})}])}(),function(){"use strict";angular.module("app.user.service",[]).factory("User",["$http",function(e){return{me:function(){return e.get("/api/users/profile")},update:function(r){return e({method:"PUT",data:r,url:"/api/users/profile"})},show:function(r){return e.get("/api/users/"+r)}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImhvbWUvaG9tZS5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL2NhdGVnb3JpYS5jb250cm9sbGVyLmpzIiwibmVjZXNpZGFkL2NvbWVudGFyaW8uc2VydmljZS5qcyIsIm5lY2VzaWRhZC9kZXRhbGxlLmNvbnRyb2xsZXIuanMiLCJuZWNlc2lkYWQvbmVjZXNpZGFkLmNvbnRyb2xsZXIuanMiLCJuZWNlc2lkYWQvbmVjZXNpZGFkLnNlcnZpY2UuanMiLCJuZWNlc2lkYWQvbnVldmEuY29udHJvbGxlci5qcyIsInNoYXJlZC9kaXJlY3RpdmVzLmpzIiwic2hhcmVkL2ZpbHRlcnMuanMiLCJzaGFyZWQvbWFpbi5qcyIsInVzZXJzL2NvbmZpZy5jb250cm9sbGVyLmpzIiwidXNlcnMvY29udHJvbGxlci5qcyIsInVzZXJzL3NlcnZpY2UuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiR0cmFuc2Zvcm0iLCJ3aW5kb3ciLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInJlbG9hZE9uU2VhcmNoIiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJOZWNlc2lkYWQiLCJuZ05vdGlmeSIsInZtIiwidGhpcyIsImxvYWQiLCJzdWNjZXNzIiwiZGF0YSIsIm5lY2VzaWRhZGVzIiwiZXJyb3IiLCJlcnIiLCJzZXQiLCIkcm91dGVQYXJhbXMiLCJjYXRlZ29yaWEiLCJjb25zb2xlIiwiZmFjdG9yeSIsIiRodHRwIiwiZGVsZXRlIiwiaWQiLCJjcmVhdGUiLCJtZXRob2QiLCJ1cmwiLCJuZWNlc2lkYWRJZCIsInVwZGF0ZSIsIiR3aW5kb3ciLCJDb21lbnRhcmlvIiwibmVjZXNpZGFkIiwiQ29tZW50YXJpb0Zvcm0iLCJzaG93Iiwic2F2ZSIsImNvbWVudGFyIiwidXNlcklkIiwiY3JlYXRlZEF0IiwiRGF0ZSIsImNvbWVudGFyaW9zIiwicHVzaCIsInN1cmUiLCJjb25maXJtIiwibG9jYXRpb24iLCJjYWxsYmFjayIsImdldCIsImNsYXZlIiwiTmVjZXNpZGFkRm9ybSIsImRpcmVjdGl2ZSIsImxpbmsiLCJzY29wZSIsImVsIiwiYXR0cnMiLCJuZ01vZGVsQ3RybCIsInJvdW5kIiwibnVtIiwiZCIsIk1hdGgiLCJwb3ciLCJwcmVjaXNpb24iLCJmb3JtYXRQcmVjaXNpb24iLCJ2YWx1ZSIsInBhcnNlRmxvYXQiLCJ0b0ZpeGVkIiwiZm9ybWF0Vmlld1ZhbHVlIiwiJGlzRW1wdHkiLCJsYXN0VmFsaWRWYWx1ZSIsIm1pbiIsIiRwYXJzZXJzIiwiaXNVbmRlZmluZWQiLCJpbmRleE9mIiwiJHNldFZpZXdWYWx1ZSIsIiRyZW5kZXIiLCJlbXB0eSIsIk5VTUJFUl9SRUdFWFAiLCJ0ZXN0IiwiJHNldFZhbGlkaXR5IiwiJGZvcm1hdHRlcnMiLCJtaW5WYWxpZGF0b3IiLCJtYXgiLCJtYXhWYWxpZGF0b3IiLCJiaW5kIiwiJG1vZGVsVmFsdWUiLCIkdmlld1ZhbHVlIiwicmVzdHJpY3QiLCJyZXF1aXJlIiwiZWxlbWVudCIsIm1vZGVsQ3RybCIsImlucHV0VmFsdWUiLCJ1bmRlZmluZWQiLCJ0cmFuc2Zvcm1lZElucHV0IiwicmVwbGFjZSIsImZpbHRlciIsImxvY2FsZSIsImN1cnJlbmN5RmlsdGVyIiwiZm9ybWF0cyIsIk5VTUJFUl9GT1JNQVRTIiwiYW1vdW50IiwiY3VycmVuY3lTeW1ib2wiLCJzZXAiLCJERUNJTUFMX1NFUCIsInN5bWJvbCIsIkNVUlJFTkNZX1NZTSIsInN1YnN0cmluZyIsIiRyb290U2NvcGUiLCIkc2NvcGUiLCJVc2VyIiwibWUiLCJ1c2VyIiwibG9nIiwidXNlckFnZW50IiwibmF2aWdhdG9yIiwiJG9uIiwibG9hZGluZyIsImJvdHRvbVJlYWNoZWQiLCJub3RpY2VzIiwiaiIsImljb24iLCJtZXNzYWdlIiwiZGVsZXRlTm90aWNlIiwibm90aWNlIiwiaW5kZXgiLCJzcGxpY2UiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0Es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QVMsV0FBQSxjQUFBLFdBQUEsT0FBQSxTQUFBSyxFQUFBbUcsR0FFQSxHQUFBbEcsR0FBQUMsSUFDQUQsR0FBQW9HLFFBQ0F6RixRQUFBMEYsSUFBQSxZQUVBSCxFQUFBQyxLQUNBaEcsUUFBQSxTQUFBQyxHQUNBSixFQUFBb0csS0FBQWhHLElBRUFFLE1BQUEsU0FBQUMsR0FDQVIsRUFBQVMsSUFBQUQsRUFBQSxXQUdBUCxFQUFBMEIsS0FBQSxXQUNBd0UsRUFBQTlFLE9BQUFwQixFQUFBb0csTUFDQWpHLFFBQUEsU0FBQUMsR0FDQUwsRUFBQVMsSUFBQUosRUFBQSxhQUVBRSxNQUFBLFNBQUFDLEdBQ0FSLEVBQUFTLElBQUFELEVBQUEsa0JDdkJBLFdBQ0EsWUFDQXZCLFNBQUFDLE9BQUEsWUFDQSxtQkFDQSxvQkFFQVMsV0FBQSxZQUFBLFdBQUEsT0FBQSxlQUFBLFNBQUFLLEVBQUFtRyxFQUFBekYsR0FFQSxHQUFBVCxHQUFBQyxJQUNBVSxTQUFBMEYsSUFBQSxZQUVBSCxFQUFBekUsS0FBQWhCLEVBQUFNLElBQ0FaLFFBQUEsU0FBQUMsR0FDQUosRUFBQW9HLEtBQUFoRyxFQUNBTyxRQUFBMEYsSUFBQSxNQUNBMUYsUUFBQTBGLElBQUFqRyxLQUVBRSxNQUFBLFNBQUFDLEdBQ0FSLEVBQUFTLElBQUFELEVBQUEsaUJDbEJBLFdBQ0EsWUFDQXZCLFNBQ0FDLE9BQUEsdUJBRUEyQixRQUFBLFFBQUEsUUFBQSxTQUFBQyxHQUVBLE9BQ0FzRixHQUFBLFdBQ0EsTUFBQXRGLEdBQUF3QixJQUFBLHVCQUVBakIsT0FBQSxTQUFBaEIsR0FDQSxNQUFBUyxJQUNBSSxPQUFBLE1BQ0FiLEtBQUFBLEVBQ0FjLElBQUEsd0JBR0FPLEtBQUEsU0FBQVYsR0FDQSxNQUFBRixHQUFBd0IsSUFBQSxjQUFBdEIiLCJmaWxlIjoiYnVpbGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcsIFtcbiAgICAgICduZ1JvdXRlJyxcbiAgICAgICdtb2JpbGUtYW5ndWxhci11aScsXG4gICAgICAnYXBwLm1haW4nLFxuICAgICAgJ2FwcC5ob21lJyxcbiAgICAgICduZ05vdGlmeScsXG4gICAgICAnYXBwLnVzZXInLFxuICAgICAgJ2FwcC5uZWNlc2lkYWQnLFxuICAgICAgLy8gdG91Y2gvZHJhZyBmZWF0dXJlOiB0aGlzIGlzIGZyb20gJ21vYmlsZS1hbmd1bGFyLXVpLmdlc3R1cmVzLmpzJ1xuICAgICAgLy8gaXQgaXMgYXQgYSB2ZXJ5IGJlZ2lubmluZyBzdGFnZSwgc28gcGxlYXNlIGJlIGNhcmVmdWwgaWYgeW91IGxpa2UgdG8gdXNlXG4gICAgICAvLyBpbiBwcm9kdWN0aW9uLiBUaGlzIGlzIGludGVuZGVkIHRvIHByb3ZpZGUgYSBmbGV4aWJsZSwgaW50ZWdyYXRlZCBhbmQgYW5kXG4gICAgICAvLyBlYXN5IHRvIHVzZSBhbHRlcm5hdGl2ZSB0byBvdGhlciAzcmQgcGFydHkgbGlicyBsaWtlIGhhbW1lci5qcywgd2l0aCB0aGVcbiAgICAgIC8vIGZpbmFsIHBvdXJwb3NlIHRvIGludGVncmF0ZSBnZXN0dXJlcyBpbnRvIGRlZmF1bHQgdWkgaW50ZXJhY3Rpb25zIGxpa2VcbiAgICAgIC8vIG9wZW5pbmcgc2lkZWJhcnMsIHR1cm5pbmcgc3dpdGNoZXMgb24vb2ZmIC4uXG4gICAgICAnbW9iaWxlLWFuZ3VsYXItdWkuZ2VzdHVyZXMnXG4gICAgXSlcbiAgICAucnVuKFsnJHRyYW5zZm9ybScsZnVuY3Rpb24oJHRyYW5zZm9ybSkge1xuICAgICAgd2luZG93LiR0cmFuc2Zvcm0gPSAkdHJhbnNmb3JtO1xuICAgIH1dKVxuICAgIC5jb25maWcoWyckcm91dGVQcm92aWRlcicsZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAud2hlbignLycsIHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvaG9tZS9ob21lLmh0bWwnLFxuICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZVxuICAgICAgICB9KVxuICAgICAgICAud2hlbignLycsIHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvaG9tZS9zY3JvbGwuaHRtbCcsXG4gICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlLFxuICAgICAgICAgIGNvbnRyb2xsZXI6J0hvbWVDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0hvbWVDdHJsJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL25lY2VzaWRhZC86aWQnLCB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL25lY2VzaWRhZC9kZXRhbGxlLmh0bWwnLFxuICAgICAgICAgIGNvbnRyb2xsZXI6J05lY2VzaWRhZERldGFsbGVDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0RldGFsbGVDdHJsJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL25lY2VzaWRhZC86aWQvZWRpdGFyJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9uZWNlc2lkYWQvZWRpdGFyLmh0bWwnLFxuICAgICAgICAgIGNvbnRyb2xsZXI6J05lY2VzaWRhZERldGFsbGVDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0RldGFsbGVDdHJsJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2NhdGVnb3JpYS86Y2F0ZWdvcmlhJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy9uZWNlc2lkYWQvY2F0ZWdvcmlhLmh0bWwnLFxuICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZSxcbiAgICAgICAgICBjb250cm9sbGVyOidDYXRlZ29yaWFDdHJsJyxcbiAgICAgICAgICBjb250cm9sbGVyQXM6J0NhdGVnb3JpYUN0cmwnXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvcGVyZmlsJywge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc2NyaXB0cy91c2Vycy9jb25maWcuaHRtbCcsXG4gICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlLFxuICAgICAgICAgIGNvbnRyb2xsZXI6J0NvbmZpZ0N0cmwnLFxuICAgICAgICAgIGNvbnRyb2xsZXJBczonQ29uZmlnQ3RybCdcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy91c3VhcmlvLzppZCcsIHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3NjcmlwdHMvdXNlcnMvcHJvZmlsZS5odG1sJyxcbiAgICAgICAgICByZWxvYWRPblNlYXJjaDogZmFsc2UsXG4gICAgICAgICAgY29udHJvbGxlcjonVXNlckN0cmwnLFxuICAgICAgICAgIGNvbnRyb2xsZXJBczonVXNlckN0cmwnXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvY29udGFjdG8nLCB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdzY3JpcHRzL3NoYXJlZC9jb250YWN0by5odG1sJyAgICAgICAgICBcbiAgICAgICAgfSlcbiAgICAgICAgLm90aGVyd2lzZSh7XG4gICAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgICAgIH0pO1xuICAgIH1dKTtcblxuXG4gICAgLy8gYXBwLmRpcmVjdGl2ZSgndG91Y2hhcmVhJywgWyckdG91Y2gnLCBmdW5jdGlvbigkdG91Y2gpe1xuICAgIC8vICAgLy8gUnVucyBkdXJpbmcgY29tcGlsZVxuICAgIC8vICAgcmV0dXJuIHtcbiAgICAvLyAgICAgcmVzdHJpY3Q6ICdDJyxcbiAgICAvLyAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCBlbGVtKSB7XG4gICAgLy8gICAgICAgJHNjb3BlLnRvdWNoID0gbnVsbDtcbiAgICAvLyAgICAgICAkdG91Y2guYmluZChlbGVtLCB7XG4gICAgLy8gICAgICAgICBzdGFydDogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH0sXG4gICAgLy9cbiAgICAvLyAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24odG91Y2gpIHtcbiAgICAvLyAgICAgICAgICAgJHNjb3BlLnRvdWNoID0gdG91Y2g7XG4gICAgLy8gICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAvLyAgICAgICAgIH0sXG4gICAgLy9cbiAgICAvLyAgICAgICAgIG1vdmU6IGZ1bmN0aW9uKHRvdWNoKSB7XG4gICAgLy8gICAgICAgICAgICRzY29wZS50b3VjaCA9IHRvdWNoO1xuICAgIC8vICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgLy8gICAgICAgICB9LFxuICAgIC8vXG4gICAgLy8gICAgICAgICBlbmQ6IGZ1bmN0aW9uKHRvdWNoKSB7XG4gICAgLy8gICAgICAgICAgICRzY29wZS50b3VjaCA9IHRvdWNoO1xuICAgIC8vICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgICAgfSk7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH07XG4gICAgLy8gfV0pO1xuICAgIC8vXG4gICAgLy8gLy9cbiAgICAvLyAvLyBgJGRyYWdgIGV4YW1wbGU6IGRyYWcgdG8gZGlzbWlzc1xuICAgIC8vIC8vXG4gICAgLy8gYXBwLmRpcmVjdGl2ZSgnZHJhZ1RvRGlzbWlzcycsIGZ1bmN0aW9uKCRkcmFnLCAkcGFyc2UsICR0aW1lb3V0KXtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHJlc3RyaWN0OiAnQScsXG4gICAgLy8gICAgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsZW0sIGF0dHJzKSB7XG4gICAgLy8gICAgICAgdmFyIGRpc21pc3NGbiA9ICRwYXJzZShhdHRycy5kcmFnVG9EaXNtaXNzKTtcbiAgICAvLyAgICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0pe1xuICAgIC8vICAgICAgICAgdmFyIGRpc21pc3MgPSBmYWxzZTtcbiAgICAvL1xuICAgIC8vICAgICAgICAgJGRyYWcuYmluZChlbGVtLCB7XG4gICAgLy8gICAgICAgICAgIHRyYW5zZm9ybTogJGRyYWcuVFJBTlNMQVRFX1JJR0hULFxuICAgIC8vICAgICAgICAgICBtb3ZlOiBmdW5jdGlvbihkcmFnKSB7XG4gICAgLy8gICAgICAgICAgICAgaWYoIGRyYWcuZGlzdGFuY2VYID49IGRyYWcucmVjdC53aWR0aCAvIDQpIHtcbiAgICAvLyAgICAgICAgICAgICAgIGRpc21pc3MgPSB0cnVlO1xuICAgIC8vICAgICAgICAgICAgICAgZWxlbS5hZGRDbGFzcygnZGlzbWlzcycpO1xuICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICAgICAgICBkaXNtaXNzID0gZmFsc2U7XG4gICAgLy8gICAgICAgICAgICAgICBlbGVtLnJlbW92ZUNsYXNzKCdkaXNtaXNzJyk7XG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgICB9LFxuICAgIC8vICAgICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICAgICAgZWxlbS5yZW1vdmVDbGFzcygnZGlzbWlzcycpO1xuICAgIC8vICAgICAgICAgICB9LFxuICAgIC8vICAgICAgICAgICBlbmQ6IGZ1bmN0aW9uKGRyYWcpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiAoZGlzbWlzcykge1xuICAgIC8vICAgICAgICAgICAgICAgZWxlbS5hZGRDbGFzcygnZGlzbWl0dGVkJyk7XG4gICAgLy8gICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgIC8vICAgICAgICAgICAgICAgICAgIGRpc21pc3NGbihzY29wZSk7XG4gICAgLy8gICAgICAgICAgICAgICAgIH0pO1xuICAgIC8vICAgICAgICAgICAgICAgfSwgMzAwKTtcbiAgICAvLyAgICAgICAgICAgICB9IGVsc2Uge1xuICAgIC8vICAgICAgICAgICAgICAgZHJhZy5yZXNldCgpO1xuICAgIC8vICAgICAgICAgICAgIH1cbiAgICAvLyAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgfSk7XG4gICAgLy8gICAgICAgfTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9KTtcbiAgICAvL1xuICAgIC8vIC8vXG4gICAgLy8gLy8gQW5vdGhlciBgJGRyYWdgIHVzYWdlIGV4YW1wbGU6IHRoaXMgaXMgaG93IHlvdSBjb3VsZCBjcmVhdGVcbiAgICAvLyAvLyBhIHRvdWNoIGVuYWJsZWQgXCJkZWNrIG9mIGNhcmRzXCIgY2Fyb3VzZWwuIFNlZSBgY2Fyb3VzZWwuaHRtbGAgZm9yIG1hcmt1cC5cbiAgICAvLyAvL1xuICAgIC8vIGFwcC5kaXJlY3RpdmUoJ2Nhcm91c2VsJywgZnVuY3Rpb24oKXtcbiAgICAvLyAgIHJldHVybiB7XG4gICAgLy8gICAgIHJlc3RyaWN0OiAnQycsXG4gICAgLy8gICAgIHNjb3BlOiB7fSxcbiAgICAvLyAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgICAgdGhpcy5pdGVtQ291bnQgPSAwO1xuICAgIC8vICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IG51bGw7XG4gICAgLy9cbiAgICAvLyAgICAgICB0aGlzLmFkZEl0ZW0gPSBmdW5jdGlvbigpe1xuICAgIC8vICAgICAgICAgdmFyIG5ld0lkID0gdGhpcy5pdGVtQ291bnQrKztcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuaXRlbUNvdW50ID09PSAxID8gbmV3SWQgOiB0aGlzLmFjdGl2ZUl0ZW07XG4gICAgLy8gICAgICAgICByZXR1cm4gbmV3SWQ7XG4gICAgLy8gICAgICAgfTtcbiAgICAvL1xuICAgIC8vICAgICAgIHRoaXMubmV4dCA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSB0aGlzLmFjdGl2ZUl0ZW0gfHwgMDtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSA9PT0gdGhpcy5pdGVtQ291bnQgLSAxID8gMCA6IHRoaXMuYWN0aXZlSXRlbSArIDE7XG4gICAgLy8gICAgICAgfTtcbiAgICAvL1xuICAgIC8vICAgICAgIHRoaXMucHJldiA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSB0aGlzLmFjdGl2ZUl0ZW0gfHwgMDtcbiAgICAvLyAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IHRoaXMuYWN0aXZlSXRlbSA9PT0gMCA/IHRoaXMuaXRlbUNvdW50IC0gMSA6IHRoaXMuYWN0aXZlSXRlbSAtIDE7XG4gICAgLy8gICAgICAgfTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9KTtcblxuXG5cbiAgICAvL1xuICAgIC8vIEZvciB0aGlzIHRyaXZpYWwgZGVtbyB3ZSBoYXZlIGp1c3QgYSB1bmlxdWUgTWFpbkNvbnRyb2xsZXJcbiAgICAvLyBmb3IgZXZlcnl0aGluZ1xuICAgIC8vXG4gICAgLy8gYXBwLmNvbnRyb2xsZXIoJ01haW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlKXtcbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLnN3aXBlZCA9IGZ1bmN0aW9uKGRpcmVjdGlvbikge1xuICAgIC8vICAgICBhbGVydCgnU3dpcGVkICcgKyBkaXJlY3Rpb24pO1xuICAgIC8vICAgfTtcbiAgICAvL1xuICAgIC8vICAgLy8gVXNlciBhZ2VudCBkaXNwbGF5ZWQgaW4gaG9tZSBwYWdlXG4gICAgLy8gICAkc2NvcGUudXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICAvL1xuICAgIC8vICAgLy8gTmVlZGVkIGZvciB0aGUgbG9hZGluZyBzY3JlZW5cbiAgICAvLyAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgICRyb290U2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgLy8gICB9KTtcbiAgICAvL1xuICAgIC8vICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpe1xuICAgIC8vICAgICAkcm9vdFNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAvLyAgIH0pO1xuICAgIC8vXG4gICAgLy8gICAvLyBGYWtlIHRleHQgaSB1c2VkIGhlcmUgYW5kIHRoZXJlLlxuICAgIC8vICAgJHNjb3BlLmxvcmVtID0gJ0xvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNpY2luZyBlbGl0LiBWZWwgZXhwbGljYWJvLCBhbGlxdWlkIGVhcXVlIHNvbHV0YSBuaWhpbCBlbGlnZW5kaSBhZGlwaXNjaSBlcnJvciwgaWxsdW0gY29ycnVwdGkgbmFtIGZ1Z2Egb21uaXMgcXVvZCBxdWFlcmF0IG1vbGxpdGlhIGV4cGVkaXRhIGltcGVkaXQgZG9sb3JlcyBpcHNhbS4gT2JjYWVjYXRpLic7XG4gICAgLy9cbiAgICAvLyAgIC8vXG4gICAgLy8gICAvLyAnU2Nyb2xsJyBzY3JlZW5cbiAgICAvLyAgIC8vXG4gICAgLy8gICB2YXIgc2Nyb2xsSXRlbXMgPSBbXTtcbiAgICAvL1xuICAgIC8vICAgZm9yICh2YXIgaT0xOyBpPD0xMDA7IGkrKykge1xuICAgIC8vICAgICBzY3JvbGxJdGVtcy5wdXNoKCdJdGVtICcgKyBpKTtcbiAgICAvLyAgIH1cbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLnNjcm9sbEl0ZW1zID0gc2Nyb2xsSXRlbXM7XG4gICAgLy9cbiAgICAvLyAgICRzY29wZS5ib3R0b21SZWFjaGVkID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgIC8qIGdsb2JhbCBhbGVydDogZmFsc2U7ICovXG4gICAgLy8gICAgIGFsZXJ0KCdDb25ncmF0cyB5b3Ugc2Nyb2xsZWQgdG8gdGhlIGVuZCBvZiB0aGUgbGlzdCEnKTtcbiAgICAvLyAgIH07XG4gICAgLy9cbiAgICAvLyAgIC8vXG4gICAgLy8gICAvLyBSaWdodCBTaWRlYmFyXG4gICAgLy8gICAvL1xuICAgIC8vICAgJHNjb3BlLmNoYXRVc2VycyA9IFtcbiAgICAvLyAgICAgeyBuYW1lOiAnQ2FybG9zICBGbG93ZXJzJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0J5cm9uIFRheWxvcicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKYW5hICBUZXJyeScsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdEYXJyeWwgIFN0b25lJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0Zhbm5pZSAgQ2FybHNvbicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdIb2xseSBOZ3V5ZW4nLCBvbmxpbmU6IHRydWUgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQmlsbCAgQ2hhdmV6Jywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ1Zlcm9uaWNhICBNYXh3ZWxsJywgb25saW5lOiB0cnVlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0plc3NpY2EgV2Vic3RlcicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKYWNraWUgIEJhcnRvbicsIG9ubGluZTogdHJ1ZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdDcnlzdGFsIERyYWtlJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdNaWx0b24gIERlYW4nLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0pvYW5uIEpvaG5zdG9uJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdDb3JhICBWYXVnaG4nLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ05pbmEgIEJyaWdncycsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQ2FzZXkgVHVybmVyJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdKaW1taWUgIFdpbHNvbicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnTmF0aGFuaWVsIFN0ZWVsZScsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnQXVicmV5ICBDb2xlJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdEb25uaWUgIFN1bW1lcnMnLCBvbmxpbmU6IGZhbHNlIH0sXG4gICAgLy8gICAgIHsgbmFtZTogJ0thdGUgIE15ZXJzJywgb25saW5lOiBmYWxzZSB9LFxuICAgIC8vICAgICB7IG5hbWU6ICdQcmlzY2lsbGEgSGF3a2lucycsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnSm9lIEJhcmtlcicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnTGVlIE5vcm1hbicsIG9ubGluZTogZmFsc2UgfSxcbiAgICAvLyAgICAgeyBuYW1lOiAnRWJvbnkgUmljZScsIG9ubGluZTogZmFsc2UgfVxuICAgIC8vICAgXTtcbiAgICAvL1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vICdGb3Jtcycgc2NyZWVuXG4gICAgLy8gICAvL1xuICAgIC8vICAgJHNjb3BlLnJlbWVtYmVyTWUgPSB0cnVlO1xuICAgIC8vICAgJHNjb3BlLmVtYWlsID0gJ21lQGV4YW1wbGUuY29tJztcbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gICAgIGFsZXJ0KCdZb3Ugc3VibWl0dGVkIHRoZSBsb2dpbiBmb3JtJyk7XG4gICAgLy8gICB9O1xuICAgIC8vICAgLy9cbiAgICAvLyAgIC8vICdEcmFnJyBzY3JlZW5cbiAgICAvLyAgIC8vXG4gICAgLy8gICAkc2NvcGUubm90aWNlcyA9IFtdO1xuICAgIC8vXG4gICAgLy8gICBmb3IgKHZhciBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAvLyAgICAgJHNjb3BlLm5vdGljZXMucHVzaCh7aWNvbjogJ2VudmVsb3BlJywgbWVzc2FnZTogJ05vdGljZSAnICsgKGogKyAxKSB9KTtcbiAgICAvLyAgIH1cbiAgICAvL1xuICAgIC8vICAgJHNjb3BlLmRlbGV0ZU5vdGljZSA9IGZ1bmN0aW9uKG5vdGljZSkge1xuICAgIC8vICAgICB2YXIgaW5kZXggPSAkc2NvcGUubm90aWNlcy5pbmRleE9mKG5vdGljZSk7XG4gICAgLy8gICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgLy8gICAgICAgJHNjb3BlLm5vdGljZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgfTtcbiAgICAvLyB9KTtcblxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5ob21lJyxbXSlcbiAgICAgIC5jb250cm9sbGVyKCdIb21lQ3RybCcsWydOZWNlc2lkYWQnLCduZ05vdGlmeScsZnVuY3Rpb24gKE5lY2VzaWRhZCxuZ05vdGlmeSkge1xuXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgTmVjZXNpZGFkLmxvYWQoKVxuICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHZtLm5lY2VzaWRhZGVzID0gZGF0YTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCAnZXJyb3InKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5uZWNlc2lkYWQuY2F0ZWdvcmlhJyxbXSlcbiAgICAgIC5jb250cm9sbGVyKCdDYXRlZ29yaWFDdHJsJyxbJ05lY2VzaWRhZCcsJyRyb3V0ZVBhcmFtcycsZnVuY3Rpb24gKE5lY2VzaWRhZCwkcm91dGVQYXJhbXMpIHtcblxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG5cblxuICAgICAgICBOZWNlc2lkYWQuY2F0ZWdvcmlhKCRyb3V0ZVBhcmFtcy5jYXRlZ29yaWEpXG4gICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZtLm5lY2VzaWRhZGVzID0gZGF0YS5uZWNlc2lkYWRlcztcbiAgICAgICAgICAgIHZtLmNhdGVnb3JpYSA9IGRhdGEuY2F0ZWdvcmlhO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5jb21lbnRhcmlvLnNlcnZpY2UnLFtdKVxuICAgICAgLmZhY3RvcnkoJ0NvbWVudGFyaW8nLFsnJGh0dHAnLGZ1bmN0aW9uICgkaHR0cCkge1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGVsZXRlOmZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS9jb21lbnRhcmlvcy8nICsgaWQpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY3JlYXRlOmZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgICBkYXRhICAgIDogIGRhdGEsXG4gICAgICAgICAgICAgIG1ldGhvZCAgOiAnUE9TVCcsXG4gICAgICAgICAgICAgIHVybCAgICAgOiAnL2FwaS9uZWNlc2lkYWRlcy8nICsgZGF0YS5uZWNlc2lkYWRJZCArICcvY29tZW50YXJpb3MnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHVwZGF0ZTpmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgZGF0YSAgICA6ICBkYXRhLFxuICAgICAgICAgICAgICBtZXRob2QgIDogJ1BVVCcsXG4gICAgICAgICAgICAgIHVybCAgICAgOiAnL2FwaS9jb21lbnRhcmlvcy8nICsgZGF0YS5pZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH1dKVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5uZWNlc2lkYWQuZGV0YWxsZScsW10pXG4gICAgICAuY29udHJvbGxlcignTmVjZXNpZGFkRGV0YWxsZUN0cmwnLFsnTmVjZXNpZGFkJywnbmdOb3RpZnknLCckcm91dGVQYXJhbXMnLCckd2luZG93JywnQ29tZW50YXJpbycsZnVuY3Rpb24gKE5lY2VzaWRhZCxuZ05vdGlmeSwkcm91dGVQYXJhbXMsJHdpbmRvdyxDb21lbnRhcmlvKSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0ubmVjZXNpZGFkID0ge307XG4gICAgICAgIHZtLkNvbWVudGFyaW9Gb3JtID0ge307XG5cbiAgICAgICAgaWYgKCRyb3V0ZVBhcmFtcy5pZCkge1xuICAgICAgICAgIE5lY2VzaWRhZC5zaG93KCRyb3V0ZVBhcmFtcy5pZClcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIHZtLm5lY2VzaWRhZCA9IGRhdGE7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdm0uc2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBOZWNlc2lkYWQudXBkYXRlKHZtLm5lY2VzaWRhZClcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgIG5nTm90aWZ5LnNldChkYXRhLCdzdWNjZXNzJyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmNvbWVudGFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZtLkNvbWVudGFyaW9Gb3JtLm5lY2VzaWRhZElkID0gdm0ubmVjZXNpZGFkLmlkO1xuICAgICAgICAgIHZtLkNvbWVudGFyaW9Gb3JtLnVzZXJJZCA9IHZtLm5lY2VzaWRhZC51c2VySWQ7XG4gICAgICAgICAgdm0uQ29tZW50YXJpby5jcmVhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgQ29tZW50YXJpby5jcmVhdGUodm0uQ29tZW50YXJpb0Zvcm0pXG4gICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZGF0YSwnc3VjY2VzcycpO1xuICAgICAgICAgICAgICB2bS5uZWNlc2lkYWQuY29tZW50YXJpb3MucHVzaCh2bS5Db21lbnRhcmlvRm9ybSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgc3VyZSA9IGNvbmZpcm0oJ1JlYWxtZW50ZSBkZXNlYXMgZWxpbWluYXIgZXN0YSBwdWJsaWNhY2nDs24/Jyk7XG4gICAgICAgICAgaWYgKHN1cmUpIHtcbiAgICAgICAgICAgIE5lY2VzaWRhZC5kZWxldGUodm0ubmVjZXNpZGFkLmlkKVxuICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIG5nTm90aWZ5LnNldChkYXRhLCdzdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbiA9ICcjLyc7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAubmVjZXNpZGFkJyxbXG4gICAgICAnYXBwLm5lY2VzaWRhZC5zZXJ2aWNlJyxcbiAgICAgICdhcHAubmVjZXNpZGFkLm51ZXZhJyxcbiAgICAgICdhcHAubmVjZXNpZGFkLmRldGFsbGUnLFxuICAgICAgJ2FwcC5uZWNlc2lkYWQuY2F0ZWdvcmlhJyxcbiAgICAgICdhcHAuY29tZW50YXJpby5zZXJ2aWNlJ1xuICAgIF0pXG4gICAgICAuY29udHJvbGxlcignTmVjZXNpZGFkZXNDdHJsJyxbJ05lY2VzaWRhZCcsJ25nTm90aWZ5JyxmdW5jdGlvbiAoTmVjZXNpZGFkLG5nTm90aWZ5KSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICBOZWNlc2lkYWQubG9hZCgpXG4gICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgdm0ubmVjZXNpZGFkZXMgPSBkYXRhO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIG5nTm90aWZ5LnNldChlcnIsICdlcnJvcicpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLm5lY2VzaWRhZC5zZXJ2aWNlJyxbXSlcbiAgICAgIC5mYWN0b3J5KCdOZWNlc2lkYWQnLFsnJGh0dHAnLGZ1bmN0aW9uICgkaHR0cCkge1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbG9hZDpmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvbmVjZXNpZGFkZXMnKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNob3c6ZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL25lY2VzaWRhZGVzLycgKyBpZCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBjYXRlZ29yaWE6ZnVuY3Rpb24gKGNsYXZlKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NhdGVnb3JpYXMvJyArIGNsYXZlKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRlbGV0ZTpmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5kZWxldGUoJy9hcGkvbmVjZXNpZGFkZXMvJyArIGlkKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNyZWF0ZTpmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgZGF0YSAgICA6ICBkYXRhLFxuICAgICAgICAgICAgICBtZXRob2QgIDogJ1BPU1QnLFxuICAgICAgICAgICAgICB1cmwgICAgIDogJy9hcGkvbmVjZXNpZGFkZXMnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHVwZGF0ZTpmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgZGF0YSAgICA6ICBkYXRhLFxuICAgICAgICAgICAgICBtZXRob2QgIDogJ1BVVCcsXG4gICAgICAgICAgICAgIHVybCAgICAgOiAnL2FwaS9uZWNlc2lkYWRlcy8nICsgZGF0YS5pZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH1dKVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5uZWNlc2lkYWQubnVldmEnLFtdKVxuICAgICAgLmNvbnRyb2xsZXIoJ051ZXZhTmVjZXNpZGFkQ3RybCcsWydOZWNlc2lkYWQnLCduZ05vdGlmeScsJyR3aW5kb3cnLGZ1bmN0aW9uIChOZWNlc2lkYWQsbmdOb3RpZnksJHdpbmRvd1xuICAgICAgKSB7XG5cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uTmVjZXNpZGFkRm9ybSA9IHt9O1xuXG4gICAgICAgIHZtLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBOZWNlc2lkYWQuY3JlYXRlKHZtLk5lY2VzaWRhZEZvcm0pXG4gICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZGF0YSwnc3VjY2VzcycpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgJHdpbmRvdy5sb2NhdGlvbiA9ICcjL25lY2VzaWRhZC8nICsgZGF0YTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgIH1dKTtcbn0pKCk7XG4iLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnLCBbXSlcbiAgLmRpcmVjdGl2ZSgnbW9uZXknLCBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgTlVNQkVSX1JFR0VYUCA9IC9eXFxzKihcXC18XFwrKT8oXFxkK3woXFxkKihcXC5cXGQqKSkpXFxzKiQvO1xuXG4gICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWwsIGF0dHJzLCBuZ01vZGVsQ3RybCkge1xuICAgICAgdmFyIG1pbiA9IHBhcnNlRmxvYXQoYXR0cnMubWluIHx8IDApO1xuICAgICAgdmFyIHByZWNpc2lvbiA9IHBhcnNlRmxvYXQoYXR0cnMucHJlY2lzaW9uIHx8IDIpO1xuICAgICAgdmFyIGxhc3RWYWxpZFZhbHVlO1xuXG4gICAgICBmdW5jdGlvbiByb3VuZChudW0pIHtcbiAgICAgICAgdmFyIGQgPSBNYXRoLnBvdygxMCwgcHJlY2lzaW9uKTtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQobnVtICogZCkgLyBkO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBmb3JtYXRQcmVjaXNpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodmFsdWUpLnRvRml4ZWQocHJlY2lzaW9uKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZm9ybWF0Vmlld1ZhbHVlKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBuZ01vZGVsQ3RybC4kaXNFbXB0eSh2YWx1ZSkgPyAnJyA6ICcnICsgdmFsdWU7XG4gICAgICB9XG5cblxuICAgICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQodmFsdWUpKSB7XG4gICAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEhhbmRsZSBsZWFkaW5nIGRlY2ltYWwgcG9pbnQsIGxpa2UgXCIuNVwiXG4gICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCcuJykgPT09IDApIHtcbiAgICAgICAgICB2YWx1ZSA9ICcwJyArIHZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWxsb3cgXCItXCIgaW5wdXRzIG9ubHkgd2hlbiBtaW4gPCAwXG4gICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCctJykgPT09IDApIHtcbiAgICAgICAgICBpZiAobWluID49IDApIHtcbiAgICAgICAgICAgIHZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUoJycpO1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09ICctJykge1xuICAgICAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZW1wdHkgPSBuZ01vZGVsQ3RybC4kaXNFbXB0eSh2YWx1ZSk7XG4gICAgICAgIGlmIChlbXB0eSB8fCBOVU1CRVJfUkVHRVhQLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgbGFzdFZhbGlkVmFsdWUgPSAodmFsdWUgPT09ICcnKVxuICAgICAgICAgID8gbnVsbFxuICAgICAgICAgIDogKGVtcHR5ID8gdmFsdWUgOiBwYXJzZUZsb2F0KHZhbHVlKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gUmVuZGVyIHRoZSBsYXN0IHZhbGlkIGlucHV0IGluIHRoZSBmaWVsZFxuICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUoZm9ybWF0Vmlld1ZhbHVlKGxhc3RWYWxpZFZhbHVlKSk7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHJlbmRlcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdudW1iZXInLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuIGxhc3RWYWxpZFZhbHVlO1xuICAgICAgfSk7XG4gICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKGZvcm1hdFZpZXdWYWx1ZSk7XG5cbiAgICAgIHZhciBtaW5WYWxpZGF0b3IgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBpZiAoIW5nTW9kZWxDdHJsLiRpc0VtcHR5KHZhbHVlKSAmJiB2YWx1ZSA8IG1pbikge1xuICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgnbWluJywgZmFsc2UpO1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdtaW4nLCB0cnVlKTtcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBuZ01vZGVsQ3RybC4kcGFyc2Vycy5wdXNoKG1pblZhbGlkYXRvcik7XG4gICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKG1pblZhbGlkYXRvcik7XG5cbiAgICAgIGlmIChhdHRycy5tYXgpIHtcbiAgICAgICAgdmFyIG1heCA9IHBhcnNlRmxvYXQoYXR0cnMubWF4KTtcbiAgICAgICAgdmFyIG1heFZhbGlkYXRvciA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKCFuZ01vZGVsQ3RybC4kaXNFbXB0eSh2YWx1ZSkgJiYgdmFsdWUgPiBtYXgpIHtcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgnbWF4JywgZmFsc2UpO1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdtYXgnLCB0cnVlKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChtYXhWYWxpZGF0b3IpO1xuICAgICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKG1heFZhbGlkYXRvcik7XG4gICAgICB9XG5cbiAgICAgIC8vIFJvdW5kIG9mZlxuICAgICAgaWYgKHByZWNpc2lvbiA+IC0xKSB7XG4gICAgICAgIG5nTW9kZWxDdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlID8gcm91bmQodmFsdWUpIDogdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICBuZ01vZGVsQ3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiB2YWx1ZSA/IGZvcm1hdFByZWNpc2lvbih2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGVsLmJpbmQoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IG5nTW9kZWxDdHJsLiRtb2RlbFZhbHVlO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlID0gZm9ybWF0UHJlY2lzaW9uKHZhbHVlKTtcbiAgICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgbGluazogbGlua1xuICAgIH07XG4gIH0pLmRpcmVjdGl2ZSgnbnVtYmVyc09ubHknLCBmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBtb2RlbEN0cmwpIHtcbiAgICAgICAgbW9kZWxDdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24gKGlucHV0VmFsdWUpIHtcbiAgICAgICAgICAvLyB0aGlzIG5leHQgaWYgaXMgbmVjZXNzYXJ5IGZvciB3aGVuIHVzaW5nIG5nLXJlcXVpcmVkIG9uIHlvdXIgaW5wdXQuXG4gICAgICAgICAgLy8gSW4gc3VjaCBjYXNlcywgd2hlbiBhIGxldHRlciBpcyB0eXBlZCBmaXJzdCwgdGhpcyBwYXJzZXIgd2lsbCBiZSBjYWxsZWRcbiAgICAgICAgICAvLyBhZ2FpbiwgYW5kIHRoZSAybmQgdGltZSwgdGhlIHZhbHVlIHdpbGwgYmUgdW5kZWZpbmVkXG4gICAgICAgICAgaWYgKGlucHV0VmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuICcnO1xuICAgICAgICAgIHZhciB0cmFuc2Zvcm1lZElucHV0ID0gaW5wdXRWYWx1ZS5yZXBsYWNlKC9bXjAtOSsuXS9nLCAnJyk7XG4gICAgICAgICAgaWYgKHRyYW5zZm9ybWVkSW5wdXQhPT1pbnB1dFZhbHVlKSB7XG4gICAgICAgICAgICBtb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSh0cmFuc2Zvcm1lZElucHV0KTtcbiAgICAgICAgICAgIG1vZGVsQ3RybC4kcmVuZGVyKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkSW5wdXQ7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcC5maWx0ZXJzJyxbXSlcbiAgLmZpbHRlcignZGluZXJvJyxcbiAgWyAnJGZpbHRlcicsICckbG9jYWxlJywgZnVuY3Rpb24oZmlsdGVyLCBsb2NhbGUpIHtcbiAgICB2YXIgY3VycmVuY3lGaWx0ZXIgPSBmaWx0ZXIoJ2N1cnJlbmN5Jyk7XG4gICAgdmFyIGZvcm1hdHMgPSBsb2NhbGUuTlVNQkVSX0ZPUk1BVFM7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGFtb3VudCwgbnVtLCBjdXJyZW5jeVN5bWJvbCkge1xuICAgICAgaWYgKG51bT09PTApIG51bSA9IC0xO1xuICAgICAgdmFyIHZhbHVlID0gY3VycmVuY3lGaWx0ZXIoYW1vdW50LCBjdXJyZW5jeVN5bWJvbCk7XG4gICAgICB2YXIgc2VwID0gdmFsdWUuaW5kZXhPZihmb3JtYXRzLkRFQ0lNQUxfU0VQKSsxO1xuICAgICAgdmFyIHN5bWJvbCA9ICcnO1xuICAgICAgaWYgKHNlcDx2YWx1ZS5pbmRleE9mKGZvcm1hdHMuQ1VSUkVOQ1lfU1lNKSkgc3ltYm9sID0gJyAnK2Zvcm1hdHMuQ1VSUkVOQ1lfU1lNO1xuICAgICAgcmV0dXJuIHZhbHVlLnN1YnN0cmluZygwLCBzZXArbnVtKStzeW1ib2w7XG4gICAgfTtcbiAgfSBdKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgICBhbmd1bGFyXG4gICAgICAubW9kdWxlKCdhcHAubWFpbicsIFtcbiAgICAgICdhcHAuZGlyZWN0aXZlcycsXG4gICAgICAnYXBwLmZpbHRlcnMnXG4gICAgXSlcbiAgICAuY29udHJvbGxlcignTWFpbkNvbnRyb2xsZXInLFsnJHJvb3RTY29wZScsJyRzY29wZScsJ1VzZXInLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsIFVzZXIpe1xuXG4gICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICBVc2VyLm1lKClcbiAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICB2bS51c2VyID0gZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICB9KTtcblxuICAgICAgLy8gVXNlciBhZ2VudCBkaXNwbGF5ZWQgaW4gaG9tZSBwYWdlXG4gICAgICAkc2NvcGUudXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcblxuICAgICAgLy8gTmVlZGVkIGZvciB0aGUgbG9hZGluZyBzY3JlZW5cbiAgICAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgICRyb290U2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICB9KTtcblxuICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpe1xuICAgICAgICAkcm9vdFNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIH0pO1xuXG5cblxuICAgICAgJHNjb3BlLmJvdHRvbVJlYWNoZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLyogZ2xvYmFsIGFsZXJ0OiBmYWxzZTsgKi9cbiAgICAgICAgLy8gYWxlcnQoJ0NvbmdyYXRzIHlvdSBzY3JvbGxlZCB0byB0aGUgZW5kIG9mIHRoZSBsaXN0IScpO1xuICAgICAgfTtcblxuXG4gICAgICAvL1xuICAgICAgLy8gJ0RyYWcnIHNjcmVlblxuICAgICAgLy9cbiAgICAgICRzY29wZS5ub3RpY2VzID0gW107XG5cbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICAkc2NvcGUubm90aWNlcy5wdXNoKHtpY29uOiAnZW52ZWxvcGUnLCBtZXNzYWdlOiAnTm90aWNlICcgKyAoaiArIDEpIH0pO1xuICAgICAgfVxuXG4gICAgICAkc2NvcGUuZGVsZXRlTm90aWNlID0gZnVuY3Rpb24obm90aWNlKSB7XG4gICAgICAgIHZhciBpbmRleCA9ICRzY29wZS5ub3RpY2VzLmluZGV4T2Yobm90aWNlKTtcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAkc2NvcGUubm90aWNlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAudXNlci5jb25maWcnLCBbXSlcbiAgICAuY29udHJvbGxlcignQ29uZmlnQ3RybCcsWyduZ05vdGlmeScsJ1VzZXInLGZ1bmN0aW9uKG5nTm90aWZ5LFVzZXIpe1xuXG4gICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgdm0udXNlciA9IHt9O1xuICAgICAgY29uc29sZS5sb2coJ0NhcmdhbmRvJyk7XG5cbiAgICAgIFVzZXIubWUoKVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAgKGRhdGEpIHtcbiAgICAgICAgICB2bS51c2VyID0gZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uICAoZXJyKSB7XG4gICAgICAgICAgbmdOb3RpZnkuc2V0KGVyciwnZXJyb3InKTtcbiAgICAgICAgfSk7XG5cbiAgICAgIHZtLnNhdmUgPSBmdW5jdGlvbiAgKCkge1xuICAgICAgICBVc2VyLnVwZGF0ZSh2bS51c2VyKVxuICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBuZ05vdGlmeS5zZXQoZGF0YSwnc3VjY2VzcycpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmVycm9yKGZ1bmN0aW9uICAoZXJyKSB7XG4gICAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9XSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAudXNlcicsIFtcbiAgICAnYXBwLnVzZXIuc2VydmljZScsXG4gICAgJ2FwcC51c2VyLmNvbmZpZycgLy8gZWRpdGFyIHBlcmZpbCBkZWwgdXN1YXJpbyB5IHN1IGNvbmZpZ3VyYWNpw7NuXG4gIF0pXG4gICAgLmNvbnRyb2xsZXIoJ1VzZXJDdHJsJyxbJ25nTm90aWZ5JywnVXNlcicsJyRyb3V0ZVBhcmFtcycsZnVuY3Rpb24obmdOb3RpZnksVXNlciwkcm91dGVQYXJhbXMpe1xuXG4gICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgY29uc29sZS5sb2coJ0NhcmdhbmRvJyk7XG5cbiAgICAgIFVzZXIuc2hvdygkcm91dGVQYXJhbXMuaWQpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uICAoZGF0YSkge1xuICAgICAgICAgICAgdm0udXNlciA9IGRhdGE7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbm8nKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24gIChlcnIpIHtcbiAgICAgICAgICBuZ05vdGlmeS5zZXQoZXJyLCdlcnJvcicpO1xuICAgICAgICB9KTtcblxuICAgIH1dKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC51c2VyLnNlcnZpY2UnLCAgW10pXG5cbiAgICAgIC5mYWN0b3J5ICgnVXNlcicsIFsnJGh0dHAnLGZ1bmN0aW9uICgkaHR0cCkge1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbWU6ZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2Vycy9wcm9maWxlJyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB1cGRhdGU6ZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICAgIG1ldGhvZDonUFVUJyxcbiAgICAgICAgICAgICAgZGF0YTpkYXRhLFxuICAgICAgICAgICAgICB1cmw6Jy9hcGkvdXNlcnMvcHJvZmlsZSdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2hvdzpmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvJyArIGlkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XSk7XG5cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
